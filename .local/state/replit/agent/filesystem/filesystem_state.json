{"file_contents":{"Plan.md":{"content":"﻿FretboardManuscripts: A Technical Implementation Blueprint\nPart I: The \"Manuscript Method\" as Generative Algorithm\n1.1 Deconstruction of the Pedagogical Framework\nThe foundation of the FretboardManuscripts application is its unique pedagogical method, codified in the strategic analysis as the \"Manuscript Method\". This method is a three-phase learning loop designed to build comprehensive musicianship, moving from rote mechanics to conceptual understanding and finally to practical application. This \"Drill, Map, Apply\" sequence is the core business logic that must be encoded into the application's content-generation engine.   \n\nPhase 1 (Drill): Rote Technical Skill\n\nObjective: To build muscle memory, endurance, and precise synchronization between the fretting and picking hands at a set tempo.\n\nImplementation: This phase consists of highly repetitive, rhythmic patterns executed on single, isolated strings. The provided C Major tablature (0, 1, 0, 3, 1, 3, 1, 0, 3, 0, 1, 0, 3, 0, 3, 1) is a prime example of this technical drill, focusing purely on the physical execution of diatonic notes.   \n\nPhase 2 (Map): Conceptual Knowledge\n\nObjective: To cement the theoretical and spatial patterns of a scale onto the fretboard, teaching the musician the physical \"shape\" of the scale in a specific position.\n\nImplementation: This phase abruptly shifts from rhythmic repetition to systematic, positional mapping. The C Major example demonstrates this with a clear ascending scale run across all six strings (e.g., E-string: 0, 1, 3; A-string: 2, 3, 5).   \n\nPhase 3 (Apply): Practical Integration\n\nObjective: To integrate the technical skill from Phase 1 and the conceptual knowledge from Phase 2 into a fluid, musical context.\n\nImplementation: This phase presents short, non-repetitive melodic fragments that mimic real-world musical passages. It trains string skipping and cross-string accuracy, applying the newly mapped scale in a practical, melodic fashion.   \n\n1.2 Algorithmic Codification: The generateManuscript Function\nTo automate the creation of new content, this three-phase method will be codified as a master generateManuscript function. This function will serve as the central content engine, programmatically generating a complete \"Manuscript\" for any valid instrument-key-scale combination.\n\nTop-Level Pseudocode:\n\nJavaScript\nfunction generateManuscript(instrumentName, rootNote, scaleName) {\n    // 1. Get data models\n    const instrument = InstrumentDatabase.get(instrumentName); // See Part II\n    const scale = ScaleDatabase.get(rootNote, scaleName);      // See Part III\n\n    // 2. Select the correct polymorphic drill template\n    const drillTemplate = selectDrillTemplate(scale); // See 1.4\n\n    // 3. Generate data for each phase\n    const phase1_data = generateDrill(instrument, scale, drillTemplate);\n    const phase2_data = generateMap(instrument, scale);\n    const phase3_data = generateApplication(instrument, scale);\n\n    // 4. Return the complete, structured data package\n    return {\n        drill: phase1_data,\n        map: phase2_data,\n        apply: phase3_data\n    };\n}\n1.3 The \"Manuscript Method\" as a Polymorphic Framework\nA critical architectural requirement is that the \"Manuscript Method,\" particularly Phase 1, must be polymorphic. It is not a single, static algorithm. The strategic analysis itself demonstrates that the drill must adapt its template based on the structure of the scale being practiced.   \n\nThe 3-note pattern (0-1-3) used in the C Major 7-note diatonic scale  is explicitly identified as \"ill-suited\" for a 5-note pentatonic scale. For pentatonics, a new \"2-Note Drill\" template (e.g., 5-8) is required. Similarly, for \"exotic\" scales containing an augmented (3-fret) interval, such as G-Harmonic Minor, the drill must be adapted again to specifically isolate and train that \"exotic\" jump (e.g., 0-1-3 for D-Eb-F#).   \n\nTherefore, the generateManuscript function must first inspect the properties of the selected scale (e.g., 5-note, 7-note, contains augmented interval) and then dispatch the appropriate generative \"Drill\" template. This makes the system extensible for any future scale type.\n\n1.4 Defining Generative Drill Templates\nBased on this polymorphic requirement, the application will launch with three foundational drill templates:\n\nTemplate_A (Diatonic/7-Note): The 16-beat, 3-note pattern as defined in the C Major tablature. This template will be used for the Major scale, all 7 of its modes, and the Melodic and Harmonic Minor scales.   \n\nTemplate_B (Pentatonic/5-Note): A 16-beat, 2-note pattern as defined in the A-Minor Pentatonic analysis. This template will be used for Major Pentatonic, Minor Pentatonic, and Blues scales.   \n\nTemplate_C (Augmented/Exotic): A 16-beat pattern designed to isolate and repeat any interval of 3 semitones (WH) or more found in the scale's formula. This will be used for scales like Harmonic Minor, Phrygian Dominant, and Hungarian Gypsy to train the most challenging intervals.   \n\nPart II: Definitive Instrument Tuning Database\n2.1 Data Architecture for Instrument Definitions\nAll instrument data will be stored in a centralized, immutable JSON file or JavaScript module (instrumentDatabase.js). This data is the absolute prerequisite for all theory, rendering, and audio playback logic. The Tonal.js theory engine and Tone.js audio engine are entirely dependent on these precise MIDI values to function.   \n\nEach instrument object in this database will contain:\n\nid: A unique programmatic identifier (e.g., \"guitar_6\").\n\ndisplayName: A human-readable name (e.g., \"6-String Guitar\").\n\nstringCount: The number of strings (e.g., 6).\n\ndefaultTuningName: The key for the default tuning (e.g., \"Standard\").\n\ntunings: An object containing one or more tuning definitions.\n\nEach tuning definition will contain an array of string objects, ordered from highest pitch to lowest pitch (or as logically grouped by the instrument), with each object containing:\n\nname: The programmatic string name (e.g., \"E4\").\n\nmidi: The definitive open-string MIDI note number.\n\n2.2 Table 1 (Definitive): Instrument Tuning & MIDI Reference\nThe following table is the definitive, architect-defined data model for all instruments supported by the FretboardManuscripts application. It resolves all ambiguities from the foundational research and establishes the non-negotiable MIDI values that the application's engines will use for all calculations.\n\nInstrument\tTuning Name\tString Name\tTuning Note\tOpen String MIDI Note\tSource(s)\nGuitar (6-String)\tStandard\te4\tE4\t64\t\nB3\tB3\t59\t\nG3\tG3\t55\t\nD3\tD3\t50\t\nA2\tA2\t45\t\nE2\tE2\t40\t\nBass (4-String)\tStandard\tG2\tG2\t43\t\nD2\tD2\t38\t\nA1\tA1\t33\t\nE1\tE1\t28\t\nBass (5-String)\tStandard (Low B)\tG2\tG2\t43\t\nD2\tD2\t38\t\nA1\tA1\t33\t\nE1\tE1\t28\t\nB0\tB0\t23\t\nUkulele\tStandard (Re-entrant)\tA4\tA4\t69\t\nE4\tE4\t64\t\nC4\tC4\t60\t\nG4\tG4\t67\t\nMandolin\tStandard\tE5\tE5\t76\t\nA4\tA4\t69\t\nD4\tD4\t62\t\nG3\tG3\t55\t\nBanjo (5-String)\tStandard (Open G)\td4\tD4\t62\t\nB3\tB3\t59\t\nG3\tG3\t55\t\nD3\tD3\t50\t\ng4 (short)\tG4\t67\t\nBanjo (4-String Tenor)\tStandard (Jazz)\tA4\tA4\t69\t\nD4\tD4\t62\t\nG3\tG3\t55\t\nC3\tC3\t48\t\nBanjo (4-String Tenor)\tIrish\tE4\tE4\t64\t\nA3\tA3\t57\t\nD3\tD3\t50\t\nG2\tG2\t43\t\nIrish Bouzouki\tGDAE\tE4\tE4\t64\t\nA3\tA3\t57\t\nD3\tD3\t50\t\nG2\tG2\t43\t\nIrish Bouzouki\tGDAD\tD4\tD4\t62\t\nA3\tA3\t57\t\nD3\tD3\t50\t\nG2\tG2\t43\t\nMandocello\tStandard\tA3\tA3\t57\t\nD3\tD3\t50\t\nG2\tG2\t43\t\nC2\tC2\t36\t\nChapman Stick (10-Str)\tClassic (Architect-Std)\tM1 (Str 1)\tD5\t74\t\nM2 (Str 2)\tA4\t69\t\nM3 (Str 3)\tE4\t64\t\nM4 (Str 4)\tB3\t59\t\nM5 (Str 5)\tF#3\t54\t\nB5 (Str 6)\tC2\t36\t\nB4 (Str 7)\tG2\t43\t\nB3 (Str 8)\tD3\t50\t\nB2 (Str 9)\tA3\t57\t\nB1 (Str 10)\tE4\t64\t\n  \n2.3 Establishing a Definitive Chapman Stick Tuning Standard\nThe research for the Chapman Stick provides relative intervals (\"down a 4th\", \"up a 5th\") but lacks the absolute MIDI pitch values necessary for the application's theory and audio engines. An application cannot function with relative tunings; a concrete MIDI value must be assigned to each string.   \n\nFor the purposes of this application, a logical \"Architect-Standard\" tuning has been derived. This standard anchors the instrument's two \"sides\" at logical octave positions to create a balanced, usable range.\n\nBass Side (Strings 6-10): The lowest string is 'C', which is anchored at C2 (MIDI 36). The remaining strings are calculated as ascending 5ths from this anchor: C2 (36), G2 (43), D3 (50), A3 (57), and E4 (64).   \n\nMelody Side (Strings 1-5): The lowest-pitched string on this side is 'F#', which is anchored at F#3 (MIDI 54). The remaining strings are calculated as descending 4ths (which, in pitch, is an ascent) from this anchor: F#3 (54), B3 (59), E4 (64), A4 (69), and D5 (74).   \n\nThis \"Architect-Standard\" tuning is programmatically sound, musically logical, and directly derived from the research. It will serve as the internal standard for the FretboardManuscripts application.   \n\nPart III: Comprehensive Scale and Mode Library\n3.1 Tonal.js as the \"Single Source of Truth\" for Music Theory\nThe strategic requirement to expand the scale library to be \"more robust\" introduces a significant data-management challenge. Research into \"exotic\" scales reveals multiple, often-conflicting, definitions, formulas, and names (e.g., conflicting formulas for \"Romanian Minor\"  or \"Oriental\" scale ).   \n\nManually hardcoding these varied formulas into the application is fragile, error-prone, and creates a significant maintenance burden.\n\nTherefore, the application architecture will mandate that Tonal.js serves as the \"Single Source of Truth\" for all music theory. The Tonal.js library already includes a comprehensive \"Scale dictionary\". The application will not maintain its own separate library of scale formulas (e.g., W-H steps).   \n\nInstead, the application will only maintain a list of display names (for the UI) that map directly to the internal names used by the Tonal.js scale dictionary. When a user selects \"Byzantine\" from the UI, the application will internally call Tonal.Scale.get(\"double harmonic major\") to retrieve the notes and intervals. This approach makes the application robust, maintainable, and leverages the full, tested power of the core theory library, while simultaneously resolving all data-level contradictions in the research.   \n\n3.2 Table 2 (Definitive): Foundational Scales & Modes\nThis table defines the mapping between the user-facing UI (as proposed in the 3-Step Sequential Filter ) and the internal Tonal.js scale names for foundational scales.   \n\nUI Category\tDisplay Name\tTonal.js Name\tSource(s)\nCommon\tMajor\tmajor\t\nCommon\tNatural Minor\taeolian\t\nCommon\tMajor Pentatonic\tmajor pentatonic\t\nCommon\tMinor Pentatonic\tminor pentatonic\t\nCommon\tBlues\tblues\t\nModes\tIonian (Major)\tionian\t\nModes\tDorian\tdorian\t\nModes\tPhrygian\tphrygian\t\nModes\tLydian\tlydian\t\nModes\tMixolydian\tmixolydian\t\nModes\tAeolian (Minor)\taeolian\t\nModes\tLocrian\tlocrian\t\nMinor\tHarmonic Minor\tharmonic minor\t\nMinor\tMelodic Minor\tmelodic minor\t\n  \n3.3 Table 3 (Definitive): Exotic & Unique Scales\nThis table defines the mapping for the \"Exotic / Other\" UI category, synthesizing all strategic and supplemental research into a Tonal.js-compatible format.\n\nUI Category\tDisplay Name\tTonal.js Name\tResearch Source(s)\nExotic\tPhrygian Dominant\tphrygian dominant\t\nExotic\tByzantine\tdouble harmonic major\t\nExotic\tRomanian Minor\tromanian minor\t\nExotic\tHungarian Gypsy\thungarian minor\t\nSymmetrical\tWhole Tone\twhole tone\t\nSymmetrical\tDiminished (W-H)\tdiminished or whole half\t\nSymmetrical\tDiminished (H-W)\thalf whole\t\nMelodic Minor\tLydian Augmented\tlydian augmented\t\nMelodic Minor\tAltered Scale\taltered\t\nExotic\tArabian\tarabian\t\nExotic\tPersian\tpersian\t\nExotic\tOriental\toriental\t\nExotic\tPrometheus\tprometheus\t\nPentatonic\tHirajōshi\thirajoshi\t\nExotic\tNeapolitan Major\tneapolitan major\t\n  \nPart IV: Architecture of the Core \"Engines\" (The \"Holy Trinity\" Stack)\n4.1 The \"Brain, Voice, Hands\" Architectural Model\nThe recommended architecture for the FretboardManuscripts application is a \"Holy Trinity\" stack of three specialized, decoupled JavaScript libraries. This separation of concerns is the most critical architectural decision for ensuring the platform is modular, testable, and scalable.   \n\nThe three components are:\n\nTonal.js (The Brain): The \"source of truth\" for all music theory. It only deals in data abstractions (note names, intervals, MIDI numbers, scale formulas) and performs no audio or visual functions.   \n\nTone.js (The Voice): The audio scheduling and synthesis engine. It knows nothing about music theory (e.g., \"C Major\"). It only accepts a timed array of events (e.g., \"play 'C4' at 1.5s\") and handles high-precision Web Audio playback.   \n\nSVGuitar (The Hands): The visual rendering engine. It knows nothing about theory or audio. It only accepts a simple data structure of fret/string coordinates and draws a clean SVG diagram.   \n\nThe application's core \"business logic\" is simply the glue that fetches data from Tonal.js (The Brain) and formats it as needed for either Tone.js (The Voice) or SVGuitar (The Hands).\n\n4.2 Engine #1: The \"Theory Engine\" (Tonal.js) Implementation Blueprint\nPurpose: To handle all music theory calculations, from scale generation to fretboard mapping.\n\nKey Functions & Code Examples:\n\nGet Notes in a Scale: Used to populate all scale-based features.\n\nJavaScript\n// Tonal.js provides the notes for any key/scale combination\nconst notes = Tonal.Scale.get(\"C major\").notes;\n// Returns:\n   \n\nGet Chords in a Key: Used by the Circle of Fifths (Part V).\n\nJavaScript\n// Tonal.js provides the diatonic chords for a key\nconst chords = Tonal.Scale.get(\"G major\").chords;\n// Returns:\n   \n\nNote/MIDI Conversion: Used by the audio engine parser (Part VII) and fretboard mapper.\n\nJavaScript\n// Convert MIDI number to Note Name\nconst noteName = Tonal.Note.fromMidi(61); // Returns: \"Db4\"\n\n// Convert Note Name to MIDI number\nconst midi = Tonal.Note.midi(\"C4\"); // Returns: 60\n   \n\nCore Fretboard Mapping Algorithm (Pseudocode): This algorithm maps any scale onto any instrument's fretboard.\n\nJavaScript\n// 1. Get the scale's pitch classes (notes without octaves)\nconst scalePitchClasses = Tonal.Scale.get(\"C major\").notes;\n// Returns:\n\n// 2. Get the instrument tuning from our database (Part II)\nconst tuning = InstrumentDatabase.get(\"guitar_6\").tunings.standard;\n// Returns:\n\nconst fretboardMap =; // This will store the final note map\nconst NUM_FRETS = 15; // As defined in the original HTML \n\n// 3. Iterate over each string in the tuning\nfor (const string of tuning) { // e.g., { name: \"E2\", midi: 40 }\n    let stringNotes =;\n    // 4. Iterate over each fret for that string\n    for (let fret = 0; fret <= NUM_FRETS; fret++) {\n        // 5. Calculate the note at this (string, fret) position\n        const noteMidi = string.midi + fret;\n        const noteName = Tonal.Note.fromMidi(noteMidi);\n        const pitchClass = Tonal.Note.pitchClass(noteName); // e.g., \"C\"\n\n        // 6. If that note's pitch class is in our scale, store it\n        if (scalePitchClasses.includes(pitchClass)) {\n            stringNotes.push({ fret: fret, note: noteName });\n        }\n    }\n    fretboardMap.push({ stringName: string.name, notes: stringNotes });\n}\n// fretboardMap now contains all C-Major notes for all 6 strings\n   \n\n4.3 Engine #2: The \"Audio Engine\" (Tone.js) Implementation Blueprint\nPurpose: To handle high-precision, scheduled playback of the \"Manuscript\" tablature.   \n\nKey Functions & Code Examples:\n\nScheduling with Tone.Part: The Tone.Part object is the ideal component for this task. It accepts an array of objects, each containing a time and a value (which will be our note).   \n\nBrowser AudioContext Requirement: A critical, non-trivial requirement of all modern browsers is that audio playback must be initiated by a user gesture (e.g., a click). The Tone.start() function must be called from within a click event handler to \"unlock\" the Web Audio API.   \n\nDefinitive Playback Code:\n\nJavaScript\n// 1. Create a synth instance (can be done on page load)\nconst synth = new Tone.Synth().toDestination();\n\n// 2. 'playableEvents' is the array generated by our CSV parser (See Part VII)\n//    It looks like this:\n//    [ { time: 0, note: \"E2\", duration: \"16n\" },\n//      { time: 0.125, note: \"F2\", duration: \"16n\" },\n//      { time: 0.250, note: \"E2\", duration: \"16n\" },... ]\n\n/**\n * This function must be attached to a \"Play\" button's click event.\n * @param {Array} playableEvents - The array of note objects.\n */\nasync function playManuscript(playableEvents) {\n    // 3. Start the AudioContext on user click [37]\n    await Tone.start();\n    \n    // 4. Stop any previously playing transport\n    Tone.Transport.stop();\n    Tone.Transport.cancel();\n    \n    // 5. Create a new Tone.Part from our events [33]\n    const tabPart = new Tone.Part((time, event) => {\n        // This callback is triggered by the Transport for each event\n        synth.triggerAttackRelease(event.note, event.duration, time);\n    }, playableEvents);\n\n    // 6. Start the part at time 0 and begin the transport\n    tabPart.start(0);\n    Tone.Transport.start();\n}\n4.4 Engine #3: The \"Rendering Engine\" (SVGuitar) Implementation Blueprint\nPurpose: To dynamically render clean, scalable SVG chord diagrams for the Key & Harmony section.   \n\nKey Functions & Code Examples:\n\nAPI: SVGuitar provides a simple, chainable API for configuring and drawing a chord. The library is initialized with a CSS selector for a target <div> and then configured with data.   \n\nDefinitive Rendering Function:\n\nJavaScript\n/**\n * Renders a chord diagram in a specific HTML element.\n * @param {Object} chordData - A chord voicing object from chord_shapes.json (See Part VI).\n * @param {String} targetDivId - The CSS ID of the container, e.g., \"#chord-display\".\n */\nfunction renderChordDiagram(chordData, targetDivId) {\n    // 1. Get the target HTML element\n    const targetElement = document.querySelector(targetDivId);\n    if (!targetElement) {\n        console.error(\"SVGuitar Target Element not found:\", targetDivId);\n        return;\n    }\n\n    // 2. Clear the target div of any previous diagram\n    targetElement.innerHTML = \"\";\n\n    // 3. Initialize the SVGuitar chart in the target element \n    const chart = new SVGuitarChord(targetDivId);\n\n    // 4. Configure the chart with data and draw it \n    chart.chord({\n        frets: chordData.frets,      // e.g., [-1, 3, 2, 0, 1, 0]\n        fingers: chordData.fingers,  // e.g., [null, 3, 2, 0, 1, 0]\n        title: chordData.title       // e.g., \"C Major\"\n    })\n   .draw();\n}\nPart V: Feature Blueprint: The Interactive Key & Harmony Section\n5.1 Architecture of the Circle of Fifths Component\nThis feature is a primary tool for teaching harmony and chord relationships. It will consist of an interactive UI element (HTML/SVG) representing the Circle of Fifths, which acts as a master control for the \"Key\" section.   \n\nData Flow:\n\nUser-Click (Key): A user clicks on a key (e.g., \"G\") in the Circle of Fifths UI.\n\nEvent: An onClick_Key(\"G\") event is fired.\n\nHandler (Tonal.js): The event handler calls the Tonal.js \"Theory Engine\": const chords = Tonal.Scale.get(\"G major\").chords;.   \n\nTonal.js Response: The engine returns an array of diatonic chord names: ``.\n\nUI Population (Diatonic Chords): The \"Diatonic Chord Display\" UI  is dynamically populated by mapping this array to create seven clickable buttons (e.g., [G], [Am], ``, etc.).   \n\nUI Population (Progressions): Simultaneously, the \"Chord Progression Display\" is populated (see 5.2).\n\nUser-Click (Chord): The user then clicks one of the new diatonic chord buttons (e.g., [Am]).\n\nEvent: An onClick_Chord(\"Am\") event is fired.\n\nHandler (SVGuitar): This event is handled by the \"Dynamic Chord Library\" logic (detailed in Part VI), which retrieves the \"Am\" chord shape for the current instrument and passes it to the renderChordDiagram function.\n\n5.2 Chord Progression Library Implementation\nTo provide immediate, practical context, the \"Chord Progression Display\"  will be populated whenever a key is selected. This component will use a static library of common progressions, as defined in the strategic analysis , and render them relative to the selected key.   \n\nLogic (Pseudocode):\n\nJavaScript\n// 1. Static library of progressions (defined in a module)\nconst progressions = {\n    major:,\n    minor:\n};\n\n// 2. This function is called by the onClick_Key handler\nfunction displayProgressions(keyName) {\n    const displayUI = document.querySelector(\"#progression-display\");\n    displayUI.innerHTML = \"\"; // Clear old progressions\n    \n    // 3. Use Tonal.js to resolve Roman numerals to chord names\n    const romanNumerals = Tonal.RomanNumeral.fromContext(keyName);\n    \n    // 4. Get the \"major\" list\n    const majorProgressions = progressions.major;\n    \n    // 5. Map formulas to actual chord names\n    for (const prog of majorProgressions) {\n        // e.g., \"I-V-vi-IV\" -> [\"I\", \"V\", \"vi\", \"IV\"]\n        const numerals = prog.formula.split(\"-\");\n        \n        // e.g., [\"I\", \"V\", \"vi\", \"IV\"] -> (if key is \"G\")\n        const chordNames = numerals.map(romanNumerals).join(\" - \");\n        \n        // 6. Render to UI\n        displayUI.innerHTML += `<p><b>${prog.name}:</b> ${chordNames}</p>`;\n    }\n}\n// Example Output for key=\"G\":\n// <p><b>Axis Progression:</b> G - D - Em - C</p>\n// <p><b>Doo-Wop:</b> G - Em - C - D</p>\n// <p><b>Jazz (ii-V-I):</b> Am - D - G</p>\n// <p><b>Minor Feel:</b> Em - C - G - D</p>\nPart VI: Feature Blueprint: The Dynamic Chord Library\n6.1 Integrating the SVGuitar Engine\nThis feature's logic is the handler for the onClick_Chord(\"Am\") event originating from the Diatonic Chord Display (Part V). Its sole purpose is to look up the correct chord shape in the database and pass it to the \"Rendering Engine\" (Part 4.4).\n\nHandler Logic (Pseudocode):\n\nJavaScript\nfunction onClick_Chord(chordName) {\n    // 1. Get the globally selected instrument from application state\n    const currentInstrumentId = AppState.getCurrentInstrument(); // e.g., \"guitar_6\"\n    \n    // 2. Get the chord data from our database (See 6.3)\n    // This will retrieve an array of voicings\n    const voicings = ChordDatabase.get(currentInstrumentId, chordName);\n    \n    if (!voicings |\n\n| voicings.length === 0) {\n        // Display an error or \"chord not found\"\n        return;\n    }\n    \n    // 3. By default, render the first voicing in the array\n    const defaultVoicing = voicings;\n    \n    // 4. Call the rendering engine function from Part 4.4\n    renderChordDiagram(defaultVoicing, \"#chord-display\");\n    \n    // 5. Update UI to show voicing-cycler buttons (e.g., \"1 of 3\")\n    // if (voicings.length > 1) {... }\n}\n6.2 The chord_shapes.json Data Model Refactor\nThe initial strategic analysis proposed a simple key-value model for the chord database (e.g., \"Am\": {... }). This model is insufficient. The strategic requirement to include \"Advanced & Unique Chord Voicings\" (e.g., Drop 2, Rootless, Shell Voicings)  means that a single chord name (like \"Am\") must map to multiple distinct voicings (e.g., Am Open, Am Barre 5th Fret, Am Triad 2-3-4 strings).   \n\nThe original data model, which only allows one voicing per chord, is a critical design flaw that would prevent this scalability.\n\nTherefore, the data structure must be refactored to support an array of voicings for each chord. The UI will then be required to include simple < and > buttons, allowing the user to cycle through the available voicings for the selected chord.\n\n6.3 Definitive Data Model for chord_shapes.json\nThis data model supports multiple voicings per chord, barre chord notation, and all properties required by the SVGuitar rendering engine.   \n\nJSON\n{\n  \"guitar_6\": {\n    \"Cmaj\": [\n      {\n        \"name\": \"Open\",\n        \"frets\": [-1, 3, 2, 0, 1, 0],\n        \"fingers\": [null, 3, 2, 0, 1, 0],\n        \"barres\":,\n        \"title\": \"C Major (Open)\"\n      },\n      {\n        \"name\": \"A-Shape Barre (3rd Fret)\",\n        \"frets\": [-1, 3, 5, 5, 5, 3],\n        \"fingers\": [null, 1, 3, 4, 4, 1],\n        \"barres\":,\n        \"title\": \"C Major (A-Shape)\"\n      },\n      {\n        \"name\": \"E-Shape Barre (8th Fret)\",\n        \"frets\": ,\n        \"fingers\": ,\n        \"barres\":,\n        \"title\": \"C Major (E-Shape)\"\n      }\n    ],\n    \"Am\": [\n      {\n        \"name\": \"Open\",\n        \"frets\": [-1, 0, 2, 2, 1, 0],\n        \"fingers\": [null, 0, 2, 3, 1, 0],\n        \"barres\":,\n        \"title\": \"A minor (Open)\"\n      }\n    ]\n  },\n  \"ukulele\": {\n    \"Cmaj\":,\n        \"fingers\": ,\n        \"barres\":,\n        \"title\": \"C Major\"\n      }\n    ]\n  },\n  \"mandolin\": {\n    \"Cmaj\":,\n        \"fingers\": ,\n        \"barres\":,\n        \"title\": \"C Major\"\n      }\n    ]\n  }\n}\n6.4 Database Expansion: Advanced & Unique Chord Voicings\nThis new data structure will be populated with the advanced voicings requested in the strategic analysis. The database will be expanded to include:   \n\nTriad Voicings: Triads on different string sets (1-2-3, 2-3-4, 3-4-5, 4-5-6).\n\nJazz & Rootless Voicings:\n\nShell Voicings: Basic (Root, 3rd, 7th) shapes.\n\nDrop Voicings: Standard 4-note \"Drop 2\" and \"Drop 3\" shapes.\n\nRootless Voicings: 3- and 4-note chords (e.g., 3-5-7-9) that omit the root.\n\nQuartal Voicings: Chords built from stacking 4ths (e.g., E-A-D-G).\n\nExtended Harmony: Common, playable shapes for Maj9, min9, Dom13, etc.\n\nAltered Dominant Chords: Shapes for 7b9, 7#9, 7b5.\n\nPart VII: Feature Blueprint: The \"Manuscript\" Playback System\n7.1 The 3-Step Stack: Parse -> Translate -> Play\nThis section provides the definitive logic for the \"CSV to Audio\" challenge. It details the algorithm that converts the raw tablature data  into the playableEvents array required by the Tone.js audio engine.   \n\nParse: Read the raw CSV file  and iterate through its grid.   \n\nTranslate: For each cell containing a fret number, \"translate\" it into a musical event by: a. Calculating its exact time in seconds. b. Calculating its exact noteName using Tonal.js and the instrument tuning map.\n\nPlay: Pass the resulting array of event objects to the Tone.Part object for playback.\n\n7.2 The \"Magic Number\" and Parser Logic\nThe \"translation\" step is made possible by a \"magic number\" derived from the data's metadata.\n\nThe Tempo is 120 BPM (120 quarter-notes per minute).   \n\n120 BPM = 2 beats (quarter-notes) per second.\n\n1 quarter-note = 0.5 seconds.\n\nThe beats division is 4, meaning the \"beats\" in the CSV (1-16) are 16th notes.   \n\nTherefore, the time duration of one \"beat\" (one column in the CSV) is 0.5/4=0.125 seconds.\n\nThis 0.125s is the \"magic number\" (the TIME_PER_BEAT) that allows for a simple, fast parser.\n\nParser Algorithm (Pseudocode):\n\nJavaScript\n// 1. Get the tuning map from our database (Part II)\nconst tuning = InstrumentDatabase.get(\"guitar_6\").tunings.standard;\nconst tuningMap = {\n    \"e4\": 64, \"B3\": 59, \"G3\": 55, \"D3\": 50, \"A2\": 45, \"E2\": 40\n}; // A simple map for fast lookups\n\n// 2. Define the \"Magic Number\"\nconst TIME_PER_BEAT = 0.125; // 16th note at 120 BPM\nconst NOTE_DURATION = \"16n\";\n\n// 3. 'csvData' is the raw, parsed CSV grid \nfunction parseCsvToPlayableEvents(csvData, tuningMap) {\n    const playableEvents =;\n    \n    // 4. Iterate over each DATA block in the CSV\n    for (const dataBlock of csvData.blocks) {\n        // 5. Iterate over each COLUMN (beat) in the block\n        // 'colIndex' goes from 0 to 15\n        for (let colIndex = 0; colIndex < dataBlock.beats.length; colIndex++) {\n            const beatNumber = dataBlock.startBeat + colIndex; // e.g., 17 + 0 = 17\n            \n            // 6. Iterate over each ROW (string) in that column\n            // 'stringName' e.g., \"e4\", \"B3\", \"G3\", \"D3\", \"A2\", \"E2\"\n            for (const stringName of dataBlock.strings) {\n                \n                // 7. Get the fret value from the cell\n                const fret = dataBlock.getValue(stringName, colIndex); // e.g., \"3\" or \"\"\n                \n                if (fret!== null && fret!== \"\") {\n                    // 8. A note was found! Translate it.\n                    // a. Calculate time\n                    const time = (beatNumber - 1) * TIME_PER_BEAT;\n                    \n                    // b. Calculate note name\n                    const baseMidi = tuningMap[stringName];\n                    const noteMidi = baseMidi + parseInt(fret, 10);\n                    const noteName = Tonal.Note.fromMidi(noteMidi); // [28]\n                    \n                    // 9. Add the event object to our array\n                    playableEvents.push({\n                        time: time,\n                        note: noteName,\n                        duration: NOTE_DURATION\n                    });\n                }\n            }\n        }\n    }\n    return playableEvents; // This array is ready for Tone.Part\n}\n7.3 UI Integration\nThe \"Play\" button for each \"Manuscript\" will be wired to the playManuscript(events) function (from Part 4.3), which will be fed the playableEvents array generated by this parser. A \"Stop\" button must also be provided, which simply calls Tone.Transport.stop() and tabPart.stop() (or its equivalent) to halt playback.\n\nPart VIII: UI/UX and Pedagogical Support\n8.1 Implementing the 3-Step Sequential Filter\nThe strategic analysis calls for a \"robust\" scale selection framework to replace the simple dropdowns in the existing HTML file. This will be implemented as a 3-Step Sequential Filter:   \n\nStep 1: Select Instrument (Global Context): An icon-based menu (Guitar, Bass, Ukulele, etc.) that globally sets the currentInstrument state. This selection will determine the fretboard diagrams, tunings, and chord_shapes.json file to be used.\n\nStep 2: Select Key (Tonic): A 12-button component (C, C#/Db, D, etc.) that sets the rootNote state.\n\nStep 3: Select Scale (Categorized Filter): The \"chunked\" menu system. This UI will be populated directly from the definitive scale tables (Table 2 and Table 3) in Part III. This ensures all menu items are valid and have a corresponding Tonal.js entry.   \n\nThe \"Generate Fretboard\" button  will then trigger the generateManuscript(currentInstrument, rootNote, selectedScale) function (from Part 1.2).   \n\n8.2 Implementing the \"Accordion\" Fundamentals Library\nTo help players \"understand the fundamentals,\" brief, expandable explanations will be integrated directly into the UI using \"Accordion\" or \"Collapsible\" panels. The content for these panels is provided in the strategic analysis  and will be placed contextually:   \n\n[+] What is a Fretboard Diagram? -> Placed near the main training interface.\n\n[+] What is a Scale? -> Placed inside the \"Select Scale\" UI (Step 3).\n\n[+] What are the Minor Scales? -> Placed inside the \"Select Scale\" UI, near the minor scale options.\n\n[+] What is a Chord and a Triad? -> Placed directly beneath the Circle of Fifths component (Part V).\n\n8.3 Re-using Existing CSS from TFTM.HTML\nThe existing HTML file TFTM.HTML  is not obsolete; it provides a valuable, pre-built CSS library for fretboard visualization. This library includes:   \n\nConstants: FRET_SPACING (75px) and STRING_PITCH_GAP (40px).\n\nCSS Classes: A complete system for styling notes, including .fret-dot, .fret-dot.root (for the tonic), .fret-dot.scale (for other scale notes), and .fret-dot.rest (for non-scale notes).\n\nThe new logic engines (the Fretboard Mapping Algorithm in Part 4.2 and the generateManuscript function in Part 1.2) will be written to output HTML that uses these existing CSS classes. This will save significant development time by hooking the new, powerful logic engines directly into the existing, styled \"view\" layer, fulfilling the strategic vision without redundant work.\n\nPart IX: Full Application Setup and Distribution Roadmap\n9.1 Development Environment Setup: Vite\nThe project will use Vite as its build tool, not Webpack. This is a definitive architectural choice for a new project in 2025.\n\nJustification (Vite vs. Webpack):\n\nThe Problem: Traditional bundlers (Webpack) suffer from a significant performance bottleneck. They must crawl and bundle the entire application before a development server can even start. As a project grows, this \"cold start\" time can extend to minutes. Furthermore, Hot Module Replacement (HMR) speed degrades linearly with the size of the application.   \n\nVite's Solution (Speed): Vite eliminates this bottleneck by not bundling during development.\n\nNative ESM: It serves application source code directly to the browser via native ES Modules (ESM). The browser only requests the files it needs, on-demand.   \n\nesbuild Pre-Bundling: Large, non-changing dependencies (like Tone.js or Tonal.js) are pre-bundled once using esbuild, a Go-based bundler that is 10-100x faster than JavaScript-based bundlers.   \n\nVite's Solution (HMR): Hot Module Replacement is \"near-instant\"  because when a file is changed, Vite only needs to invalidate that single module, not rebuild a large bundle graph.   \n\nFor a modern frontend application, Vite provides a \"hands-down\" superior developer experience, speed, and simplicity.   \n\n9.2 Production Bundling\nWhen the application is ready for deployment, the developer will run a single command: vite build    \n\nThis command will trigger Vite's production build process, which uses Rollup under the hood. This process will:   \n\nBundle: Combine all application JavaScript modules into highly optimized chunks.\n\nMinify: Remove all unnecessary characters (whitespace, comments) from JavaScript and CSS files to reduce their size.   \n\nTree-Shake: Automatically analyze the code and remove any \"dead code\" (functions, modules) that are not being used in the final application.   \n\nThe output of this command is a single /dist folder. This folder contains all the optimized, static HTML, CSS, and JS files that constitute the entire production-ready application.\n\n9.3 Distribution & CI/CD: The \"Zero-Config\" Workflow\nThe \"distribution\" of this static application will be a one-time, fully automated setup using a modern static hosting platform like Vercel or Netlify. These platforms are not just hosts; they are Git-based Continuous Integration / Continuous Deployment (CI/CD) pipelines.   \n\nThe entire deployment process is as follows:\n\nStep 1: The developer pushes the entire project source code (including package.json and vite.config.js) to a new GitHub, GitLab, or Bitbucket repository.\n\nStep 2: The developer logs into the Vercel or Netlify dashboard and selects \"Import Project\" or \"Add New Site\".   \n\nStep 3: The developer selects the new GitHub repository and authorizes the platform.\n\nStep 4: The platform auto-detects that this is a Vite project. It automatically sets the Build Command to vite build and the Publish Directory to dist. No manual configuration is needed.   \n\nStep 5: The developer clicks \"Deploy.\"\n\nThe site is now live. From this point forward, every time a developer runs git push to the main branch, the Vercel/Netlify platform will automatically pull the new code, run the vite build command in a secure cloud environment, and deploy the resulting /dist folder to its global CDN. This \"zero-config\" CI/CD workflow fully automates the distribution of the application.\n\nPart X: Conclusion and Strategic Summary\nThis technical blueprint provides the complete architectural and implementation plan for transforming FretboardManuscripts.com from a single-page tool into a scalable, data-driven pedagogical platform. The strategy is built upon four key pillars:\n\nA Decoupled \"Holy Trinity\" Architecture: By separating concerns into a \"Brain\" (Tonal.js), \"Voice\" (Tone.js), and \"Hands\" (SVGuitar), the application becomes modular, testable, and capable of handling future expansion with minimal friction.\n\nA Polymorphic Pedagogical Engine: The \"Manuscript Method\" (Drill, Map, Apply) is codified not as a static algorithm, but as a flexible, polymorphic framework capable of generating adaptive training drills for any type of musical scale.\n\nData-Driven, Centralized Logic: The application's stability is secured by centralizing all core data. A definitive InstrumentDatabase (Table 1) provides the immutable MIDI map for all audio and theory, while a ScaleDatabase (Tables 2 & 3) leverages Tonal.js as a \"Single Source of Truth\" for all music theory, resolving external data conflicts.\n\nA Modern Development & Distribution Pipeline: By adopting Vite for development  and a Git-based CI/CD workflow for distribution , the project ensures a fast, modern developer experience and a robust, automated deployment-to-production process.   \n\nThis blueprint, when executed, will deliver the robust, scalable, and \"intimate\" learning tool envisioned in the original strategic analysis.   \n\nr each \"Manuscript\" will be wired to the playManuscript(events) function (from Part 4.3), which will be fed the playableEvents array generated by this parser. A \"Stop\" button must also be provided, which simply calls Tone.Transport.stop() and tabPart.stop() (or its equivalent) to halt playback.Part VIII: UI/UX and Pedagogical Support8.1 Implementing the 3-Step Sequential FilterThe strategic analysis calls for a \"robust\" scale selection framework to replace the simple dropdowns in the existing HTML file.1 This will be implemented as a 3-Step Sequential Filter:Step 1: Select Instrument (Global Context): An icon-based menu (Guitar, Bass, Ukulele, etc.) that globally sets the currentInstrument state. This selection will determine the fretboard diagrams, tunings, and chord_shapes.json file to be used.Step 2: Select Key (Tonic): A 12-button component (C, C#/Db, D, etc.) that sets the rootNote state.Step 3: Select Scale (Categorized Filter): The \"chunked\" menu system.1 This UI will be populated directly from the definitive scale tables (Table 2 and Table 3) in Part III. This ensures all menu items are valid and have a corresponding Tonal.js entry.The \"Generate Fretboard\" button 2 will then trigger the generateManuscript(currentInstrument, rootNote, selectedScale) function (from Part 1.2).8.2 Implementing the \"Accordion\" Fundamentals LibraryTo help players \"understand the fundamentals,\" brief, expandable explanations will be integrated directly into the UI using \"Accordion\" or \"Collapsible\" panels.1 The content for these panels is provided in the strategic analysis 1 and will be placed contextually:[+] What is a Fretboard Diagram? -> Placed near the main training interface.[+] What is a Scale? -> Placed inside the \"Select Scale\" UI (Step 3).[+] What are the Minor Scales? -> Placed inside the \"Select Scale\" UI, near the minor scale options.[+] What is a Chord and a Triad? -> Placed directly beneath the Circle of Fifths component (Part V).8.3 Re-using Existing CSS from TFTM.HTMLThe existing HTML file TFTM.HTML 2 is not obsolete; it provides a valuable, pre-built CSS library for fretboard visualization. This library includes:Constants: FRET_SPACING (75px) and STRING_PITCH_GAP (40px).CSS Classes: A complete system for styling notes, including .fret-dot, .fret-dot.root (for the tonic), .fret-dot.scale (for other scale notes), and .fret-dot.rest (for non-scale notes).The new logic engines (the Fretboard Mapping Algorithm in Part 4.2 and the generateManuscript function in Part 1.2) will be written to output HTML that uses these existing CSS classes. This will save significant development time by hooking the new, powerful logic engines directly into the existing, styled \"view\" layer, fulfilling the strategic vision without redundant work.Part IX: Full Application Setup and Distribution Roadmap9.1 Development Environment Setup: ViteThe project will use Vite as its build tool, not Webpack. This is a definitive architectural choice for a new project in 2025.Justification (Vite vs. Webpack):The Problem: Traditional bundlers (Webpack) suffer from a significant performance bottleneck. They must crawl and bundle the entire application before a development server can even start. As a project grows, this \"cold start\" time can extend to minutes. Furthermore, Hot Module Replacement (HMR) speed degrades linearly with the size of the application.39Vite's Solution (Speed): Vite eliminates this bottleneck by not bundling during development.Native ESM: It serves application source code directly to the browser via native ES Modules (ESM). The browser only requests the files it needs, on-demand.40esbuild Pre-Bundling: Large, non-changing dependencies (like Tone.js or Tonal.js) are pre-bundled once using esbuild, a Go-based bundler that is 10-100x faster than JavaScript-based bundlers.40Vite's Solution (HMR): Hot Module Replacement is \"near-instant\" 41 because when a file is changed, Vite only needs to invalidate that single module, not rebuild a large bundle graph.39For a modern frontend application, Vite provides a \"hands-down\" superior developer experience, speed, and simplicity.439.2 Production BundlingWhen the application is ready for deployment, the developer will run a single command:vite build 45This command will trigger Vite's production build process, which uses Rollup under the hood.46 This process will:Bundle: Combine all application JavaScript modules into highly optimized chunks.Minify: Remove all unnecessary characters (whitespace, comments) from JavaScript and CSS files to reduce their size.47Tree-Shake: Automatically analyze the code and remove any \"dead code\" (functions, modules) that are not being used in the final application.48The output of this command is a single /dist folder. This folder contains all the optimized, static HTML, CSS, and JS files that constitute the entire production-ready application.9.3 Distribution & CI/CD: The \"Zero-Config\" WorkflowThe \"distribution\" of this static application will be a one-time, fully automated setup using a modern static hosting platform like Vercel or Netlify. These platforms are not just hosts; they are Git-based Continuous Integration / Continuous Deployment (CI/CD) pipelines.50The entire deployment process is as follows:Step 1: The developer pushes the entire project source code (including package.json and vite.config.js) to a new GitHub, GitLab, or Bitbucket repository.Step 2: The developer logs into the Vercel or Netlify dashboard and selects \"Import Project\" or \"Add New Site\".52Step 3: The developer selects the new GitHub repository and authorizes the platform.Step 4: The platform auto-detects that this is a Vite project.53 It automatically sets the Build Command to vite build and the Publish Directory to dist. No manual configuration is needed.52Step 5: The developer clicks \"Deploy.\"The site is now live. From this point forward, every time a developer runs git push to the main branch, the Vercel/Netlify platform will automatically pull the new code, run the vite build command in a secure cloud environment, and deploy the resulting /dist folder to its global CDN. This \"zero-config\" CI/CD workflow fully automates the distribution of the application.Part X: Conclusion and Strategic SummaryThis technical blueprint provides the complete architectural and implementation plan for transforming FretboardManuscripts.com from a single-page tool into a scalable, data-driven pedagogical platform. The strategy is built upon four key pillars:A Decoupled \"Holy Trinity\" Architecture: By separating concerns into a \"Brain\" (Tonal.js), \"Voice\" (Tone.js), and \"Hands\" (SVGuitar), the application becomes modular, testable, and capable of handling future expansion with minimal friction.A Polymorphic Pedagogical Engine: The \"Manuscript Method\" (Drill, Map, Apply) is codified not as a static algorithm, but as a flexible, polymorphic framework capable of generating adaptive training drills for any type of musical scale.Data-Driven, Centralized Logic: The application's stability is secured by centralizing all core data. A definitive InstrumentDatabase (Table 1) provides the immutable MIDI map for all audio and theory, while a ScaleDatabase (Tables 2 & 3) leverages Tonal.js as a \"Single Source of Truth\" for all music theory, resolving external data conflicts.A Modern Development & Distribution Pipeline: By adopting Vite for development 40 and a Git-based CI/CD workflow for distribution 52, the project ensures a fast, modern developer experience and a robust, automated deployment-to-production process.This blueprint, when executed, will deliver the robust, scalable, and \"intimate\" learning tool envisioned in the original strategic analysis.1","size_bytes":44121},"database.js":{"content":"// Part II: Definitive Instrument Tuning Database\n// This will be expanded with MIDI values and more instruments as per the blueprint.\nexport const TUNINGS = {\n    'guitar_6': {\n        name: '6-String Guitar (EADGBe)',\n        tuning: [\n            { string: 1, note_index: 4, octave: 4, thickness: 1, open_note: \"E4\", label: \"e\" },\n            { string: 2, note_index: 11, octave: 3, thickness: 2, open_note: \"B3\", label: \"B\" },\n            { string: 3, note_index: 7, octave: 3, thickness: 3, open_note: \"G3\", label: \"G\" },\n            { string: 4, note_index: 2, octave: 3, thickness: 4, open_note: \"D3\", label: \"D\" },\n            { string: 5, note_index: 9, octave: 2, thickness: 5, open_note: \"A2\", label: \"A\" },\n            { string: 6, note_index: 4, octave: 2, thickness: 6, open_note: \"E2\", label: \"E\" }\n        ]\n    },\n    'guitar_7': {\n        name: '7-String Guitar (BEADGBe)',\n        tuning: [\n            { string: 1, note_index: 4, octave: 4, thickness: 1, open_note: \"E4\", label: \"e\" },\n            { string: 2, note_index: 11, octave: 3, thickness: 2, open_note: \"B3\", label: \"B\" },\n            { string: 3, note_index: 7, octave: 3, thickness: 3, open_note: \"G3\", label: \"G\" },\n            { string: 4, note_index: 2, octave: 3, thickness: 4, open_note: \"D3\", label: \"D\" },\n            { string: 5, note_index: 9, octave: 2, thickness: 5, open_note: \"A2\", label: \"A\" },\n            { string: 6, note_index: 4, octave: 2, thickness: 6, open_note: \"E2\", label: \"E\" },\n            { string: 7, note_index: 11, octave: 1, thickness: 7, open_note: \"B1\", label: \"B\" }\n        ]\n    },\n    'bass_4': {\n        name: '4-String Bass (EADG)',\n        tuning: [\n            { string: 1, note_index: 7, octave: 3, thickness: 4, open_note: \"G3\", label: \"G\" },\n            { string: 2, note_index: 2, octave: 3, thickness: 5, open_note: \"D3\", label: \"D\" },\n            { string: 3, note_index: 9, octave: 2, thickness: 6, open_note: \"A2\", label: \"A\" },\n            { string: 4, note_index: 4, octave: 2, thickness: 7, open_note: \"E2\", label: \"E\" }\n        ]\n    },\n    'bass_5': {\n        name: '5-String Bass (BEADG)',\n        tuning: [\n            { string: 1, note_index: 7, octave: 3, thickness: 3, open_note: \"G3\", label: \"G\" },\n            { string: 2, note_index: 2, octave: 3, thickness: 4, open_note: \"D3\", label: \"D\" },\n            { string: 3, note_index: 9, octave: 2, thickness: 5, open_note: \"A2\", label: \"A\" },\n            { string: 4, note_index: 4, octave: 2, thickness: 6, open_note: \"E2\", label: \"E\" },\n            { string: 5, note_index: 11, octave: 1, thickness: 7, open_note: \"B1\", label: \"B\" }\n        ]\n    },\n    'mandolin': {\n        name: 'Mandolin (GDAE)',\n        tuning: [\n            { string: 1, note_index: 4, octave: 5, thickness: 1, open_note: \"E5\", label: \"E\" },\n            { string: 2, note_index: 9, octave: 4, thickness: 2, open_note: \"A4\", label: \"A\" },\n            { string: 3, note_index: 2, octave: 4, thickness: 3, open_note: \"D4\", label: \"D\" },\n            { string: 4, note_index: 7, octave: 3, thickness: 4, open_note: \"G3\", label: \"G\" }\n        ]\n    },\n    'banjo_5': {\n        name: '5-String Banjo (gDGBd)',\n        tuning: [\n            { string: 5, note_index: 7, octave: 4, thickness: 1, open_note: \"G4\", label: \"g\" }, // Drone string (High G)\n            { string: 1, note_index: 2, octave: 4, thickness: 2, open_note: \"D4\", label: \"d\" },\n            { string: 2, note_index: 11, octave: 3, thickness: 3, open_note: \"B3\", label: \"B\" },\n            { string: 3, note_index: 7, octave: 3, thickness: 4, open_note: \"G3\", label: \"G\" },\n            { string: 4, note_index: 2, octave: 3, thickness: 5, open_note: \"D3\", label: \"D\" }\n        ]\n    },\n    'ukulele': {\n        name: 'Ukulele (GCEA)',\n        tuning: [\n            { string: 1, note_index: 9, octave: 4, thickness: 1, open_note: \"A4\", label: \"A\" },\n            { string: 2, note_index: 4, octave: 4, thickness: 2, open_note: \"E4\", label: \"E\" },\n            { string: 3, note_index: 0, octave: 4, thickness: 3, open_note: \"C4\", label: \"C\" },\n            { string: 4, note_index: 7, octave: 4, thickness: 4, open_note: \"G4\", label: \"G\" }\n        ]\n    }\n};\n\n// Part III: Comprehensive Scale and Mode Library\n// This will be used to populate the UI and query Tonal.js\nexport const SCALES = {\n    'Common': [\n        { name: 'Major', intervals: [0, 2, 4, 5, 7, 9, 11] },\n        { name: 'Natural Minor', intervals: [0, 2, 3, 5, 7, 8, 10] },\n        { name: 'Major Pentatonic', intervals: [0, 2, 4, 7, 9] },\n        { name: 'Minor Pentatonic', intervals: [0, 3, 5, 7, 10] },\n        { name: 'Blues', intervals: [0, 3, 5, 6, 7, 10] }\n    ],\n    'Modes': [\n        { name: 'Ionian (Major)', intervals: [0, 2, 4, 5, 7, 9, 11] },\n        { name: 'Dorian', intervals: [0, 2, 3, 5, 7, 9, 10] },\n        { name: 'Phrygian', intervals: [0, 1, 3, 5, 7, 8, 10] },\n        { name: 'Lydian', intervals: [0, 2, 4, 6, 7, 9, 11] },\n        { name: 'Mixolydian', intervals: [0, 2, 4, 5, 7, 9, 10] },\n        { name: 'Aeolian (Minor)', intervals: [0, 2, 3, 5, 7, 8, 10] },\n        { name: 'Locrian', intervals: [0, 1, 3, 5, 6, 8, 10] }\n    ],\n    'Minor': [\n        { name: 'Harmonic Minor', intervals: [0, 2, 3, 5, 7, 8, 11] },\n        { name: 'Melodic Minor', intervals: [0, 2, 3, 5, 7, 9, 11] }\n    ],\n    'Exotic & Unique': [\n        { name: 'Phrygian Dominant', intervals: [0, 1, 4, 5, 7, 8, 10] },\n        { name: 'Byzantine', intervals: [0, 1, 4, 5, 7, 8, 11] },\n        { name: 'Romanian Minor', intervals: [0, 2, 3, 6, 7, 9, 10] },\n        { name: 'Hungarian Gypsy', intervals: [0, 2, 3, 6, 7, 8, 11] },\n        { name: 'Hungarian Major', intervals: [0, 3, 4, 6, 7, 9, 10] },\n        { name: 'Whole Tone', intervals: [0, 2, 4, 6, 8, 10] },\n        { name: 'Diminished (W-H)', intervals: [0, 2, 3, 5, 6, 8, 9, 11] },\n        { name: 'Diminished (H-W)', intervals: [0, 1, 3, 4, 6, 7, 9, 10] },\n        { name: 'Lydian Augmented', intervals: [0, 2, 4, 6, 8, 9, 11] },\n        { name: 'Altered Scale', intervals: [0, 1, 3, 4, 6, 8, 10] },\n        { name: 'Arabian', intervals: [0, 2, 4, 5, 6, 8, 10] },\n        { name: 'Persian', intervals: [0, 1, 4, 5, 6, 8, 11] },\n        { name: 'Oriental', intervals: [0, 1, 4, 5, 6, 9, 10] },\n        { name: 'Prometheus', intervals: [0, 2, 4, 6, 9, 10] },\n        { name: 'Hirajoshi', intervals: [0, 2, 3, 7, 8] },\n        { name: 'Neapolitan Major', intervals: [0, 1, 3, 5, 7, 9, 11] },\n        { name: 'Neapolitan Minor', intervals: [0, 1, 3, 5, 7, 8, 11] },\n        { name: 'Double Harmonic', intervals: [0, 1, 4, 5, 7, 8, 11] },\n        { name: 'Augmented', intervals: [0, 3, 4, 7, 8, 11] },\n        { name: 'Enigmatic', intervals: [0, 1, 4, 6, 8, 10, 11] },\n        { name: 'Algerian', intervals: [0, 2, 3, 6, 7, 8, 11] },\n        { name: 'Balinese', intervals: [0, 1, 3, 7, 8] },\n        { name: 'Chinese', intervals: [0, 4, 6, 7, 11] },\n        { name: 'Egyptian', intervals: [0, 2, 5, 7, 10] },\n        { name: 'Hindu', intervals: [0, 2, 4, 5, 7, 8, 10] },\n        { name: 'Japanese (In Sen)', intervals: [0, 1, 5, 7, 10] },\n        { name: 'Iwato', intervals: [0, 1, 5, 6, 10] },\n        { name: 'Kumoi', intervals: [0, 2, 3, 7, 9] },\n        { name: 'Mongolian', intervals: [0, 2, 4, 7, 9] },\n        { name: 'Pelog', intervals: [0, 1, 3, 7, 8] },\n        { name: 'Spanish (8 Tone)', intervals: [0, 1, 3, 4, 5, 6, 8, 10] }\n    ],\n    'Jazz & Bebop': [\n        { name: 'Bebop Dominant', intervals: [0, 2, 4, 5, 7, 9, 10, 11] },\n        { name: 'Bebop Major', intervals: [0, 2, 4, 5, 7, 8, 9, 11] },\n        { name: 'Bebop Minor', intervals: [0, 2, 3, 5, 7, 8, 9, 10] },\n        { name: 'Bebop Half Diminished', intervals: [0, 2, 3, 5, 6, 8, 9, 10] },\n        { name: 'Lydian Dominant', intervals: [0, 2, 4, 6, 7, 9, 10] }\n    ]\n};\n","size_bytes":7785},"style.css":{"content":"body {\n    font-family: 'Inter', sans-serif;\n    background-color: #f7f7f7;\n    padding: 10px;\n}\n.container {\n    max-width: 100%;\n    margin: auto;\n    padding: 10px;\n}\n.control-group {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 10px;\n}\n@media (min-width: 640px) {\n    .control-group {\n        /* Use 4-column layout like the original file for better alignment */\n        grid-template-columns: repeat(4, 1fr);\n    }\n}\nselect, button, input[type=\"number\"] {\n    border-radius: 0.5rem;\n    padding: 8px 12px;\n    font-size: 1rem;\n    border: 1px solid #D1D5DB; /* Added border for inputs */\n}\n\n/* Fretboard GUI Styles from New File */\n.fretboard-container {\n    position: relative;\n    overflow-x: auto; /* Use auto for scrollbars only when needed */\n    margin-top: 15px;\n    margin-bottom: 30px;\n    padding-bottom: 30px; /* Increased padding for numbers */\n    background-color: #5d4037; /* Fretboard wood color (from original file) */\n    border-radius: 8px;\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);\n    padding-left: 1rem;\n    padding-right: 1rem;\n}\n.fretboard-gui {\n    position: relative;\n    min-width: 1200px; /* Ensures enough room for 15 frets at 75px spacing */\n    padding-top: 25px; /* Increased vertical padding */\n    padding-bottom: 50px;\n    margin-left: 60px; /* Space for string names */\n}\n.fret {\n    position: absolute;\n    height: 100%;\n    border-left: 2px solid #c0c0c0; /* Fret wire color (from original file) */\n    z-index: 10;\n}\n.string {\n    position: absolute;\n    width: 100%;\n    height: 2px;\n    background-color: #ccc; /* String color (from original file) */\n    z-index: 20;\n}\n.fret-dot {\n    position: absolute;\n    width: 1.5rem; /* 24px (from original file) */\n    height: 1.5rem; /* 24px (from original file) */\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 0.75rem; /* 12px (from original file) */\n    font-weight: bold;\n    color: white;\n    z-index: 30;\n    opacity: 0.9;\n    transition: opacity 0.2s;\n    transform: translate(-50%, -50%); /* Use transform for centering */\n}\n.fret-dot.root {\n    background-color: #e53e3e; /* Root color (from original file) */\n    border: 2px solid #fff;\n    box-shadow: 0 0 5px rgba(229, 62, 62, 0.8);\n}\n.fret-dot.scale {\n    background-color: #3182ce; /* Scale color (from original file) */\n}\n.fret-number {\n    position: absolute;\n    bottom: -25px;\n    left: 0;\n    font-size: 0.9rem; /* Larger fret numbers */\n    color: #ccc;\n    text-align: center;\n    width: 75px; /* Matches FRET_SPACING */\n    transform: translateX(-50%);\n}\n.fret-marker {\n    position: absolute;\n    width: 0.75rem;\n    height: 0.75rem;\n    background-color: #d1d5db;\n    border-radius: 50%;\n    z-index: 15;\n    transform: translate(-50%, -50%); /* Center the marker */\n}\n.string-label {\n    position: absolute;\n    left: -50px;\n    font-size: 0.9rem;\n    color: #ddd;\n    white-space: nowrap;\n    transform: translateY(-50%); /* Vertically center label on string */\n}\n\n/* NEW: Interactive Key & Harmony Section Styles */\n.key-harmony-section {\n    background-color: #f8fafc; /* Lighter gray */\n    border-top: 4px solid #6366f1; /* Indigo */\n}\n.circle-of-fifths {\n    position: relative;\n    width: 300px;\n    height: 300px;\n    margin: 2rem auto;\n}\n.key-button {\n    position: absolute;\n    width: 60px;\n    height: 60px;\n    background-color: #fff;\n    border: 2px solid #d1d5db;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.2s ease-in-out;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n}\n.key-button:hover {\n    transform: scale(1.1);\n    border-color: #4f46e5;\n    color: #4f46e5;\n}\n.key-button.active {\n    background-color: #4f46e5;\n    color: #fff;\n    border-color: #4f46e5;\n    transform: scale(1.1);\n    box-shadow: 0 0 15px rgba(79, 70, 229, 0.5);\n}\n.diatonic-chord-btn {\n    transition: all 0.2s ease-in-out;\n}\n.diatonic-chord-btn.active {\n    transform: scale(1.05);\n    box-shadow: 0 0 10px rgba(79, 70, 229, 0.4);\n}\n#chord-display-container {\n    min-height: 300px;\n}\n\n/* NEW: Accordion Styles for Fundamentals Library */\n.accordion-header {\n    cursor: pointer;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0.75rem 1rem;\n    background-color: #f3f4f6;\n    border-radius: 0.5rem;\n    font-weight: 600;\n    color: #4b5563;\n    transition: background-color 0.2s;\n}\n.accordion-header:hover {\n    background-color: #e5e7eb;\n}\n.accordion-content {\n    max-height: 0;\n    overflow: hidden;\n    transition: max-height 0.3s ease-out;\n    background-color: #fafafa;\n    border-radius: 0 0 0.5rem 0.5rem;\n}\n.accordion-content p {\n    padding: 1rem;\n    margin: 0;\n}\n.accordion-symbol {\n    font-weight: bold;\n    transition: transform 0.3s;\n}\n.accordion-header.active .accordion-symbol {\n    transform: rotate(45deg);\n}\n\n/* Accordion Item Structure (for Six-Module System) */\n.accordion-item {\n    margin-bottom: 0.75rem;\n}\n\n.accordion-item .accordion-header {\n    margin: 0;\n    padding: 0;\n}\n\n.accordion-button {\n    width: 100%;\n    text-align: left;\n    cursor: pointer;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0.875rem 1rem;\n    background-color: #f9fafb;\n    border: 1px solid #e5e7eb;\n    border-radius: 0.5rem;\n    font-weight: 600;\n    font-size: 0.95rem;\n    color: #374151;\n    transition: all 0.2s;\n}\n\n.accordion-button:hover {\n    background-color: #f3f4f6;\n    border-color: #d1d5db;\n}\n\n.accordion-button:not(.collapsed) {\n    background-color: #eef2ff;\n    border-color: #c7d2fe;\n    color: #4338ca;\n    border-bottom-left-radius: 0;\n    border-bottom-right-radius: 0;\n}\n\n.accordion-button::after {\n    content: '+';\n    font-size: 1.25rem;\n    font-weight: bold;\n    color: #6b7280;\n    transition: transform 0.3s;\n}\n\n.accordion-button:not(.collapsed)::after {\n    content: '−';\n    color: #4338ca;\n}\n\n.accordion-item .accordion-content {\n    max-height: 0;\n    overflow: hidden;\n    transition: max-height 0.4s ease-out;\n    background-color: #ffffff;\n    border: 1px solid #e5e7eb;\n    border-top: none;\n    border-radius: 0 0 0.5rem 0.5rem;\n}\n\n.accordion-item .accordion-content p {\n    padding: 0.875rem 1rem;\n    margin: 0 0 0.75rem 0;\n    color: #4b5563;\n    font-size: 0.9rem;\n    line-height: 1.6;\n}\n\n.accordion-item .accordion-content p:last-child {\n    margin-bottom: 0.5rem;\n}\n\n.accordion-item .accordion-content ul {\n    margin: 0;\n    padding: 0 1rem 0.875rem 1rem;\n}\n\n.accordion-item .accordion-content li {\n    color: #4b5563;\n    font-size: 0.9rem;\n    line-height: 1.6;\n    margin-bottom: 0.5rem;\n}\n\n\n/* ===== MANUSCRIPT METHOD STYLING (Minimalist Design) ===== */\n\n/* Container */\n.manuscript-container {\n    border: 1px solid #111;\n    padding: 24px;\n    max-width: 960px;\n    margin: 0 auto 48px;\n    background: #fff;\n}\n\n/* Title and Subtitle */\n.manuscript-title {\n    font-size: 24px;\n    font-weight: bold;\n    text-align: center;\n    margin: 0 0 8px 0;\n    color: #111;\n}\n\n.manuscript-subtitle {\n    font-size: 14px;\n    text-align: center;\n    margin: 0 0 20px 0;\n    color: #111;\n}\n\n/* Play Controls */\n.manuscript-controls {\n    display: flex;\n    gap: 12px;\n    justify-content: flex-start;\n    margin-bottom: 24px;\n}\n\n.manuscript-btn {\n    border: 1px solid #111;\n    padding: 8px 16px;\n    background: #fff;\n    font-family: \"Helvetica Neue\", Arial, sans-serif;\n    font-size: 13px;\n    letter-spacing: 0.5px;\n    cursor: pointer;\n    transition: background 0.15s;\n}\n\n.manuscript-btn:hover {\n    background: #f5f5f5;\n}\n\n.manuscript-btn:active {\n    background: #e0e0e0;\n}\n\n/* Phase Sections */\n.manuscript-phase {\n    margin-bottom: 32px;\n}\n\n.phase-title {\n    font-size: 18px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 1px;\n    margin: 0 0 4px 0;\n    color: #111;\n}\n\n.phase-description {\n    font-size: 13px;\n    margin: 4px 0 12px 0;\n    color: #111;\n}\n\n/* Tab Display Container */\n.tab-display {\n    background: #fff;\n    border: 1px solid #111;\n    padding: 16px 12px;\n    font-family: \"Courier Prime\", \"Courier New\", Consolas, Monaco, monospace;\n    font-size: 14px;\n    line-height: 16px;\n    overflow-x: auto;\n}\n\n/* Tab Container - holds labels + staff */\n.tab-container {\n    display: flex;\n    gap: 8px;\n    margin-bottom: 16px;\n}\n\n/* String Labels Column */\n.tab-string-labels {\n    display: flex;\n    flex-direction: column;\n    gap: 0;\n    padding-top: 8px;\n}\n\n.tab-string-label {\n    width: 44px;\n    height: 28px;\n    display: flex;\n    align-items: center;\n    justify-content: flex-start;\n    font-size: 19px;\n    font-weight: bold;\n    font-family: \"Courier Prime\", \"Courier New\", Consolas, Monaco, monospace;\n    color: #111;\n}\n\n/* Tab Staff - Horizontal layout with vertical beat columns */\n.tab-staff {\n    font-family: \"Courier Prime\", \"Courier New\", Consolas, Monaco, monospace;\n    font-size: 14px;\n    line-height: 1;\n    display: flex;\n    align-items: flex-start;\n    gap: 0;\n    padding: 8px 0;\n}\n\n/* Each beat is a vertical column showing all 6 strings */\n.tab-beat-column {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0;\n}\n\n/* Warning style for beats with extreme finger stretches */\n.tab-beat-column.tab-beat-stretch {\n    background-color: #fee;\n    border: 2px solid #e53e3e;\n    border-radius: 4px;\n    padding: 2px;\n    margin: -2px;\n}\n\n.tab-beat-column.tab-beat-stretch .tab-fret-cell {\n    background-color: #fff5f5;\n    color: #c53030;\n}\n\n/* Fret cells stack vertically */\n.tab-fret-cell {\n    width: 48px;\n    height: 28px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-size: 22px;\n    font-weight: bold;\n    letter-spacing: 0;\n    border-bottom: 1px solid #111;\n}\n\n/* Last string (E2 - 6th in order) gets thicker border */\n.tab-beat-column .tab-fret-cell:last-child {\n    border-bottom-width: 2px;\n}\n\n/* Measure Separators (every 4 beats) */\n.tab-measure-separator {\n    width: 2px;\n    background: #111;\n    align-self: stretch;\n    margin: 0 12px;\n}\n\n/* Bar Breaks (every 16 beats) */\n.tab-bar-break {\n    width: 100%;\n    height: 12px;\n}\n\n/* ====================================\n   LANDSCAPE CHORD DIAGRAM STYLES\n   ==================================== */\n\n/* Container for multiple chord diagrams side-by-side */\n.chord-diagrams-container {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 2rem;\n    justify-content: flex-start;\n    margin-top: 1rem;\n}\n\n/* Individual chord diagram box */\n.chord-diagram-item {\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 16px;\n    line-height: 1.2;\n    background: #fff;\n    border: 2px solid #111;\n    padding: 1rem;\n    text-align: center;\n}\n\n/* Chord title */\n.chord-diagram-title {\n    font-weight: bold;\n    font-size: 14px;\n    margin-bottom: 0.5rem;\n    color: #111;\n    text-align: center;\n}\n\n/* Fret position marker (e.g., Position: 5fr) */\n.chord-fret-marker {\n    font-size: 11px;\n    color: #666;\n    margin-bottom: 0.5rem;\n    text-align: center;\n}\n\n/* Landscape fretboard container */\n.chord-fretboard-landscape {\n    display: flex;\n    flex-direction: column;\n    align-items: flex-start;\n    margin-top: 0.5rem;\n}\n\n/* Each string row (horizontal) */\n.chord-string-row {\n    display: flex;\n    align-items: center;\n    line-height: 1;\n    margin: 0;\n    padding: 0;\n}\n\n/* String label on left (e.g., \"e x\" or \"E o\") */\n.chord-string-label {\n    font-size: 12px;\n    font-weight: bold;\n    color: #111;\n    min-width: 28px;\n    text-align: left;\n    margin-right: 4px;\n}\n\n/* Nut (thick line at open position) */\n.chord-nut {\n    font-size: 18px;\n    color: #111;\n    line-height: 1;\n    font-weight: bold;\n    padding: 0 2px;\n}\n\n/* Edge (for non-open positions) */\n.chord-edge {\n    font-size: 16px;\n    color: #111;\n    line-height: 1;\n    padding: 0 2px;\n}\n\n/* Fret cell (space between frets) */\n.chord-fret-cell {\n    font-size: 16px;\n    color: #111;\n    line-height: 1;\n    width: 28px;\n    text-align: center;\n}\n\n/* Fret cell with finger */\n.chord-fret-cell.finger {\n    font-weight: bold;\n    color: #000;\n}\n\n/* Fret line (vertical) */\n.chord-fret-line {\n    font-size: 16px;\n    color: #111;\n    line-height: 1;\n    padding: 0 2px;\n}\n\n/* Fret numbers row below diagram */\n.chord-fret-numbers {\n    display: flex;\n    align-items: center;\n    line-height: 1;\n    margin-top: 2px;\n}\n\n/* Individual fret number */\n.chord-fret-number {\n    font-size: 10px;\n    color: #666;\n    line-height: 1;\n    width: 28px;\n    text-align: center;\n}","size_bytes":12585},"replit.md":{"content":"# The Fretboard Training Manuscripts\n\n## Overview\nThis project is an interactive web application designed to help guitarists, bassists, and other stringed instrument players visualize scales and modes, learn chord progressions, practice with generated tablature sequences, and understand music theory fundamentals. The business vision is to provide a comprehensive, intuitive, and accessible tool that enhances musical learning and practice for stringed instrument players, potentially expanding into a widely used educational platform.\n\n## User Preferences\nI prefer a minimalist design with a focus on clear, functional elements. The visual aesthetic should be clean and monochrome, prioritizing readability and precise typography. I value direct feedback and immediate visual updates when I make selections. I also prefer to keep the `public/` directory for static assets and the core application logic in `main.js`. I want the agent to use a \"practice-first\" approach, meaning that practice materials should be prioritized in the layout. Do not make changes to the file `vite.config.js`.\n\n## System Architecture\nThe application is a fully functional frontend built with Vite and vanilla JavaScript. It uses external CDN libraries for music theory (Tonal.js) and audio synthesis (Tone.js). Chord diagrams are rendered using a custom text-based ASCII system for enhanced reliability and customization. The UI/UX prioritizes a clean, minimalist design with precise monospaced typography, particularly for tablature and chord diagrams, using a monochrome styling.\n\n**Technical Implementations & Feature Specifications:**\n-   **Fretboard Visualization**: Displays scale patterns interactively, supporting multiple instruments (6/7-string guitars, 4/5-string basses, mandolin, ukulele, 5-string banjo).\n-   **Extensive Scale Library**: Includes over 50 scales covering Western, Modal, Exotic, and Jazz styles.\n-   **Interactive Harmony**: Automatically displays diatonic chords and common progressions based on the selected root note from the main menu. Features comprehensive chord diagrams with proper string orientation (thickest on bottom, thinnest on top).\n-   **Algorithmic Tablature Training**: Fully algorithmic tab generation system (tab_generator.js) that creates comprehensive 512-beat (32-measure) pedagogical tablature sequences for ANY key and ANY instrument. Uses a 6-module pedagogical framework: Module 1 (M1-M6): Single-String Linearization with rotation system; Module 2 (M7-M10): Positional Scale Fragments with timeline-based vertical integration across strings; Module 3 (M11-M16): Diatonic Melodic Patterns; Module 4 (M17-M21): Harmonic Context with chord arpeggios using scale's I chord tones; Module 5 (M22-M26): Multi-Octave Scale Traversal; Module 6 (M27-M32): Virtuosic Capstone Runs. Completely replaced deprecated CSV-transpose approach.\n-   **Dynamic Audio Playback**: Intelligent audio synthesis system that plays the actual generated tablature using Tone.js. Automatically adapts to the selected instrument's tuning, respects the user's BPM setting, and converts fret positions to accurate MIDI notes using Tonal.js. Works seamlessly across all supported instruments (guitars, basses, ukulele, mandolin, banjo) and all keys.\n-   **CAGED Chord Auto-Generation**: Implements a system to auto-generate multiple major and minor chord voicings across low, mid, and high fretboard positions, merging with a comprehensive database of over 100 chord positions. Includes a fallback mechanism for complex chords.\n-   **Text-Based Chord Diagrams**: Custom ASCII rendering for chord diagrams, displaying string indicators (x/o), fret position markers, and finger numbers (1-4) or dots. Diagrams are landscape oriented with strings running horizontally, properly ordered from thinnest (top) to thickest (bottom).\n-   **Educational Content**: Comprehensive Six-Module System pedagogy integrated via collapsible accordion sections explaining the TFTM (The Fretboard Training Manuscripts) Method. Five detailed accordion sections cover: (1) The Problem & Solution - how traditional education fragments knowledge and how TFTM provides a unified system; (2) Module 1: Foundational Mechanics - rhythm, timing, and technique; (3) Modules 2 & 3: Total Scale Mastery - horizontal and vertical fretboard knowledge; (4) Module 4: Harmonic Context - chords and arpeggios; (5) Modules 5 & 6: Virtuosity - building speed and complete fretboard fluency. Additional accordions provide fundamentals on scales, chords, and progressions.\n-   **Finger Stretch Detection**: Visual warning system that highlights tablature beats containing impossible finger stretches (>5 frets), displaying red borders and tooltips to alert users to problematic positions.\n-   **Instrument Range Validation**: Tab generator respects instrument-specific fret ranges (mandolin/banjo/ukulele: 12 frets, guitars: 15 frets, bass: 20 frets) to ensure all generated patterns are playable within each instrument's physical constraints.\n-   **Progressive Web App (PWA)**: Full PWA implementation with service worker for offline functionality, installable on mobile devices (iOS/Android), custom app icons, and native app-like experience with standalone display mode.\n-   **Layout**: The page flow is optimized for learning: Scale Menu → GUI Fretboard → Training Tablature → Strings as Rows (dedicated view) → Interactive Key & Harmony.\n\n**System Design Choices:**\n-   **Modularity**: Core logic in `main.js`, instrument tunings and scale definitions in `database.js`, chord data in `chord_shapes.json`, PWA manifest and service worker in `public/`.\n-   **Performance**: Utilizes Vite for fast development and optimized production builds. Service worker caches static assets for offline access.\n-   **Responsiveness**: Tablature and fretboard visualizations dynamically update with user input.\n-   **Consistent Aesthetic**: Adherence to a monochrome, monospaced font aesthetic for all musical notation displays.\n-   **Mobile-First PWA**: Installable on iOS/Android devices with app icons (192x192, 512x512), manifest.json for app metadata, and service worker for offline functionality and caching.\n\n## External Dependencies\n-   **Build Tool**: Vite\n-   **Styling**: Tailwind CSS (CDN)\n-   **Music Theory**: Tonal.js (CDN)\n-   **Audio**: Tone.js (CDN)","size_bytes":6327},"vite.config.js":{"content":"import { defineConfig } from 'vite'\n\nexport default defineConfig({\n  server: {\n    host: '0.0.0.0',\n    port: 5000,\n    strictPort: true,\n    hmr: {\n      clientPort: 5000\n    },\n    allowedHosts: true\n  },\n  preview: {\n    host: '0.0.0.0',\n    port: 5000,\n    strictPort: true,\n    allowedHosts: true\n  }\n})\n","size_bytes":309},"attached_assets/content-1763174795294.md":{"content":"[Skip to content](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts#start-of-content)\n\nYou signed in with another tab or window. [Reload](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts) to refresh your session.Dismiss alert\n\n{{ message }}\n\n[TheBigCaker](https://github.com/TheBigCaker)/ **[TheFretboardTrainingManuscripts](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts)** Public\n\n- [Notifications](https://github.com/login?return_to=%2FTheBigCaker%2FTheFretboardTrainingManuscripts) You must be signed in to change notification settings\n- [Fork\\\\\n0](https://github.com/login?return_to=%2FTheBigCaker%2FTheFretboardTrainingManuscripts)\n- [Star\\\\\n0](https://github.com/login?return_to=%2FTheBigCaker%2FTheFretboardTrainingManuscripts)\n\n\n[the-fretboard-training-manuscripts.vercel.app](https://the-fretboard-training-manuscripts.vercel.app/ \"https://the-fretboard-training-manuscripts.vercel.app\")\n\n### License\n\n[MIT license](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/LICENSE)\n\n[0\\\\\nstars](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/stargazers) [0\\\\\nforks](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/forks) [Branches](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/branches) [Tags](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tags) [Activity](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/activity)\n\n[Star](https://github.com/login?return_to=%2FTheBigCaker%2FTheFretboardTrainingManuscripts)\n\n[Notifications](https://github.com/login?return_to=%2FTheBigCaker%2FTheFretboardTrainingManuscripts) You must be signed in to change notification settings\n\n# TheBigCaker/TheFretboardTrainingManuscripts\n\nTFTM\n\n[**1** Branch](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/branches) [**0** Tags](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tags)\n\n[Go to Branches page](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/branches)[Go to Tags page](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tags)\n\nGo to file\n\nCode\n\nOpen more actions menu\n\n## Folders and files\n\n| Name | Name | Last commit message | Last commit date |\n| --- | --- | --- | --- |\n| ## Latest commit<br>[![TheBigCaker](https://avatars.githubusercontent.com/u/107896372?v=4&size=40)](https://github.com/TheBigCaker)[TheBigCaker](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commits?author=TheBigCaker)<br>[12312](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/303941b95def2b2f12888b7957658dc8ee599185)<br>4 minutes agoNov 14, 2025<br>[303941b](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/303941b95def2b2f12888b7957658dc8ee599185) · 4 minutes agoNov 14, 2025<br>## History<br>[70 Commits](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commits/TFTM/) <br>Open commit details<br>[View commit history for this file.](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commits/TFTM/) |\n| [.local/state/replit/agent](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/.local/state/replit/agent \"This path skips through empty directories\") | [.local/state/replit/agent](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/.local/state/replit/agent \"This path skips through empty directories\") | [12312](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/303941b95def2b2f12888b7957658dc8ee599185 \"12312\") | 4 minutes agoNov 14, 2025 |\n| [attached\\_assets](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/attached_assets \"attached_assets\") | [attached\\_assets](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/attached_assets \"attached_assets\") | [Update chord display and arrangement for better user experience](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/512228ecfcedca0cec9c4a25d1e84a406600b8f1 \"Update chord display and arrangement for better user experience  Modify the display of chords and their associated strings to improve readability and user interaction.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: e6f8474f-6092-46fd-96d3-6f933f60a176 Replit-Commit-Checkpoint-Type: full_checkpoint Replit-Commit-Event-Id: f3a63184-15b7-4aef-880a-16c9cfece4d5 Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/e6f8474f-6092-46fd-96d3-6f933f60a176/qvioieC\") | 3 hours agoNov 14, 2025 |\n| [dist](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/dist \"dist\") | [dist](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/dist \"dist\") | [wrarwr](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/85f2a64597a1cc0c316ac6517c59bb109a9d46f5 \"wrarwr\") | yesterdayNov 13, 2025 |\n| [public](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/public \"public\") | [public](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/public \"public\") | [Update chord data and add new navigation pages for scales and chords](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/d183cfd70fc028f7c23551bc5e85d283e887dfb0 \"Update chord data and add new navigation pages for scales and chords  Modify public/chord_shapes.json to include new chord variations and update attached markdown files for navigation pages related to musical scales and chord databases.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: e6f8474f-6092-46fd-96d3-6f933f60a176 Replit-Commit-Checkpoint-Type: intermediate_checkpoint Replit-Commit-Event-Id: da53da6f-550a-4477-8be3-a6fb4ffec396 Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/e6f8474f-6092-46fd-96d3-6f933f60a176/DWkjdVF\") | 4 hours agoNov 14, 2025 |\n| [.gitattributes](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/.gitattributes \".gitattributes\") | [.gitattributes](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/.gitattributes \".gitattributes\") | [Initial commit](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/2cd16c3413d8ec5de6810d496399f2d0a9462240 \"Initial commit\") | yesterdayNov 13, 2025 |\n| [.gitignore](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/.gitignore \".gitignore\") | [.gitignore](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/.gitignore \".gitignore\") | [Initial commit](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/2cd16c3413d8ec5de6810d496399f2d0a9462240 \"Initial commit\") | yesterdayNov 13, 2025 |\n| [.replit](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/.replit \".replit\") | [.replit](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/.replit \".replit\") | [12312](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/303941b95def2b2f12888b7957658dc8ee599185 \"12312\") | 4 minutes agoNov 14, 2025 |\n| [A Strategic Analysis and Implementation Roadmap for FretboardManucripts.docx](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/A%20Strategic%20Analysis%20and%20Implementation%20Roadmap%20for%20FretboardManucripts.docx \"A Strategic Analysis and Implementation Roadmap for FretboardManucripts.docx\") | [A Strategic Analysis and Implementation Roadmap for FretboardManucripts.docx](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/A%20Strategic%20Analysis%20and%20Implementation%20Roadmap%20for%20FretboardManucripts.docx \"A Strategic Analysis and Implementation Roadmap for FretboardManucripts.docx\") | [Initial commit](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/2cd16c3413d8ec5de6810d496399f2d0a9462240 \"Initial commit\") | yesterdayNov 13, 2025 |\n| [LICENSE](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/LICENSE \"LICENSE\") | [LICENSE](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/LICENSE \"LICENSE\") | [Initial commit](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/2cd16c3413d8ec5de6810d496399f2d0a9462240 \"Initial commit\") | yesterdayNov 13, 2025 |\n| [Plan.md](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/Plan.md \"Plan.md\") | [Plan.md](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/Plan.md \"Plan.md\") | [Initial commit](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/2cd16c3413d8ec5de6810d496399f2d0a9462240 \"Initial commit\") | yesterdayNov 13, 2025 |\n| [TFTM\\_Test.pdf](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/TFTM_Test.pdf \"TFTM_Test.pdf\") | [TFTM\\_Test.pdf](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/TFTM_Test.pdf \"TFTM_Test.pdf\") | [1](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/67ea03193723ce8db99907714a7decfe2282004d \"1\") | yesterdayNov 13, 2025 |\n| [database.js](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/database.js \"database.js\") | [database.js](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/database.js \"database.js\") | [Merge branch 'TFTM' of](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/f234d2c997a401343b7d922430b4d3882b18d143 \"Merge branch 'TFTM' of https://github.com/TheBigCaker/TheFretboardTrainingManuscripts into TFTM\") [https://github.com/TheBigCaker/TheFretboardTra…](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts) | 5 minutes agoNov 14, 2025 |\n| [index.html](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/index.html \"index.html\") | [index.html](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/index.html \"index.html\") | [Add interactive fretboard view displaying strings as rows](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/db71d0a601ee3a9365bc09e83db3db5accc066d3 \"Add interactive fretboard view displaying strings as rows  Introduced a new HTML section for displaying strings as rows and implemented a helper function `getSemitoneDistance` in `main.js` to calculate semitone differences, which refactors chord generation logic and ensures the new fretboard view is always populated.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: e6f8474f-6092-46fd-96d3-6f933f60a176 Replit-Commit-Checkpoint-Type: intermediate_checkpoint Replit-Commit-Event-Id: b09f072c-549f-4582-9eaa-ea1d466af8df Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/e6f8474f-6092-46fd-96d3-6f933f60a176/kSvLc8K\") | 4 hours agoNov 14, 2025 |\n| [main.js](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/main.js \"main.js\") | [main.js](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/main.js \"main.js\") | [Merge branch 'TFTM' of](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/f234d2c997a401343b7d922430b4d3882b18d143 \"Merge branch 'TFTM' of https://github.com/TheBigCaker/TheFretboardTrainingManuscripts into TFTM\") [https://github.com/TheBigCaker/TheFretboardTra…](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts) | 5 minutes agoNov 14, 2025 |\n| [package-lock.json](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/package-lock.json \"package-lock.json\") | [package-lock.json](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/package-lock.json \"package-lock.json\") | [Add project setup and configuration for a music theory tool](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/0efcc93dd3d54193d40d498ebb7d321ec5a132e1 \"Add project setup and configuration for a music theory tool  Configure Vite build tool with ES module support, define npm scripts for development and production builds, and set up the development server to run on port 5000 with host 0.0.0.0.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: 8b62e7e6-46d3-44ad-a44d-2da875ba6092 Replit-Commit-Checkpoint-Type: intermediate_checkpoint Replit-Commit-Event-Id: 2ca718df-b90c-447e-8ea9-cf214ad326ea Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/8b62e7e6-46d3-44ad-a44d-2da875ba6092/tDJefkv\") | yesterdayNov 13, 2025 |\n| [package.json](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/package.json \"package.json\") | [package.json](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/package.json \"package.json\") | [Add project setup and configuration for a music theory tool](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/0efcc93dd3d54193d40d498ebb7d321ec5a132e1 \"Add project setup and configuration for a music theory tool  Configure Vite build tool with ES module support, define npm scripts for development and production builds, and set up the development server to run on port 5000 with host 0.0.0.0.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: 8b62e7e6-46d3-44ad-a44d-2da875ba6092 Replit-Commit-Checkpoint-Type: intermediate_checkpoint Replit-Commit-Event-Id: 2ca718df-b90c-447e-8ea9-cf214ad326ea Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/8b62e7e6-46d3-44ad-a44d-2da875ba6092/tDJefkv\") | yesterdayNov 13, 2025 |\n| [replit.md](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/replit.md \"replit.md\") | [replit.md](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/replit.md \"replit.md\") | [Improve layout and default tablature view for better user experience](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/85601efdbbffd3c7e3e0b2a2bb20108300343c8b \"Improve layout and default tablature view for better user experience  Updated default tablature orientation to \\\"Strings as Rows\\\" and reordered page sections for improved workflow.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: e6f8474f-6092-46fd-96d3-6f933f60a176 Replit-Commit-Checkpoint-Type: full_checkpoint Replit-Commit-Event-Id: 1be66087-244c-4e29-afac-f099452136ca Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/e6f8474f-6092-46fd-96d3-6f933f60a176/qvioieC\") | 4 hours agoNov 14, 2025 |\n| [style.css](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/style.css \"style.css\") | [style.css](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/style.css \"style.css\") | [Add detailed explanations for chord diagrams and progressions](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/c2d14de7f1ded3fe11a58b596eb14f4eba65a8bc \"Add detailed explanations for chord diagrams and progressions  Update index.html to include detailed explanations and diagrams for understanding chord diagrams and progressions. Modify main.js to render chord diagrams in a landscape orientation. Adjust style.css for the new landscape chord diagram styles.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: e6f8474f-6092-46fd-96d3-6f933f60a176 Replit-Commit-Checkpoint-Type: intermediate_checkpoint Replit-Commit-Event-Id: 5658f9a4-5f3e-4053-b8a9-b38ba8e4efc2 Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/e6f8474f-6092-46fd-96d3-6f933f60a176/KMwAiTD\") | 4 hours agoNov 14, 2025 |\n| [vite.config.js](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/vite.config.js \"vite.config.js\") | [vite.config.js](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/vite.config.js \"vite.config.js\") | [Allow any host to connect to the development server](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/950d43a7cfe83f9fa0cdcf8abe39fba04de87e12 \"Allow any host to connect to the development server  Update vite.config.js to enable `allowedHosts: true` for both the dev server and preview, resolving blocked request errors for specific hosts like those on Replit.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: 8b62e7e6-46d3-44ad-a44d-2da875ba6092 Replit-Commit-Checkpoint-Type: full_checkpoint Replit-Commit-Event-Id: 85e7eb2d-2ec3-4dc1-96f1-d4d74c5e39d9 Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/8b62e7e6-46d3-44ad-a44d-2da875ba6092/MxEU7O4\") | yesterdayNov 13, 2025 |\n| View all files |\n\n## Repository files navigation\n\n```\nMIT License\n\nCopyright (c) 2025 TheBigCaker\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n```\n\n## About\n\n[the-fretboard-training-manuscripts.vercel.app](https://the-fretboard-training-manuscripts.vercel.app/ \"https://the-fretboard-training-manuscripts.vercel.app\")\n\n### License\n\n[MIT license](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts#MIT-1-ov-file)\n\n### Uh oh!\n\nThere was an error while loading. [Please reload this page](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts).\n\n[Activity](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/activity)\n\n### Stars\n\n[**0**\\\\\nstars](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/stargazers)\n\n### Watchers\n\n[**0**\\\\\nwatching](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/watchers)\n\n### Forks\n\n[**0**\\\\\nforks](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/forks)\n\n[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FTheBigCaker%2FTheFretboardTrainingManuscripts&report=TheBigCaker+%28user%29)\n\n## [Releases](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/releases)\n\nNo releases published\n\n## [Packages\\  0](https://github.com/users/TheBigCaker/packages?repo_name=TheFretboardTrainingManuscripts)\n\nNo packages published\n\n## Languages\n\n- [JavaScript78.6%](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/search?l=javascript)\n- [HTML13.2%](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/search?l=html)\n- [CSS8.2%](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/search?l=css)\n\nYou can’t perform that action at this time.","size_bytes":19796},"csv_tab_parser.js":{"content":"// ========== CSV-BASED TAB GENERATOR ==========\n// Parses C_Major_Guitar_Training_Tablature.csv and transposes to any instrument/key\n// Preserves the exact pedagogical sequence from the original template\n\nconst CHROMATIC = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n\n// Guitar standard tuning (the source instrument in the CSV)\nconst GUITAR_TUNING = ['E4', 'B3', 'G3', 'D3', 'A2', 'E2'];\n\n// Convert flat notes to their sharp equivalents\nfunction flatToSharp(note) {\n    const flatToSharpMap = {\n        'CB': 'B', 'DB': 'C#', 'EB': 'D#', 'FB': 'E',\n        'GB': 'F#', 'AB': 'G#', 'BB': 'A#'\n    };\n    \n    if (!note || typeof note !== 'string') return note;\n    \n    // Normalize symbols first\n    const cleaned = note.replace('♯', '#').replace('♭', 'b').toUpperCase();\n    \n    // Handle note with octave (e.g., \"BB3\" -> \"A#3\")\n    const matchWithOctave = cleaned.match(/^([A-G]B?)(\\d+)$/);\n    if (matchWithOctave) {\n        const notePart = matchWithOctave[1];\n        const octave = matchWithOctave[2];\n        const sharp = flatToSharpMap[notePart];\n        return sharp ? `${sharp}${octave}` : cleaned;\n    }\n    \n    // Handle note without octave (e.g., \"BB\" -> \"A#\")\n    const matchNoOctave = cleaned.match(/^([A-G]B?)$/);\n    if (matchNoOctave) {\n        const notePart = matchNoOctave[1];\n        const sharp = flatToSharpMap[notePart];\n        return sharp || cleaned;\n    }\n    \n    return cleaned;\n}\n\n// Helper: Normalize note names\nfunction normalizeNote(note) {\n    if (!note || typeof note !== 'string') return '';\n    return flatToSharp(note);\n}\n\n// Helper: Parse note name to get pitch class and octave\nfunction parseNoteName(noteName) {\n    const normalized = normalizeNote(noteName);\n    const match = normalized.match(/^([A-G]#?)(\\d+)$/);\n    if (!match) return null;\n    return { pitchClass: match[1], octave: parseInt(match[2]) };\n}\n\n// Helper: Convert note name to MIDI number\nfunction noteToMidi(noteName) {\n    const parsed = parseNoteName(noteName);\n    if (!parsed) return null;\n    \n    const noteIndex = CHROMATIC.indexOf(parsed.pitchClass);\n    if (noteIndex === -1) return null;\n    \n    return (parsed.octave + 1) * 12 + noteIndex;\n}\n\n// Helper: Convert MIDI to note name\nfunction midiToNoteName(midi) {\n    const octave = Math.floor(midi / 12) - 1;\n    const noteIndex = midi % 12;\n    return CHROMATIC[noteIndex] + octave;\n}\n\n// Helper: Get semitone interval between two pitch classes\nfunction getSemitoneInterval(fromNote, toNote) {\n    const fromIndex = CHROMATIC.indexOf(normalizeNote(fromNote));\n    const toIndex = CHROMATIC.indexOf(normalizeNote(toNote));\n    \n    if (fromIndex === -1 || toIndex === -1) return 0;\n    \n    let interval = toIndex - fromIndex;\n    if (interval < 0) interval += 12;\n    return interval;\n}\n\n// Parse CSV text and extract universal note sequence\nfunction parseCSVToNoteSequence(csvText) {\n    const lines = csvText.split('\\n').map(line => line.trim()).filter(line => line);\n    const noteSequence = [];\n    \n    let currentBeat = 1;\n    let firstParse = true;\n    \n    for (let i = 0; i < lines.length; i++) {\n        const line = lines[i];\n        const cells = line.split(',').map(cell => cell.trim());\n        \n        // Check if this is a \"Strings\\Beats>\" header row\n        if (cells[0] && (cells[0].includes('Strings') || cells[0].includes('Beat'))) {\n            // Next 6 rows are the string data\n            const stringRows = [];\n            for (let j = 1; j <= 6 && (i + j) < lines.length; j++) {\n                const stringLine = lines[i + j];\n                const stringCells = stringLine.split(',').map(cell => cell.trim());\n                \n                // First cell is the string name\n                const stringName = stringCells[0];\n                if (stringName && (stringName.includes('e4') || stringName.includes('B3') || \n                                   stringName.includes('G3') || stringName.includes('D3') || \n                                   stringName.includes('A2') || stringName.includes('E2'))) {\n                    stringRows.push({\n                        stringName: normalizeNote(stringName),\n                        frets: stringCells.slice(1)\n                    });\n                }\n            }\n            \n            \n            // Process this measure's beats\n            if (stringRows.length > 0) {\n                const beatsInMeasure = Math.max(...stringRows.map(r => r.frets.length));\n                \n                for (let beatIdx = 0; beatIdx < beatsInMeasure; beatIdx++) {\n                    // Check each string for a fret at this beat\n                    for (let stringIdx = 0; stringIdx < stringRows.length; stringIdx++) {\n                        const fret = stringRows[stringIdx].frets[beatIdx];\n                        \n                        if (fret && fret !== '' && !isNaN(fret)) {\n                            // Convert fret position to note name\n                            const stringName = GUITAR_TUNING[stringIdx];\n                            const stringMidi = noteToMidi(stringName);\n                            const noteMidi = stringMidi + parseInt(fret);\n                            const noteName = midiToNoteName(noteMidi);\n                            \n                            noteSequence.push({\n                                beat: currentBeat + beatIdx,\n                                note: noteName,\n                                stringIndex: stringIdx,\n                                originalFret: parseInt(fret)\n                            });\n                        }\n                    }\n                }\n                \n                currentBeat += beatsInMeasure;\n            }\n            \n            // Skip past the string rows we just processed\n            i += 6;\n        }\n    }\n    \n    return noteSequence;\n}\n\n// Transpose note sequence to a new key\nfunction transposeNoteSequence(noteSequence, fromKey, toKey) {\n    const interval = getSemitoneInterval(fromKey, toKey);\n    \n    if (interval === 0) {\n        return noteSequence; // No transposition needed\n    }\n    \n    return noteSequence.map(item => {\n        const midi = noteToMidi(item.note);\n        const transposedMidi = midi + interval;\n        const transposedNote = midiToNoteName(transposedMidi);\n        \n        return {\n            ...item,\n            note: transposedNote\n        };\n    });\n}\n\n// Helper: Extract note name from tuning entry (handles both strings and objects)\nfunction extractNoteName(tuningEntry) {\n    if (typeof tuningEntry === 'string') {\n        return tuningEntry;\n    } else if (tuningEntry && tuningEntry.open_note) {\n        return tuningEntry.open_note;\n    } else if (tuningEntry && tuningEntry.label !== undefined && tuningEntry.octave !== undefined) {\n        // Construct note name from label + octave (normalization happens later in noteToMidi)\n        return `${tuningEntry.label}${tuningEntry.octave}`;\n    }\n    return null;\n}\n\n// Find a note on a specific instrument string\nfunction findNoteOnString(targetNoteName, stringOpenNote, maxFret = 24) {\n    // Extract note name if tuningEntry is an object\n    const stringNote = extractNoteName(stringOpenNote);\n    if (!stringNote) return null;\n    \n    const targetMidi = noteToMidi(targetNoteName);\n    const stringMidi = noteToMidi(stringNote);\n    \n    if (targetMidi === null || stringMidi === null) return null;\n    \n    const fret = targetMidi - stringMidi;\n    \n    if (fret >= 0 && fret <= maxFret) {\n        return fret;\n    }\n    \n    return null;\n}\n\n// Map note sequence to target instrument\nfunction mapNoteSequenceToInstrument(noteSequence, instrumentTuning, maxFret = 15) {\n    const mappedSequence = [];\n    const unmappableNotes = [];\n    \n    for (const item of noteSequence) {\n        let mapped = false;\n        \n        // Try to find the note on the same string index first (preserves hand position)\n        if (item.stringIndex < instrumentTuning.length) {\n            const stringOpenNote = instrumentTuning[item.stringIndex];\n            const fret = findNoteOnString(item.note, stringOpenNote, maxFret);\n            \n            if (fret !== null) {\n                mappedSequence.push({\n                    beat: item.beat,\n                    stringIndex: item.stringIndex,\n                    fret: fret\n                });\n                mapped = true;\n            }\n        }\n        \n        // If not found, search all strings\n        if (!mapped) {\n            for (let stringIdx = 0; stringIdx < instrumentTuning.length; stringIdx++) {\n                const stringOpenNote = instrumentTuning[stringIdx];\n                const fret = findNoteOnString(item.note, stringOpenNote, maxFret);\n                \n                if (fret !== null) {\n                    mappedSequence.push({\n                        beat: item.beat,\n                        stringIndex: stringIdx,\n                        fret: fret\n                    });\n                    mapped = true;\n                    break;\n                }\n            }\n        }\n        \n        if (!mapped) {\n            unmappableNotes.push(item);\n        }\n    }\n    \n    return { mappedSequence, unmappableNotes };\n}\n\n// Octave shift the entire note sequence\nfunction octaveShiftNoteSequence(noteSequence, octaveShift) {\n    return noteSequence.map(item => {\n        const midi = noteToMidi(item.note);\n        const shiftedMidi = midi + (octaveShift * 12);\n        const shiftedNote = midiToNoteName(shiftedMidi);\n        \n        return {\n            ...item,\n            note: shiftedNote\n        };\n    });\n}\n\n// Convert tuning entry to renderer format using label + octave\nfunction toRendererFormat(tuningEntry) {\n    if (typeof tuningEntry === 'string') {\n        return tuningEntry;\n    } else if (tuningEntry && tuningEntry.label !== undefined && tuningEntry.octave !== undefined) {\n        return `${tuningEntry.label}${tuningEntry.octave}`;\n    } else if (tuningEntry && tuningEntry.open_note) {\n        return tuningEntry.open_note;\n    }\n    return null;\n}\n\n// Convert mapped sequence to tablature format\nfunction convertToTablatureFormat(mappedSequence, instrumentTuning, totalBeats = 512) {\n    const numStrings = instrumentTuning.length;\n    const tablature = {};\n    \n    // Initialize all strings with flat array (512 beats total)\n    for (let i = 0; i < numStrings; i++) {\n        const stringName = toRendererFormat(instrumentTuning[i]) || `string_${i}`;\n        tablature[stringName] = new Array(totalBeats).fill('-');\n    }\n    \n    // Place notes in tablature (beat is 1-indexed, but array is 0-indexed)\n    for (const item of mappedSequence) {\n        const beatIndex = item.beat - 1;\n        \n        if (beatIndex >= 0 && beatIndex < totalBeats) {\n            const stringName = toRendererFormat(instrumentTuning[item.stringIndex]) || `string_${item.stringIndex}`;\n            tablature[stringName][beatIndex] = item.fret.toString();\n        }\n    }\n    \n    return tablature;\n}\n\n// Main function: Generate tab from CSV for any instrument/key\nexport async function generateTabFromCSV(csvText, instrumentTuning, targetKey = 'C', maxFret = 15) {\n    try {\n        // Step 1: Parse CSV to universal note sequence\n        console.log('Parsing CSV template...');\n        const noteSequence = parseCSVToNoteSequence(csvText);\n        console.log(`Extracted ${noteSequence.length} notes from template`);\n        \n        // Step 2: Transpose to target key\n        console.log(`Transposing from C Major to ${targetKey}...`);\n        const transposedSequence = transposeNoteSequence(noteSequence, 'C', targetKey);\n        \n        // Step 3: Try to map to instrument\n        console.log(`Mapping to instrument with ${instrumentTuning.length} strings...`);\n        let result = mapNoteSequenceToInstrument(transposedSequence, instrumentTuning, maxFret);\n        \n        // Step 4: If too many unmappable notes, try octave shifting\n        if (result.unmappableNotes.length > noteSequence.length * 0.1) {\n            console.log(`${result.unmappableNotes.length} unmappable notes, trying octave shifts...`);\n            \n            // Try shifting down one octave\n            const shiftedDown = octaveShiftNoteSequence(transposedSequence, -1);\n            const resultDown = mapNoteSequenceToInstrument(shiftedDown, instrumentTuning, maxFret);\n            \n            if (resultDown.unmappableNotes.length < result.unmappableNotes.length) {\n                console.log('Octave shift -1 improved mapping');\n                result = resultDown;\n            }\n            \n            // Try shifting up one octave\n            const shiftedUp = octaveShiftNoteSequence(transposedSequence, 1);\n            const resultUp = mapNoteSequenceToInstrument(shiftedUp, instrumentTuning, maxFret);\n            \n            if (resultUp.unmappableNotes.length < result.unmappableNotes.length) {\n                console.log('Octave shift +1 improved mapping');\n                result = resultUp;\n            }\n        }\n        \n        // Step 5: Convert to tablature format\n        console.log('Converting to tablature format...');\n        const tablature = convertToTablatureFormat(result.mappedSequence, instrumentTuning);\n        \n        console.log(`Tab generation complete. ${result.unmappableNotes.length} notes could not be mapped.`);\n        \n        return tablature;\n        \n    } catch (error) {\n        console.error('Error generating tab from CSV:', error);\n        return null;\n    }\n}\n","size_bytes":13491},"public/sw.js":{"content":"const CACHE_NAME = 'fretboard-manuscripts-v1';\n\nself.addEventListener('install', (event) => {\n  console.log('[Service Worker] Installing...');\n  self.skipWaiting();\n});\n\nself.addEventListener('activate', (event) => {\n  console.log('[Service Worker] Activating...');\n  event.waitUntil(\n    caches.keys().then((cacheNames) => {\n      return Promise.all(\n        cacheNames.map((cacheName) => {\n          if (cacheName !== CACHE_NAME) {\n            console.log('[Service Worker] Deleting old cache:', cacheName);\n            return caches.delete(cacheName);\n          }\n        })\n      );\n    })\n  );\n  self.clients.claim();\n});\n\nself.addEventListener('fetch', (event) => {\n  const { request } = event;\n  const url = new URL(request.url);\n\n  if (request.method !== 'GET') {\n    return;\n  }\n\n  const isCacheable = \n    url.origin === self.location.origin || \n    url.hostname.includes('cdn.tailwindcss.com') ||\n    url.hostname.includes('cdn.jsdelivr.net') ||\n    url.hostname.includes('fonts.googleapis.com') ||\n    url.hostname.includes('fonts.gstatic.com');\n\n  if (!isCacheable) {\n    return;\n  }\n\n  event.respondWith(\n    caches.open(CACHE_NAME).then((cache) => {\n      return cache.match(request).then((cachedResponse) => {\n        const fetchPromise = fetch(request).then((networkResponse) => {\n          if (networkResponse && (networkResponse.status === 200 || networkResponse.status === 0)) {\n            cache.put(request, networkResponse.clone());\n          }\n          return networkResponse;\n        }).catch((err) => {\n          console.log('[Service Worker] Fetch failed for:', request.url);\n          \n          if (url.pathname === '/' || url.pathname.endsWith('.html')) {\n            return cache.match('/') || cache.match('/index.html');\n          }\n          \n          throw err;\n        });\n\n        return cachedResponse || fetchPromise;\n      });\n    })\n  );\n});\n","size_bytes":1884},"attached_assets/content-1763158856676.md":{"content":"# Chord Database Navigation Page\n\nThis page enables you to navigate our chord database.\n\nThe goal of our database is to provide information on how chords are constructed for the guitar, and their forms of execution.\n\nThe database classifies chords by importance and difficulty level. We hope you find it useful!\n\n## Drill Down Full Database [Here](https://www.scales-chords.com/chord-database/)\n\n## Navigate on important chords only:\n\n|     |     |\n| --- | --- |\n| **List of chords per key tone:** | [A](https://www.scales-chords.com/showchbykey.php?key=A);<br>[A#](https://www.scales-chords.com/showchbykey.php?key=A%23); <br>[Ab](https://www.scales-chords.com/showchbykey.php?key=Ab); <br>[B](https://www.scales-chords.com/showchbykey.php?key=B); <br>[Bb](https://www.scales-chords.com/showchbykey.php?key=Bb); <br>[C](https://www.scales-chords.com/showchbykey.php?key=C); <br>[C#](https://www.scales-chords.com/showchbykey.php?key=C%23); <br>[D](https://www.scales-chords.com/showchbykey.php?key=D); <br>[D#](https://www.scales-chords.com/showchbykey.php?key=D%23); <br>[Db](https://www.scales-chords.com/showchbykey.php?key=Db); <br>[E](https://www.scales-chords.com/showchbykey.php?key=E); <br>[Eb](https://www.scales-chords.com/showchbykey.php?key=Eb); <br>[F](https://www.scales-chords.com/showchbykey.php?key=F); <br>[F#](https://www.scales-chords.com/showchbykey.php?key=F%23); <br>[G](https://www.scales-chords.com/showchbykey.php?key=G); <br>[G#](https://www.scales-chords.com/showchbykey.php?key=G%23); <br>[Gb](https://www.scales-chords.com/showchbykey.php?key=Gb); |\n\n* * *\n\n|     |     |\n| --- | --- |\n| **List of chord per type of chord:** | [major](https://www.scales-chords.com/show-chord-by-type.php?type=major); <br>[minor](https://www.scales-chords.com/show-chord-by-type.php?type=m); <br>[augmented](https://www.scales-chords.com/show-chord-by-type.php?type=aug); <br>[diminished](https://www.scales-chords.com/show-chord-by-type.php?type=dim);<br>[suspended 2nd](https://www.scales-chords.com/show-chord-by-type.php?type=sus2);<br>[suspended 4th](https://www.scales-chords.com/show-chord-by-type.php?type=sus4);<br>[5th (power chords)](https://www.scales-chords.com/show-chord-by-type.php?type=5); <br>[6th](https://www.scales-chords.com/show-chord-by-type.php?type=6); <br>[minor 6th](https://www.scales-chords.com/show-chord-by-type.php?type=m6);<br>[6th/9th](https://www.scales-chords.com/show-chord-by-type.php?type=6/9);<br>[7th](https://www.scales-chords.com/show-chord-by-type.php?type=7); <br>[minor 7th](https://www.scales-chords.com/show-chord-by-type.php?type=m7);<br>[minor chord with major 7th - m(maj7)](https://www.scales-chords.com/show-chord-by-type.php?type=m(maj7));<br>[augmented 7th](https://www.scales-chords.com/show-chord-by-type.php?type=maj7);<br>[diminished 7th - º7](https://www.scales-chords.com/show-chord-by-type.php?type=%C2%BA7);<br>[minor 7th flat 5th](https://www.scales-chords.com/show-chord-by-type.php?type=m7b5);<br>[7th sharp 5th](https://www.scales-chords.com/show-chord-by-type.php?type=7%235);<br>[7th flat 5th](https://www.scales-chords.com/show-chord-by-type.php?type=7b5);<br>[7th suspended 2nd](https://www.scales-chords.com/show-chord-by-type.php?type=7sus2);<br>[7th suspended 4th](https://www.scales-chords.com/show-chord-by-type.php?type=7sus4);<br>[9th](https://www.scales-chords.com/show-chord-by-type.php?type=9);<br>[minor 9th](https://www.scales-chords.com/show-chord-by-type.php?type=m9);<br>[major 9th](https://www.scales-chords.com/show-chord-by-type.php?type=maj9);<br>[9th sharp 5th](https://www.scales-chords.com/show-chord-by-type.php?type=9%235);<br>[9th flat 5th](https://www.scales-chords.com/show-chord-by-type.php?type=9b5);<br>[9th suspended 2nd](https://www.scales-chords.com/show-chord-by-type.php?type=9sus2);<br>[9th suspended 4th](https://www.scales-chords.com/show-chord-by-type.php?type=9sus4);<br>[minor 11th](https://www.scales-chords.com/show-chord-by-type.php?type=m11);<br>[13th](https://www.scales-chords.com/show-chord-by-type.php?type=13);<br>[minor 13th](https://www.scales-chords.com/show-chord-by-type.php?type=m13);<br>[augmented 13th](https://www.scales-chords.com/show-chord-by-type.php?type=maj13); |\n\n* * *\n\n|     |     |\n| --- | --- |\n| **List of chords by category:** | [Major chords](https://www.scales-chords.com/showchordbycat.php?cat=maj) ; [Minor chords](https://www.scales-chords.com/showchordbycat.php?cat=min) ; [Diminished chords](https://www.scales-chords.com/showchordbycat.php?cat=dim) ; [Augmented chords](https://www.scales-chords.com/showchordbycat.php?cat=aug) ; [7th chords](https://www.scales-chords.com/showchordbycat.php?cat=7) ; [6th chords](https://www.scales-chords.com/showchordbycat.php?cat=6) ; [9th chords](https://www.scales-chords.com/showchordbycat.php?cat=9) ; [11th chords](https://www.scales-chords.com/showchordbycat.php?cat=11) ; [13th chords](https://www.scales-chords.com/showchordbycat.php?cat=13) ; [Suspended chords](https://www.scales-chords.com/showchordbycat.php?cat=sus) ; |\n\n* * *\n\n|     |     |\n| --- | --- |\n| **List of chords by importance:** | [Very important](https://www.scales-chords.com/show-chord-by-relevance.php?type=0); <br>[Frequently used](https://www.scales-chords.com/show-chord-by-relevance.php?type=1);<br>[occasionally used](https://www.scales-chords.com/show-chord-by-relevance.php?type=2);<br>[Rarely used](https://www.scales-chords.com/show-chord-by-relevance.php?type=3); |\n\n* * *\n\n|     |     |\n| --- | --- |\n| **Search the chords database (symbol, name or designation):** | Search alternate symbols<br>Search chord descriptions<br>Search chord comments |\n\n\nShare:\n\n[Facebook](https://facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.scales-chords.com%2Fchdbmain.php)[Tumblr](https://www.tumblr.com/widgets/share/tool?posttype=link&title=&caption=&content=https%3A%2F%2Fwww.scales-chords.com%2Fchdbmain.php&canonicalUrl=https%3A%2F%2Fwww.scales-chords.com%2Fchdbmain.php&shareSource=tumblr_share_button)[Pinterest](https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fwww.scales-chords.com%2Fchdbmain.php&media=&description=)","size_bytes":6120},"attached_assets/content-1763174731751.md":{"content":"[Skip to content](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts#start-of-content)\n\nYou signed in with another tab or window. [Reload](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts) to refresh your session.Dismiss alert\n\n{{ message }}\n\n[TheBigCaker](https://github.com/TheBigCaker)/ **[TheFretboardTrainingManuscripts](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts)** Public\n\n- [Notifications](https://github.com/login?return_to=%2FTheBigCaker%2FTheFretboardTrainingManuscripts) You must be signed in to change notification settings\n- [Fork\\\\\n0](https://github.com/login?return_to=%2FTheBigCaker%2FTheFretboardTrainingManuscripts)\n- [Star\\\\\n0](https://github.com/login?return_to=%2FTheBigCaker%2FTheFretboardTrainingManuscripts)\n\n\n[the-fretboard-training-manuscripts.vercel.app](https://the-fretboard-training-manuscripts.vercel.app/ \"https://the-fretboard-training-manuscripts.vercel.app\")\n\n### License\n\n[MIT license](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/LICENSE)\n\n[0\\\\\nstars](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/stargazers) [0\\\\\nforks](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/forks) [Branches](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/branches) [Tags](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tags) [Activity](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/activity)\n\n[Star](https://github.com/login?return_to=%2FTheBigCaker%2FTheFretboardTrainingManuscripts)\n\n[Notifications](https://github.com/login?return_to=%2FTheBigCaker%2FTheFretboardTrainingManuscripts) You must be signed in to change notification settings\n\n# TheBigCaker/TheFretboardTrainingManuscripts\n\nTFTM\n\n[**1** Branch](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/branches) [**0** Tags](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tags)\n\n[Go to Branches page](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/branches)[Go to Tags page](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tags)\n\nGo to file\n\nCode\n\nOpen more actions menu\n\n## Folders and files\n\n| Name | Name | Last commit message | Last commit date |\n| --- | --- | --- | --- |\n| ## Latest commit<br>[![TheBigCaker](https://avatars.githubusercontent.com/u/107896372?v=4&size=40)](https://github.com/TheBigCaker)[TheBigCaker](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commits?author=TheBigCaker)<br>[12312](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/303941b95def2b2f12888b7957658dc8ee599185)<br>4 minutes agoNov 14, 2025<br>[303941b](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/303941b95def2b2f12888b7957658dc8ee599185) · 4 minutes agoNov 14, 2025<br>## History<br>[70 Commits](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commits/TFTM/) <br>Open commit details<br>[View commit history for this file.](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commits/TFTM/) |\n| [.local/state/replit/agent](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/.local/state/replit/agent \"This path skips through empty directories\") | [.local/state/replit/agent](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/.local/state/replit/agent \"This path skips through empty directories\") | [12312](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/303941b95def2b2f12888b7957658dc8ee599185 \"12312\") | 4 minutes agoNov 14, 2025 |\n| [attached\\_assets](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/attached_assets \"attached_assets\") | [attached\\_assets](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/attached_assets \"attached_assets\") | [Update chord display and arrangement for better user experience](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/512228ecfcedca0cec9c4a25d1e84a406600b8f1 \"Update chord display and arrangement for better user experience  Modify the display of chords and their associated strings to improve readability and user interaction.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: e6f8474f-6092-46fd-96d3-6f933f60a176 Replit-Commit-Checkpoint-Type: full_checkpoint Replit-Commit-Event-Id: f3a63184-15b7-4aef-880a-16c9cfece4d5 Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/e6f8474f-6092-46fd-96d3-6f933f60a176/qvioieC\") | 3 hours agoNov 14, 2025 |\n| [dist](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/dist \"dist\") | [dist](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/dist \"dist\") | [wrarwr](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/85f2a64597a1cc0c316ac6517c59bb109a9d46f5 \"wrarwr\") | yesterdayNov 13, 2025 |\n| [public](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/public \"public\") | [public](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/tree/TFTM/public \"public\") | [Update chord data and add new navigation pages for scales and chords](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/d183cfd70fc028f7c23551bc5e85d283e887dfb0 \"Update chord data and add new navigation pages for scales and chords  Modify public/chord_shapes.json to include new chord variations and update attached markdown files for navigation pages related to musical scales and chord databases.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: e6f8474f-6092-46fd-96d3-6f933f60a176 Replit-Commit-Checkpoint-Type: intermediate_checkpoint Replit-Commit-Event-Id: da53da6f-550a-4477-8be3-a6fb4ffec396 Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/e6f8474f-6092-46fd-96d3-6f933f60a176/DWkjdVF\") | 4 hours agoNov 14, 2025 |\n| [.gitattributes](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/.gitattributes \".gitattributes\") | [.gitattributes](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/.gitattributes \".gitattributes\") | [Initial commit](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/2cd16c3413d8ec5de6810d496399f2d0a9462240 \"Initial commit\") | yesterdayNov 13, 2025 |\n| [.gitignore](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/.gitignore \".gitignore\") | [.gitignore](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/.gitignore \".gitignore\") | [Initial commit](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/2cd16c3413d8ec5de6810d496399f2d0a9462240 \"Initial commit\") | yesterdayNov 13, 2025 |\n| [.replit](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/.replit \".replit\") | [.replit](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/.replit \".replit\") | [12312](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/303941b95def2b2f12888b7957658dc8ee599185 \"12312\") | 4 minutes agoNov 14, 2025 |\n| [A Strategic Analysis and Implementation Roadmap for FretboardManucripts.docx](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/A%20Strategic%20Analysis%20and%20Implementation%20Roadmap%20for%20FretboardManucripts.docx \"A Strategic Analysis and Implementation Roadmap for FretboardManucripts.docx\") | [A Strategic Analysis and Implementation Roadmap for FretboardManucripts.docx](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/A%20Strategic%20Analysis%20and%20Implementation%20Roadmap%20for%20FretboardManucripts.docx \"A Strategic Analysis and Implementation Roadmap for FretboardManucripts.docx\") | [Initial commit](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/2cd16c3413d8ec5de6810d496399f2d0a9462240 \"Initial commit\") | yesterdayNov 13, 2025 |\n| [LICENSE](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/LICENSE \"LICENSE\") | [LICENSE](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/LICENSE \"LICENSE\") | [Initial commit](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/2cd16c3413d8ec5de6810d496399f2d0a9462240 \"Initial commit\") | yesterdayNov 13, 2025 |\n| [Plan.md](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/Plan.md \"Plan.md\") | [Plan.md](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/Plan.md \"Plan.md\") | [Initial commit](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/2cd16c3413d8ec5de6810d496399f2d0a9462240 \"Initial commit\") | yesterdayNov 13, 2025 |\n| [TFTM\\_Test.pdf](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/TFTM_Test.pdf \"TFTM_Test.pdf\") | [TFTM\\_Test.pdf](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/TFTM_Test.pdf \"TFTM_Test.pdf\") | [1](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/67ea03193723ce8db99907714a7decfe2282004d \"1\") | yesterdayNov 13, 2025 |\n| [database.js](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/database.js \"database.js\") | [database.js](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/database.js \"database.js\") | [Merge branch 'TFTM' of](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/f234d2c997a401343b7d922430b4d3882b18d143 \"Merge branch 'TFTM' of https://github.com/TheBigCaker/TheFretboardTrainingManuscripts into TFTM\") [https://github.com/TheBigCaker/TheFretboardTra…](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts) | 5 minutes agoNov 14, 2025 |\n| [index.html](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/index.html \"index.html\") | [index.html](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/index.html \"index.html\") | [Add interactive fretboard view displaying strings as rows](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/db71d0a601ee3a9365bc09e83db3db5accc066d3 \"Add interactive fretboard view displaying strings as rows  Introduced a new HTML section for displaying strings as rows and implemented a helper function `getSemitoneDistance` in `main.js` to calculate semitone differences, which refactors chord generation logic and ensures the new fretboard view is always populated.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: e6f8474f-6092-46fd-96d3-6f933f60a176 Replit-Commit-Checkpoint-Type: intermediate_checkpoint Replit-Commit-Event-Id: b09f072c-549f-4582-9eaa-ea1d466af8df Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/e6f8474f-6092-46fd-96d3-6f933f60a176/kSvLc8K\") | 4 hours agoNov 14, 2025 |\n| [main.js](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/main.js \"main.js\") | [main.js](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/main.js \"main.js\") | [Merge branch 'TFTM' of](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/f234d2c997a401343b7d922430b4d3882b18d143 \"Merge branch 'TFTM' of https://github.com/TheBigCaker/TheFretboardTrainingManuscripts into TFTM\") [https://github.com/TheBigCaker/TheFretboardTra…](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts) | 5 minutes agoNov 14, 2025 |\n| [package-lock.json](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/package-lock.json \"package-lock.json\") | [package-lock.json](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/package-lock.json \"package-lock.json\") | [Add project setup and configuration for a music theory tool](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/0efcc93dd3d54193d40d498ebb7d321ec5a132e1 \"Add project setup and configuration for a music theory tool  Configure Vite build tool with ES module support, define npm scripts for development and production builds, and set up the development server to run on port 5000 with host 0.0.0.0.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: 8b62e7e6-46d3-44ad-a44d-2da875ba6092 Replit-Commit-Checkpoint-Type: intermediate_checkpoint Replit-Commit-Event-Id: 2ca718df-b90c-447e-8ea9-cf214ad326ea Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/8b62e7e6-46d3-44ad-a44d-2da875ba6092/tDJefkv\") | yesterdayNov 13, 2025 |\n| [package.json](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/package.json \"package.json\") | [package.json](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/package.json \"package.json\") | [Add project setup and configuration for a music theory tool](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/0efcc93dd3d54193d40d498ebb7d321ec5a132e1 \"Add project setup and configuration for a music theory tool  Configure Vite build tool with ES module support, define npm scripts for development and production builds, and set up the development server to run on port 5000 with host 0.0.0.0.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: 8b62e7e6-46d3-44ad-a44d-2da875ba6092 Replit-Commit-Checkpoint-Type: intermediate_checkpoint Replit-Commit-Event-Id: 2ca718df-b90c-447e-8ea9-cf214ad326ea Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/8b62e7e6-46d3-44ad-a44d-2da875ba6092/tDJefkv\") | yesterdayNov 13, 2025 |\n| [replit.md](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/replit.md \"replit.md\") | [replit.md](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/replit.md \"replit.md\") | [Improve layout and default tablature view for better user experience](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/85601efdbbffd3c7e3e0b2a2bb20108300343c8b \"Improve layout and default tablature view for better user experience  Updated default tablature orientation to \\\"Strings as Rows\\\" and reordered page sections for improved workflow.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: e6f8474f-6092-46fd-96d3-6f933f60a176 Replit-Commit-Checkpoint-Type: full_checkpoint Replit-Commit-Event-Id: 1be66087-244c-4e29-afac-f099452136ca Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/e6f8474f-6092-46fd-96d3-6f933f60a176/qvioieC\") | 4 hours agoNov 14, 2025 |\n| [style.css](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/style.css \"style.css\") | [style.css](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/style.css \"style.css\") | [Add detailed explanations for chord diagrams and progressions](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/c2d14de7f1ded3fe11a58b596eb14f4eba65a8bc \"Add detailed explanations for chord diagrams and progressions  Update index.html to include detailed explanations and diagrams for understanding chord diagrams and progressions. Modify main.js to render chord diagrams in a landscape orientation. Adjust style.css for the new landscape chord diagram styles.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: e6f8474f-6092-46fd-96d3-6f933f60a176 Replit-Commit-Checkpoint-Type: intermediate_checkpoint Replit-Commit-Event-Id: 5658f9a4-5f3e-4053-b8a9-b38ba8e4efc2 Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/e6f8474f-6092-46fd-96d3-6f933f60a176/KMwAiTD\") | 4 hours agoNov 14, 2025 |\n| [vite.config.js](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/vite.config.js \"vite.config.js\") | [vite.config.js](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/blob/TFTM/vite.config.js \"vite.config.js\") | [Allow any host to connect to the development server](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/commit/950d43a7cfe83f9fa0cdcf8abe39fba04de87e12 \"Allow any host to connect to the development server  Update vite.config.js to enable `allowedHosts: true` for both the dev server and preview, resolving blocked request errors for specific hosts like those on Replit.  Replit-Commit-Author: Agent Replit-Commit-Session-Id: 8b62e7e6-46d3-44ad-a44d-2da875ba6092 Replit-Commit-Checkpoint-Type: full_checkpoint Replit-Commit-Event-Id: 85e7eb2d-2ec3-4dc1-96f1-d4d74c5e39d9 Replit-Commit-Screenshot-Url: https://storage.googleapis.com/screenshot-production-us-central1/c9295e10-8c0e-4490-a294-8a8e5179430d/8b62e7e6-46d3-44ad-a44d-2da875ba6092/MxEU7O4\") | yesterdayNov 13, 2025 |\n| View all files |\n\n## Repository files navigation\n\n```\nMIT License\n\nCopyright (c) 2025 TheBigCaker\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n```\n\n## About\n\n[the-fretboard-training-manuscripts.vercel.app](https://the-fretboard-training-manuscripts.vercel.app/ \"https://the-fretboard-training-manuscripts.vercel.app\")\n\n### License\n\n[MIT license](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts#MIT-1-ov-file)\n\n### Uh oh!\n\nThere was an error while loading. [Please reload this page](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts).\n\n[Activity](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/activity)\n\n### Stars\n\n[**0**\\\\\nstars](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/stargazers)\n\n### Watchers\n\n[**0**\\\\\nwatching](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/watchers)\n\n### Forks\n\n[**0**\\\\\nforks](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/forks)\n\n[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FTheBigCaker%2FTheFretboardTrainingManuscripts&report=TheBigCaker+%28user%29)\n\n## [Releases](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/releases)\n\nNo releases published\n\n## [Packages\\  0](https://github.com/users/TheBigCaker/packages?repo_name=TheFretboardTrainingManuscripts)\n\nNo packages published\n\n## Languages\n\n- [JavaScript78.6%](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/search?l=javascript)\n- [HTML13.2%](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/search?l=html)\n- [CSS8.2%](https://github.com/TheBigCaker/TheFretboardTrainingManuscripts/search?l=css)\n\nYou can’t perform that action at this time.","size_bytes":19796},"attached_assets/content-1763175481211.md":{"content":"top of page\n\nThe Fretboard Training Manuscripts\n\nbottom of page","size_bytes":63},"attached_assets/content-1763158838198.md":{"content":"# Musical Scale Navigator\n\n|     |\n| --- |\n| **Select the Key and the Scale Type you want** |\n| Key: CC#DbDD#EbEFF#GbGG#AbAA#BbB<br> <br>Scale Type: BluesDiatonicDiminished (halftone - wholetone)Diminished (wholetone - halftone)augmenteddominant pentatonicharmonic minormajormajor bluesmajor pentatonicmelodic minorminor pentatonicnatural minorpentatonic bluespentatonic neutralwhole toneaeoliandorianionianlocrianlydianmixolydianphrygianDorian #4Dorian b2Ionian #5Locrian 6Major PhrygianPhrygian MajorUltralocrianaugmented ionianaugmented lydiandiminished lydianlocrian #2locrian 2lydian #9lydian b7minor lydianmixolydian b6AlteredAltered bb7DiminishedDiminished Whole ToneDominant 7thEnigmaticHalf DiminishedLeading Whole ToneOctatonic (H-W)Octatonic (W-H)OvertoneSix Tone Symmetricalbebop dominantbebop half diminishedbebop majorbebop minordouble harmonicAlgerianArabian (a)Arabian (b)BalineseByzantineChineseChinese MongolianEgyptianEight Tone SpanishHinduHirajoshiHungarian MajorHungarian Minor (Gipsy)IwatoJapanese (in sen)KumoiKumoi 2MohammedanMongolianMoorish PhrygianNeopolitanNeopolitan MajorNeopolitan MinorPelogPelog 2PersianPrometheusPrometheus NeopolitanPurvi thetaTodi thetaarabianchinese 2hirajoshi 2ichikosucho |\n\n|     |\n| --- |\n| **Browse Scales by Key** |\n| [C](https://www.scales-chords.com/shscalesbykey.php?skey=C) [C#](https://www.scales-chords.com/shscalesbykey.php?skey=C%23) [Db](https://www.scales-chords.com/shscalesbykey.php?skey=Db) [D](https://www.scales-chords.com/shscalesbykey.php?skey=D) [D#](https://www.scales-chords.com/shscalesbykey.php?skey=D%23) [Eb](https://www.scales-chords.com/shscalesbykey.php?skey=Eb) [E](https://www.scales-chords.com/shscalesbykey.php?skey=E) [F](https://www.scales-chords.com/shscalesbykey.php?skey=F) [F#](https://www.scales-chords.com/shscalesbykey.php?skey=F%23) [Gb](https://www.scales-chords.com/shscalesbykey.php?skey=Gb) [G](https://www.scales-chords.com/shscalesbykey.php?skey=G) [G#](https://www.scales-chords.com/shscalesbykey.php?skey=G%23) [Ab](https://www.scales-chords.com/shscalesbykey.php?skey=Ab) [A](https://www.scales-chords.com/shscalesbykey.php?skey=A) [A#](https://www.scales-chords.com/shscalesbykey.php?skey=A%23) [Bb](https://www.scales-chords.com/shscalesbykey.php?skey=Bb) [B](https://www.scales-chords.com/shscalesbykey.php?skey=B) |\n\n|     |     |     |\n| --- | --- | --- |\n| **Browse Scales by Type** |\n| [Blues](https://www.scales-chords.com/shscalesbytype.php?sname=Blues) | [Diatonic](https://www.scales-chords.com/shscalesbytype.php?sname=Diatonic) | [Diminished (halftone - wholetone)](https://www.scales-chords.com/shscalesbytype.php?sname=Diminished+%28halftone+-+wholetone%29) |\n| [Diminished (wholetone - halftone)](https://www.scales-chords.com/shscalesbytype.php?sname=Diminished+%28wholetone+-+halftone%29) | [augmented](https://www.scales-chords.com/shscalesbytype.php?sname=augmented) | [dominant pentatonic](https://www.scales-chords.com/shscalesbytype.php?sname=dominant+pentatonic) |\n| [harmonic minor](https://www.scales-chords.com/shscalesbytype.php?sname=harmonic+minor) | [major](https://www.scales-chords.com/shscalesbytype.php?sname=major) | [major blues](https://www.scales-chords.com/shscalesbytype.php?sname=major+blues) |\n| [major pentatonic](https://www.scales-chords.com/shscalesbytype.php?sname=major+pentatonic) | [melodic minor](https://www.scales-chords.com/shscalesbytype.php?sname=melodic+minor) | [minor pentatonic](https://www.scales-chords.com/shscalesbytype.php?sname=minor+pentatonic) |\n| [natural minor](https://www.scales-chords.com/shscalesbytype.php?sname=natural+minor) | [pentatonic blues](https://www.scales-chords.com/shscalesbytype.php?sname=pentatonic+blues) | [pentatonic neutral](https://www.scales-chords.com/shscalesbytype.php?sname=pentatonic+neutral) |\n| [whole tone](https://www.scales-chords.com/shscalesbytype.php?sname=whole+tone) | [aeolian](https://www.scales-chords.com/shscalesbytype.php?sname=aeolian) | [dorian](https://www.scales-chords.com/shscalesbytype.php?sname=dorian) |\n| [ionian](https://www.scales-chords.com/shscalesbytype.php?sname=ionian) | [locrian](https://www.scales-chords.com/shscalesbytype.php?sname=locrian) | [lydian](https://www.scales-chords.com/shscalesbytype.php?sname=lydian) |\n| [mixolydian](https://www.scales-chords.com/shscalesbytype.php?sname=mixolydian) | [phrygian](https://www.scales-chords.com/shscalesbytype.php?sname=phrygian) | [Dorian #4](https://www.scales-chords.com/shscalesbytype.php?sname=Dorian+%234) |\n| [Dorian b2](https://www.scales-chords.com/shscalesbytype.php?sname=Dorian+b2) | [Ionian #5](https://www.scales-chords.com/shscalesbytype.php?sname=Ionian+%235) | [Locrian 6](https://www.scales-chords.com/shscalesbytype.php?sname=Locrian+6) |\n| [Major Phrygian](https://www.scales-chords.com/shscalesbytype.php?sname=Major+Phrygian) | [Phrygian Major](https://www.scales-chords.com/shscalesbytype.php?sname=Phrygian+Major) | [Ultralocrian](https://www.scales-chords.com/shscalesbytype.php?sname=Ultralocrian) |\n| [augmented ionian](https://www.scales-chords.com/shscalesbytype.php?sname=augmented+ionian) | [augmented lydian](https://www.scales-chords.com/shscalesbytype.php?sname=augmented+lydian) | [diminished lydian](https://www.scales-chords.com/shscalesbytype.php?sname=diminished+lydian) |\n| [locrian #2](https://www.scales-chords.com/shscalesbytype.php?sname=locrian+%232) | [locrian 2](https://www.scales-chords.com/shscalesbytype.php?sname=locrian+2) | [lydian #9](https://www.scales-chords.com/shscalesbytype.php?sname=lydian+%239) |\n| [lydian b7](https://www.scales-chords.com/shscalesbytype.php?sname=lydian+b7) | [minor lydian](https://www.scales-chords.com/shscalesbytype.php?sname=minor+lydian) | [mixolydian b6](https://www.scales-chords.com/shscalesbytype.php?sname=mixolydian+b6) |\n| [Altered](https://www.scales-chords.com/shscalesbytype.php?sname=Altered) | [Altered bb7](https://www.scales-chords.com/shscalesbytype.php?sname=Altered+bb7) | [Diminished](https://www.scales-chords.com/shscalesbytype.php?sname=Diminished) |\n| [Diminished Whole Tone](https://www.scales-chords.com/shscalesbytype.php?sname=Diminished+Whole+Tone) | [Dominant 7th](https://www.scales-chords.com/shscalesbytype.php?sname=Dominant+7th) | [Enigmatic](https://www.scales-chords.com/shscalesbytype.php?sname=Enigmatic) |\n| [Half Diminished](https://www.scales-chords.com/shscalesbytype.php?sname=Half+Diminished) | [Leading Whole Tone](https://www.scales-chords.com/shscalesbytype.php?sname=Leading+Whole+Tone) | [Octatonic (H-W)](https://www.scales-chords.com/shscalesbytype.php?sname=Octatonic+%28H-W%29) |\n| [Octatonic (W-H)](https://www.scales-chords.com/shscalesbytype.php?sname=Octatonic+%28W-H%29) | [Overtone](https://www.scales-chords.com/shscalesbytype.php?sname=Overtone) | [Six Tone Symmetrical](https://www.scales-chords.com/shscalesbytype.php?sname=Six+Tone+Symmetrical) |\n| [bebop dominant](https://www.scales-chords.com/shscalesbytype.php?sname=bebop+dominant) | [bebop half diminished](https://www.scales-chords.com/shscalesbytype.php?sname=bebop+half+diminished) | [bebop major](https://www.scales-chords.com/shscalesbytype.php?sname=bebop+major) |\n| [bebop minor](https://www.scales-chords.com/shscalesbytype.php?sname=bebop+minor) | [double harmonic](https://www.scales-chords.com/shscalesbytype.php?sname=double+harmonic) | [Algerian](https://www.scales-chords.com/shscalesbytype.php?sname=Algerian) |\n| [Arabian (a)](https://www.scales-chords.com/shscalesbytype.php?sname=Arabian+%28a%29) | [Arabian (b)](https://www.scales-chords.com/shscalesbytype.php?sname=Arabian+%28b%29) | [Balinese](https://www.scales-chords.com/shscalesbytype.php?sname=Balinese) |\n| [Byzantine](https://www.scales-chords.com/shscalesbytype.php?sname=Byzantine) | [Chinese](https://www.scales-chords.com/shscalesbytype.php?sname=Chinese) | [Chinese Mongolian](https://www.scales-chords.com/shscalesbytype.php?sname=Chinese+Mongolian) |\n| [Egyptian](https://www.scales-chords.com/shscalesbytype.php?sname=Egyptian) | [Eight Tone Spanish](https://www.scales-chords.com/shscalesbytype.php?sname=Eight+Tone+Spanish) | [Hindu](https://www.scales-chords.com/shscalesbytype.php?sname=Hindu) |\n| [Hirajoshi](https://www.scales-chords.com/shscalesbytype.php?sname=Hirajoshi) | [Hungarian Major](https://www.scales-chords.com/shscalesbytype.php?sname=Hungarian+Major) | [Hungarian Minor (Gipsy)](https://www.scales-chords.com/shscalesbytype.php?sname=Hungarian+Minor+%28Gipsy%29) |\n| [Iwato](https://www.scales-chords.com/shscalesbytype.php?sname=Iwato) | [Japanese (in sen)](https://www.scales-chords.com/shscalesbytype.php?sname=Japanese+%28in+sen%29) | [Kumoi](https://www.scales-chords.com/shscalesbytype.php?sname=Kumoi) |\n| [Kumoi 2](https://www.scales-chords.com/shscalesbytype.php?sname=Kumoi+2) | [Mohammedan](https://www.scales-chords.com/shscalesbytype.php?sname=Mohammedan) | [Mongolian](https://www.scales-chords.com/shscalesbytype.php?sname=Mongolian) |\n| [Moorish Phrygian](https://www.scales-chords.com/shscalesbytype.php?sname=Moorish+Phrygian) | [Neopolitan](https://www.scales-chords.com/shscalesbytype.php?sname=Neopolitan) | [Neopolitan Major](https://www.scales-chords.com/shscalesbytype.php?sname=Neopolitan+Major) |\n| [Neopolitan Minor](https://www.scales-chords.com/shscalesbytype.php?sname=Neopolitan+Minor) | [Pelog](https://www.scales-chords.com/shscalesbytype.php?sname=Pelog) | [Pelog 2](https://www.scales-chords.com/shscalesbytype.php?sname=Pelog+2) |\n| [Persian](https://www.scales-chords.com/shscalesbytype.php?sname=Persian) | [Prometheus](https://www.scales-chords.com/shscalesbytype.php?sname=Prometheus) | [Prometheus Neopolitan](https://www.scales-chords.com/shscalesbytype.php?sname=Prometheus+Neopolitan) |\n| [Purvi theta](https://www.scales-chords.com/shscalesbytype.php?sname=Purvi+theta) | [Todi theta](https://www.scales-chords.com/shscalesbytype.php?sname=Todi+theta) | [arabian](https://www.scales-chords.com/shscalesbytype.php?sname=arabian) |\n| [chinese 2](https://www.scales-chords.com/shscalesbytype.php?sname=chinese+2) | [hirajoshi 2](https://www.scales-chords.com/shscalesbytype.php?sname=hirajoshi+2) | [ichikosucho](https://www.scales-chords.com/shscalesbytype.php?sname=ichikosucho) |\n\n\nShare:\n\n[Facebook](https://facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.scales-chords.com%2Fscalenav.php)[Tumblr](https://www.tumblr.com/widgets/share/tool?posttype=link&title=&caption=&content=https%3A%2F%2Fwww.scales-chords.com%2Fscalenav.php&canonicalUrl=https%3A%2F%2Fwww.scales-chords.com%2Fscalenav.php&shareSource=tumblr_share_button)[Pinterest](https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fwww.scales-chords.com%2Fscalenav.php&media=&description=)","size_bytes":10715},"tab_generator.js":{"content":"// ========== ALGORITHMIC TAB GENERATOR ==========\n// Generates pedagogical tablature for any key/mode on any instrument\n// Follows the 6-Module Pedagogical Framework\n\n// Helper: Get chromatic note names\nconst CHROMATIC = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n\n// Helper: Normalize note names (handle ♯/♭ variations)\nfunction normalizeNote(note) {\n    return note.replace('♯', '#').replace('♭', 'b').replace(/[0-9]/g, '').toUpperCase();\n}\n\n// Helper: Convert note to MIDI number\nfunction noteToMidi(noteName, octave) {\n    const normalized = normalizeNote(noteName);\n    const noteIndex = CHROMATIC.indexOf(normalized);\n    if (noteIndex === -1) return null;\n    return (octave + 1) * 12 + noteIndex;\n}\n\n// Helper: Convert MIDI to note name\nfunction midiToNote(midi) {\n    const octave = Math.floor(midi / 12) - 1;\n    const noteIndex = midi % 12;\n    return { note: CHROMATIC[noteIndex], octave };\n}\n\n// Helper: Find all fret positions where a note appears on a string\nfunction findNoteOnString(targetNote, stringOpenNote, maxFret = 24) {\n    const targetNormalized = normalizeNote(targetNote);\n    const stringNormalized = normalizeNote(stringOpenNote);\n    \n    const targetIndex = CHROMATIC.indexOf(targetNormalized);\n    const stringIndex = CHROMATIC.indexOf(stringNormalized);\n    \n    if (targetIndex === -1 || stringIndex === -1) return [];\n    \n    const positions = [];\n    for (let fret = 0; fret <= maxFret; fret++) {\n        const fretNoteIndex = (stringIndex + fret) % 12;\n        if (fretNoteIndex === targetIndex) {\n            positions.push(fret);\n        }\n    }\n    return positions;\n}\n\n// Helper: Get scale notes for a given root and intervals\nfunction getScaleNotes(rootNote, intervals) {\n    const rootNormalized = normalizeNote(rootNote);\n    const rootIndex = CHROMATIC.indexOf(rootNormalized);\n    if (rootIndex === -1) return [];\n    \n    const scaleNotes = intervals.map(interval => {\n        const noteIndex = (rootIndex + interval) % 12;\n        return CHROMATIC[noteIndex];\n    });\n    \n    return scaleNotes;\n}\n\n// Helper: Generate blank measure (16 beats of silence)\nfunction blankMeasure() {\n    return Array(16).fill('-');\n}\n\n// MODULE 1: Single-String Linearization (Horizontal Mastery)\n// Generate 3-note sequential patterns on a single string\nfunction generateModule1SingleString(stringOpenNote, scaleNotes, maxFret = 12) {\n    const stringNormalized = normalizeNote(stringOpenNote);\n    const stringIndex = CHROMATIC.indexOf(stringNormalized);\n    \n    // Find all scale notes available on this string\n    const availableNotes = [];\n    for (let fret = 0; fret <= maxFret; fret++) {\n        const fretNoteIndex = (stringIndex + fret) % 12;\n        const fretNote = CHROMATIC[fretNoteIndex];\n        if (scaleNotes.includes(fretNote)) {\n            availableNotes.push({ note: fretNote, fret });\n        }\n    }\n    \n    // Generate 3-note permutation patterns (16 beats)\n    if (availableNotes.length < 3) {\n        // If not enough notes, use 2-note pattern or single note\n        if (availableNotes.length === 2) {\n            const [n1, n2] = availableNotes;\n            return [\n                n1.fret, n2.fret, n1.fret, n2.fret,\n                n1.fret, n2.fret, n2.fret, n1.fret,\n                n2.fret, n1.fret, n2.fret, n1.fret,\n                n2.fret, n1.fret, n1.fret, '-'\n            ].map(v => v === '-' ? '-' : v.toString());\n        } else if (availableNotes.length === 1) {\n            const n1 = availableNotes[0];\n            return [\n                n1.fret, '-', n1.fret, '-', n1.fret, '-', '-', '-',\n                n1.fret, '-', n1.fret, '-', n1.fret, '-', '-', '-'\n            ].map(v => v === '-' ? '-' : v.toString());\n        }\n        return blankMeasure();\n    }\n    \n    // Use first 3 available notes for pattern\n    const [n1, n2, n3] = availableNotes.slice(0, 3);\n    \n    // Create ascending/descending 3-note pattern\n    return [\n        n1.fret, n2.fret, n1.fret, n3.fret,\n        n2.fret, n3.fret, n2.fret, n1.fret,\n        n3.fret, n1.fret, n2.fret, n1.fret,\n        n3.fret, n1.fret, n3.fret, n2.fret\n    ].map(v => v.toString());\n}\n\n// MODULE 2: Positional Scale Fragment (Vertical Integration)\n// Generate scale fragments that move across strings in one position\n// Returns array of patterns, one for each string\nfunction generateModule2PositionalScale(allStringsOpenNotes, scaleNotes, startFret = 0) {\n    const numStrings = allStringsOpenNotes.length;\n    const stringPatterns = [];\n    \n    // Build a sequence that ascends across all strings with timeline placement\n    const sequence = [];\n    \n    // Collect multiple scale notes from all strings in the position\n    for (let i = numStrings - 1; i >= 0; i--) {\n        const stringOpenNote = allStringsOpenNotes[i];\n        const stringNormalized = normalizeNote(stringOpenNote);\n        const stringIndex = CHROMATIC.indexOf(stringNormalized);\n        \n        // Find 2-3 scale notes near the start position (within 5 frets)\n        const stringNotes = [];\n        for (let fret = startFret; fret <= startFret + 5; fret++) {\n            const fretNoteIndex = (stringIndex + fret) % 12;\n            const fretNote = CHROMATIC[fretNoteIndex];\n            \n            if (scaleNotes.includes(fretNote)) {\n                stringNotes.push({ stringIdx: i, fret });\n                if (stringNotes.length >= 2) break; // Collect 2-3 notes per string\n            }\n        }\n        \n        // Add collected notes to sequence\n        sequence.push(...stringNotes);\n    }\n    \n    // Calculate beats per note (spread across 16 beats)\n    const beatsPerNote = sequence.length > 0 ? Math.max(1, Math.floor(16 / sequence.length)) : 16;\n    \n    // Create timeline-based patterns for each string\n    for (let stringIdx = 0; stringIdx < numStrings; stringIdx++) {\n        const pattern = Array(16).fill('-'); // Start with all rests\n        \n        // Place notes on timeline for this string\n        sequence.forEach((note, seqIdx) => {\n            if (note.stringIdx === stringIdx) {\n                const beatPosition = seqIdx * beatsPerNote;\n                if (beatPosition < 16) {\n                    pattern[beatPosition] = note.fret.toString();\n                }\n            }\n        });\n        \n        stringPatterns.push(pattern);\n    }\n    \n    return stringPatterns;\n}\n\n// MODULE 3: Diatonic Melodic Patterns (Musical Application)\n// Generate non-linear melodic sequences using scale notes\nfunction generateModule3MelodicPattern(stringOpenNote, scaleNotes, measureIndex = 0, maxFret = 12) {\n    const availableNotes = [];\n    const stringNormalized = normalizeNote(stringOpenNote);\n    const stringIndex = CHROMATIC.indexOf(stringNormalized);\n    \n    // Find scale notes on this string (low to mid range)\n    for (let fret = 0; fret <= maxFret; fret++) {\n        const fretNoteIndex = (stringIndex + fret) % 12;\n        const fretNote = CHROMATIC[fretNoteIndex];\n        if (scaleNotes.includes(fretNote)) {\n            availableNotes.push(fret);\n        }\n    }\n    \n    if (availableNotes.length < 3) {\n        return blankMeasure();\n    }\n    \n    // Vary the starting offset based on measure index\n    const offset = measureIndex % availableNotes.length;\n    \n    // Create a melodic sequence with skips and returns\n    const pattern = [];\n    for (let i = 0; i < 4; i++) {\n        const idx = (i + offset) % availableNotes.length;\n        const nextIdx = (i + offset + 2) % availableNotes.length;\n        pattern.push(\n            availableNotes[idx].toString(),\n            '-',\n            availableNotes[nextIdx].toString(),\n            '-'\n        );\n    }\n    \n    return pattern.slice(0, 16);\n}\n\n// MODULE 4: Harmonic Context (Chord Arpeggios)\n// Generate arpeggio patterns using chord tones (C, E, G for C major)\nfunction generateModule4ChordArpeggio(stringOpenNote, chordTones = ['C', 'E', 'G'], measureIndex = 0, maxFret = 12) {\n    const availableChordTones = [];\n    \n    // Find chord tones on this string with multiple positions\n    for (const tone of chordTones) {\n        const positions = findNoteOnString(tone, stringOpenNote, maxFret);\n        positions.forEach(pos => {\n            availableChordTones.push({\n                note: tone,\n                fret: pos\n            });\n        });\n    }\n    \n    if (availableChordTones.length === 0) {\n        return blankMeasure();\n    }\n    \n    // Alternate between ascending and descending based on measure\n    const ascending = measureIndex % 2 === 0;\n    \n    // Create arpeggio pattern\n    const pattern = [];\n    const tones = ascending ? availableChordTones : [...availableChordTones].reverse();\n    \n    tones.forEach(ct => {\n        pattern.push(ct.fret.toString(), '-');\n    });\n    \n    // Fill remaining beats\n    while (pattern.length < 16) {\n        pattern.push('-');\n    }\n    \n    return pattern.slice(0, 16);\n}\n\n// MODULE 5: Multi-Octave Scale Traversal (Fretboard Unification)\n// Generate full-range scale runs across the neck\nfunction generateModule5Traversal(stringOpenNote, scaleNotes, measureIndex = 0, maxFret = 15) {\n    const availableNotes = [];\n    const stringNormalized = normalizeNote(stringOpenNote);\n    const stringIndex = CHROMATIC.indexOf(stringNormalized);\n    \n    // Find ALL scale notes on this string (extended range)\n    for (let fret = 0; fret <= maxFret; fret++) {\n        const fretNoteIndex = (stringIndex + fret) % 12;\n        const fretNote = CHROMATIC[fretNoteIndex];\n        if (scaleNotes.includes(fretNote)) {\n            availableNotes.push(fret);\n        }\n    }\n    \n    if (availableNotes.length < 2) {\n        return blankMeasure();\n    }\n    \n    // Use local measure index (0-3 for M27-M30) to cycle through distinct slices\n    const localMeasure = measureIndex >= 26 ? (measureIndex - 26) : measureIndex;\n    \n    // Choose different slice of notes based on local measure to create variety\n    const sliceSize = Math.min(6, availableNotes.length);\n    const maxStartIdx = Math.max(1, availableNotes.length - sliceSize + 1);\n    const startIdx = localMeasure % maxStartIdx;\n    const notesSlice = availableNotes.slice(startIdx, startIdx + sliceSize);\n    \n    // Alternate between ascending and descending\n    const ascending = localMeasure % 2 === 0;\n    const pattern = [];\n    \n    const sequence = ascending ? notesSlice : [...notesSlice].reverse();\n    sequence.forEach(fret => {\n        pattern.push(fret.toString());\n    });\n    \n    // Fill or trim to 16 beats\n    while (pattern.length < 16) {\n        pattern.push('-');\n    }\n    \n    return pattern.slice(0, 16);\n}\n\n// MODULE 6: Capstone Virtuosity (Advanced Runs)\n// Generate rapid position-shifting melodic runs\nfunction generateModule6Virtuoso(stringOpenNote, scaleNotes, measureIndex = 0, maxFret = 12) {\n    const availableNotes = [];\n    const stringNormalized = normalizeNote(stringOpenNote);\n    const stringIndex = CHROMATIC.indexOf(stringNormalized);\n    \n    // Find scale notes with wider range\n    for (let fret = 0; fret <= maxFret; fret++) {\n        const fretNoteIndex = (stringIndex + fret) % 12;\n        const fretNote = CHROMATIC[fretNoteIndex];\n        if (scaleNotes.includes(fretNote)) {\n            availableNotes.push(fret);\n        }\n    }\n    \n    if (availableNotes.length < 3) {\n        return blankMeasure();\n    }\n    \n    // Vary pattern type based on measure index\n    const patternType = measureIndex % 3;\n    const pattern = [];\n    \n    if (patternType === 0) {\n        // Ascending with rhythmic gaps\n        for (let i = 0; i < availableNotes.length && pattern.length < 14; i++) {\n            pattern.push(availableNotes[i].toString());\n            if (i % 2 === 0) {\n                pattern.push('-');\n            }\n        }\n    } else if (patternType === 1) {\n        // Descending rapid run\n        for (let i = availableNotes.length - 1; i >= 0 && pattern.length < 14; i--) {\n            pattern.push(availableNotes[i].toString());\n        }\n    } else {\n        // Skip pattern (every other note)\n        for (let i = 0; i < availableNotes.length && pattern.length < 14; i += 2) {\n            pattern.push(availableNotes[i].toString(), '-');\n        }\n    }\n    \n    // Fill to 16\n    while (pattern.length < 16) {\n        pattern.push('-');\n    }\n    \n    return pattern.slice(0, 16);\n}\n\n// Helper function to get maximum playable fret for an instrument\nfunction getMaxFretForInstrument(instrumentName) {\n    // Different instruments have different typical fret counts\n    if (instrumentName.includes('Mandolin')) return 12;\n    if (instrumentName.includes('Banjo')) return 12;\n    if (instrumentName.includes('Ukulele')) return 12;\n    if (instrumentName.includes('Bass')) return 20;\n    return 15; // Default for guitars\n}\n\n// Helper function to sanitize tab and remove impossible stretches\nfunction sanitizeStretchesInTab(tab, strings, maxStretch = 4) {\n    const numBeats = 512;\n    let adjustmentCount = 0;\n    \n    // Scan each beat\n    for (let beat = 0; beat < numBeats; beat++) {\n        let needsRecheck = true;\n        let iterationCount = 0;\n        const MAX_ITERATIONS = 10; // Prevent infinite loops\n        \n        // Iteratively remove outliers until stretch is within limits\n        while (needsRecheck && iterationCount < MAX_ITERATIONS) {\n            iterationCount++;\n            needsRecheck = false;\n            \n            const activeFrets = [];\n            const activeFretIndices = [];\n            \n            // Collect all active frets at this beat position\n            strings.forEach((stringKey, idx) => {\n                const fret = tab[stringKey]?.[beat];\n                if (fret !== undefined && fret !== '' && fret !== '-') {\n                    const fretNum = parseInt(fret, 10);\n                    if (!isNaN(fretNum) && fretNum >= 0) {\n                        activeFrets.push(fretNum);\n                        activeFretIndices.push({ stringKey, idx, fret: fretNum });\n                    }\n                }\n            });\n            \n            // Check if we have a stretch problem\n            if (activeFrets.length >= 2) {\n                const minFret = Math.min(...activeFrets);\n                const maxFret = Math.max(...activeFrets);\n                const stretch = maxFret - minFret;\n                \n                if (stretch > maxStretch) {\n                    // Remove the highest fret (usually the problematic outlier)\n                    const highestFretEntry = activeFretIndices.find(entry => entry.fret === maxFret);\n                    \n                    if (highestFretEntry) {\n                        tab[highestFretEntry.stringKey][beat] = '-';\n                        adjustmentCount++;\n                        needsRecheck = true; // Re-check this beat after removal\n                    }\n                }\n            }\n        }\n    }\n    \n    if (adjustmentCount > 0) {\n        console.log(`Sanitized ${adjustmentCount} notes to prevent impossible stretches (>${maxStretch} frets)`);\n    }\n    \n    return tab;\n}\n\n// MAIN GENERATOR: Create complete 512-beat pedagogical tab\nexport function generatePedagogicalTab(instrumentTuning, rootNote, scaleIntervals) {\n    // Get scale notes\n    const scaleNotes = getScaleNotes(rootNote, scaleIntervals);\n    \n    // Get strings (reversed for display: thinnest to thickest)\n    const strings = instrumentTuning.tuning.map(s => `${s.label}${s.octave}`).reverse();\n    const stringOpenNotes = instrumentTuning.tuning.map(s => s.open_note).reverse();\n    const numStrings = strings.length;\n    \n    // Get maximum fret for this instrument\n    const maxFret = getMaxFretForInstrument(instrumentTuning.name);\n    \n    // Pre-generate Module 2 data (vertical scale fragments across all strings)\n    const module2Data = {};\n    for (let m = 6; m < 10; m++) {\n        const startFret = (m - 6) * 3;\n        const fragment = generateModule2PositionalScale(stringOpenNotes, scaleNotes, startFret);\n        module2Data[m] = fragment;\n    }\n    \n    const tab = {};\n    \n    // Generate tab for each string\n    strings.forEach((stringKey, idx) => {\n        const stringOpenNote = stringOpenNotes[idx];\n        const stringIdx = numStrings - 1 - idx;\n        const measures = [];\n        \n        // 32 measures total, each module gets specific measures\n        for (let m = 0; m < 32; m++) {\n            let pattern;\n            \n            // MODULE 1: M1-M6 (Single-String Linearization - rotation system)\n            if (m < 6) {\n                const activeString = m % numStrings;\n                if (activeString === stringIdx) {\n                    pattern = generateModule1SingleString(stringOpenNote, scaleNotes, maxFret);\n                } else {\n                    pattern = blankMeasure();\n                }\n            }\n            // MODULE 2: M7-M10 (Positional Scale Fragments - vertical integration)\n            else if (m < 10) {\n                // Use pre-generated cross-string fragment for this string\n                pattern = module2Data[m][idx] || blankMeasure();\n            }\n            // MODULE 3: M11-M16 (Melodic Patterns)\n            else if (m < 16) {\n                pattern = generateModule3MelodicPattern(stringOpenNote, scaleNotes, m, maxFret);\n            }\n            // MODULE 4: M17-M26 (Harmonic Context - using scale's I chord tones)\n            else if (m < 26) {\n                // Use root, third, and fifth of the scale\n                const chordTones = [\n                    scaleNotes[0], // Root (I)\n                    scaleNotes[2], // Third\n                    scaleNotes[4]  // Fifth\n                ];\n                pattern = generateModule4ChordArpeggio(stringOpenNote, chordTones, m, maxFret);\n            }\n            // MODULE 5: M27-M30 (Multi-Octave Traversal - ALL strings participate)\n            else if (m < 30) {\n                pattern = generateModule5Traversal(stringOpenNote, scaleNotes, m, maxFret);\n            }\n            // MODULE 6: M31-M32 (Capstone Virtuosity - ALL strings participate)\n            else {\n                pattern = generateModule6Virtuoso(stringOpenNote, scaleNotes, m, maxFret);\n            }\n            \n            measures.push(...pattern);\n        }\n        \n        tab[stringKey] = measures;\n    });\n    \n    // POST-PROCESS: Remove impossible finger stretches\n    sanitizeStretchesInTab(tab, strings, 4);\n    \n    return tab;\n}\n\n// Export for use in main.js\nif (typeof window !== 'undefined') {\n    window.generatePedagogicalTab = generatePedagogicalTab;\n    window.sanitizeStretchesInTab = sanitizeStretchesInTab;\n}\n","size_bytes":18556},"main.js":{"content":"import { TUNINGS, SCALES } from './database.js';\nimport { generateTabFromCSV } from './csv_tab_parser.js';\n// --- CONSTANTS ---\nconst FRET_SPACING = 75; // Standard width for each fret segment in the GUI (in px)\nconst STRING_PITCH_GAP = 40; // Vertical gap between strings (in px)\nconst NUM_FRETS = 15; // Use a global fret count\n\n// --- DATA DEFINITIONS ---\n\nconst CHROMATIC_NOTES = [\n    { name: \"C\", aliases: [] },\n    { name: \"C♯\", aliases: [\"D♭\"] },\n    { name: \"D\", aliases: [] },\n    { name: \"D♯\", aliases: [\"E♭\"] },\n    { name: \"E\", aliases: [] },\n    { name: \"F\", aliases: [] },\n    { name: \"F♯\", aliases: [\"G♭\"] },\n    { name: \"G\", aliases: [] },\n    { name: \"G♯\", aliases: [\"A♭\"] },\n    { name: \"A\", aliases: [] },\n    { name: \"A♯\", aliases: [\"B♭\"] },\n    { name: \"B\", aliases: [] }\n];\n\n// --- SECTION 1: CORRECTED CONSTANTS (from C_Major_Guitar_Tab_sequential.csv) ---\n\nconst NOTES_PER_BEAT = 4; // 16th notes\nconst DEFAULT_BEATS_PER_MEASURE = 4; // 4/4 time\nconst DEFAULT_NOTES_PER_MEASURE = DEFAULT_BEATS_PER_MEASURE * NOTES_PER_BEAT; // 16\n\n// --- FIX: Updated totals based on the full CSV data (C_Major_Guitar_Tab_sequential.csv) ---\nconst TOTAL_MEASURES = 32;\nconst TOTAL_DEFAULT_NOTES = 512;\n// --- END SECTION 1 ---\n\n\n// --- SECTION 2: CORRECTED C_MAJOR_BASE_TAB (from C_Major_Guitar_Tab_sequential.csv) ---\n// This 6-string guitar tab is left as-is, per user request.\nconst C_MAJOR_BASE_TAB = {\n    'e4': [\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M1\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M2\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M3\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M4\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M5\n        '0','1','0','3','1','3','1','0','3','0','1','0','3','0','3','1', // M6\n        '3','1','3','0','1','0','1','3','1','3','1','0','1','3','1','3', // M7\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M8\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M9\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M10\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M11\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M12\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','10','12', // M13\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M14\n        '0','-','-','-','-','1','3','-','-','-','-','0','1','-','-','3', // M15\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M16\n        '-','-','3','2','-','-','-','-','1','0','-','-','-','-','-','-', // M17\n        '-','-','-','-','-','-','-','-','3','-','-','-','-','-','-','-', // M18\n        '-','-','-','-','-','-','-','-','0','-','-','-','-','-','-','-', // M19\n        '2','2','-','-','4','4','-','-','1','1','-','-','4','-','-','-', // M20\n        '-','-','-','-','4','-','4','-','2','-','2','-','-','-','-','0', // M21\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M22\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','4', // M23\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','0', // M24\n        '3','1','0','-','-','-','-','-','-','-','-','-','-','-','-','-', // M25\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','5', // M26\n        '8','7','5','-','-','-','-','-','-','-','-','-','-','-','-','-', // M27\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','10','12','13', // M28\n        '13','12','10','-','-','-','-','-','-','-','-','-','-','-','-','-', // M29\n        '-','-','-','-','-','-','-','-','-','-','3','1','-','2','-','-', // M30\n        '-','-','2','-','1','3','-','-','-','-','-','-','-','-','-','-', // M31\n        '12','10','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M32\n    ],\n    'B3': [\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M1\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M2\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M3\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M4\n        '0','1','0','3','1','3','1','0','3','0','1','0','3','0','3','1', // M5\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M6\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M7\n        '3','1','3','0','1','0','1','3','1','3','1','0','1','3','1','3', // M8\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M9\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M10\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M11\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M12\n        '-','-','-','-','-','-','-','-','-','-','-','-','8','10','-','-', // M13\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M14\n        '-','1','-','-','3','-','-','0','-','-','3','-','-','3','1','-', // M15\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M16\n        '-','1','-','-','3','-','-','0','-','-','3','-','-','3','1','-', // M17\n        '-','-','-','-','-','-','-','-','3','-','-','-','-','-','-','-', // M18\n        '2','2','-','-','4','4','-','-','1','1','-','-','2','-','-','-', // M19\n        '3','-','3','-','5','-','5','-','1','-','1','-','-','5','3','-', // M20\n        '1','-','1','-','5','-','-','5','3','-','-','3','-','-','3','3', // M21\n        '-','-','-','-','-','-','-','-','1','-','1','-','-','-','-','3', // M22\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','4','4', // M23\n        '-','-','-','-','-','-','-','-','-','-','-','-','0','1','3','-', // M24\n        '-','-','-','3','1','0','-','-','-','-','-','-','-','-','-','-', // M25\n        '-','-','-','-','-','-','-','-','-','-','-','-','5','6','8','-', // M26\n        '-','-','-','8','6','5','-','-','-','-','-','-','-','-','-','-', // M27\n        '-','-','-','-','-','-','-','-','-','-','10','12','13','-','-','-', // M28\n        '-','-','-','13','12','10','-','-','-','-','-','-','-','-','-','-', // M29\n        '-','-','10','8','6','5','6','5','4','2','3','1','-','3','1','-', // M30\n        '-','1','3','-','1','3','2','4','5','6','5','6','8','10','-','-', // M31\n        '-','-','10','8','-','-','-','-','-','-','-','-','-','-','-','-', // M32\n    ],\n    'G3': [\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M1\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M2\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M3\n        '0','2','0','4','2','4','2','0','4','0','2','0','4','0','4','2', // M4\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M5\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M6\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M7\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M8\n        '4','2','4','0','2','0','2','4','2','4','2','0','2','4','2','4', // M9\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M10\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M11\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M12\n        '-','-','-','-','-','-','-','-','-','5','7','9','-','-','-','-', // M13\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M14\n        '-','-','4','2','-','-','-','-','2','0','-','-','-','-','-','-', // M15\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M16\n        '0','-','-','-','-','1','3','-','-','-','-','0','2','-','-','4', // M17\n        '1','1','-','-','2','2','-','-','0','0','-','-','-','-','-','-', // M18\n        '2','-','2','-','4','-','4','-','0','-','0','-','-','2','4','-', // M19\n        '2','-','-','2','4','-','-','4','2','-','-','2','-','-','-','2', // M20\n        '2','-','-','2','4','4','-','-','2','2','-','-','-','2','-','2', // M21\n        '0','-','0','-','4','-','4','-','0','-','-','0','-','-','2','2', // M22\n        '-','-','-','-','-','-','-','-','1','-','1','-','-','2','-','2', // M23\n        '-','-','-','-','-','-','-','-','-','0','2','4','-','-','-','-', // M24\n        '-','-','-','-','-','-','4','2','0','-','-','-','-','-','-','-', // M25\n        '-','-','-','-','-','-','-','-','-','5','7','9','-','-','-','-', // M26\n        '-','-','-','-','-','-','7','5','-','-','-','-','-','-','-','-', // M27\n        '-','-','-','-','-','-','-','9','10','12','-','-','-','-','-','-', // M28\n        '-','-','-','-','-','-','12','10','9','-','-','-','-','-','-','-', // M29\n        '10','9','9','7','5','4','5','4','3','2','0','2','1','2','0','3', // M30\n        '3','0','2','1','2','0','2','3','4','5','4','5','7','9','9','10', // M31\n        '-','-','-','-','9','7','5','-','-','-','-','-','-','-','-','-', // M32\n    ],\n    'D3': [\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M1\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M2\n        '0','2','0','3','2','3','2','0','3','0','2','0','3','0','3','2', // M3\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M4\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M5\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M6\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M7\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M8\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M9\n        '3','2','3','0','2','0','2','3','2','3','2','0','2','3','2','3', // M10\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M11\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M12\n        '-','-','-','-','-','-','3','5','7','-','-','-','-','-','-','-', // M13\n        '-','-','3','2','-','-','-','-','2','0','-','-','-','-','-','-', // M14\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M15\n        '0','-','-','-','-','2','3','-','-','-','-','0','2','-','-','3', // M16\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M17\n        '2','-','2','-','3','-','3','-','0','-','0','-','2','-','-','-', // M18\n        '2','-','-','2','4','-','-','4','2','-','-','2','-','-','-','4', // M19\n        '0','-','-','-','2','-','-','-','3','-','-','-','-','-','-','-', // M20\n        '3','3','-','-','-','-','-','-','-','-','-','-','3','-','-','3', // M21\n        '2','-','-','2','4','-','-','4','2','2','-','-','-','2','-','2', // M22\n        '2','-','2','-','3','-','3','-','0','-','-','0','2','-','-','2', // M23\n        '-','-','-','-','-','-','0','2','3','-','-','-','-','-','-','-', // M24\n        '-','-','-','-','-','-','-','-','-','-','-','-','3','2','0','-', // M25\n        '-','-','-','-','-','-','5','7','9','-','-','-','-','-','-','-', // M26\n        '-','-','-','-','-','-','-','-','7','5','-','-','-','-','-','-', // M27\n        '-','-','-','-','9','10','12','-','-','-','-','-','-','-','-','-', // M28\n        '-','-','-','-','-','-','-','-','-','12','10','9','-','-','-','-', // M29\n        '10','9','7','5','7','6','7','5','4','2','0','3','2','0','2','4', // M30\n        '4','3','-','2','-','-','0','2','3','5','7','8','6','8','11','12', // M31\n        '-','-','-','-','-','-','-','-','-','-','5','3','2','-','-','-', // M32\n    ],\n    'A2': [\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M1\n        '0','2','0','3','2','3','2','0','3','0','2','0','3','0','3','2', // M2\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M3\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M4\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M5\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M6\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M7\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M8\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M9\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M10\n        '3','2','3','0','2','0','2','3','2','3','2','0','2','3','2','3', // M11\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M12\n        '-','-','-','2','3','5','-','-','-','-','-','-','-','-','-','-', // M13\n        '-','2','-','-','3','-','-','0','-','-','3','-','-','3','2','-', // M14\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M15\n        '-','2','-','-','3','-','-','0','-','-','3','-','-','3','2','-', // M16\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M17\n        '2','-','-','2','3','-','-','3','2','-','-','2','-','3','2','-', // M18\n        '0','-','-','-','2','-','-','-','3','-','-','-','-','-','-','-', // M19\n        '-','-','-','-','-','-','-','-','3','-','-','-','-','-','-','-', // M20\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','0', // M21\n        '3','3','-','-','2','2','-','-','-','-','-','-','3','-','-','3', // M22\n        '3','-','-','3','3','-','-','3','2','2','-','-','-','-','-','-', // M23\n        '-','-','-','0','2','3','-','-','-','-','-','-','-','-','-','-', // M24\n        '-','-','-','-','-','-','-','-','-','-','-','-','3','2','0','-', // M25\n        '-','-','-','-','-','-','5','7','8','-','-','-','-','-','-','-', // M26\n        '-','-','-','-','-','-','-','-','-','-','8','7','5','-','-','-', // M27\n        '-','-','10','12','-','-','-','-','-','-','-','-','-','-','-','-', // M28\n        '-','-','-','-','-','-','-','-','-','-','-','-','12','10','-','-', // M29\n        '12','11','8','6','8','7','5','3','2','0','-','-','2','-','3','4', // M30\n        '4','3','-','2','-','-','0','2','3','5','7','8','6','8','11','12', // M31\n        '-','-','-','-','-','-','-','-','-','-','5','3','2','-','-','-', // M32\n    ],\n    'E2': [\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M1\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M2\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M3\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M4\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M5\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M6\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M7\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M8\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M9\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M10\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M11\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M12\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M13\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M14\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M15\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M16\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M17\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M18\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M19\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M20\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M21\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M22\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M23\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M24\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M25\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M26\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M27\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M28\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M29\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M30\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M31\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M32\n    ],\n};\n// --- END SECTION 2 ---\n\n\n// --- SECTION 3: C_MAJOR_BASE_NOTE_MAP (6-String Guitar) ---\n// This map is left as-is, per user request.\nconst C_MAJOR_BASE_NOTE_MAP = {\n    'e4': { '0': 4, '1': 5, '2': 6, '3': 7, '4': 8, '5': 9, '7': 11, '8': 12, '10': 14, '12': 16, '13': 17 },\n    'B3': { '0': 11, '1': 12, '2': 13, '3': 14, '4': 15, '5': 16, '6': 17, '8': 19, '10': 21, '12': 23, '13': 24 },\n    'G3': { '0': 7, '1': 8, '2': 9, '3': 10, '4': 11, '5': 12, '7': 14, '9': 16, '10': 17, '12': 19 },\n    'D3': { '0': 2, '2': 4, '3': 5, '4': 6, '5': 7, '6': 8, '7': 9, '9': 11, '10': 12, '12': 14 },\n    'A2': { '0': 9, '2': 11, '3': 12, '4': 13, '5': 14, '6': 15, '7': 16, '8': 17, '10': 19, '11': 20, '12': 21 },\n    'E2': { '0': 4, '1': 5, '2': 6, '3': 7, '5': 9, '7': 11, '8': 12, '10': 14, '12': 16, '13': 17 },\n};\n// --- END SECTION 3 ---\n\nconst C_MAJOR_ROOT_INDEX = 0; // C = 0\n\n// --- TABLATURE GENERATOR SYSTEM ---\n// Generates comprehensive 512-beat pedagogical tablature for any instrument\n\nfunction generateBlankMeasure() {\n    return Array(16).fill('-');\n}\n\nfunction generateDronePattern(type = 'quarter') {\n    if (type === 'quarter') {\n        const pattern = [];\n        for (let i = 0; i < 16; i += 4) {\n            pattern.push('0', '-', '-', '-');\n        }\n        return pattern;\n    }\n    return Array(16).fill('0');\n}\n\nfunction getScaleFretsForString(openNote, targetScale = 'C major', maxFret = 24) {\n    const chromatic = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n    const flatToSharp = {\n        'Db': 'C#', 'Eb': 'D#', 'Gb': 'F#', 'Ab': 'G#', 'Bb': 'A#',\n        'D♭': 'C#', 'E♭': 'D#', 'G♭': 'F#', 'A♭': 'G#', 'B♭': 'A#'\n    };\n    const cMajorIntervals = [0, 2, 4, 5, 7, 9, 11];\n    \n    let openNoteBase = openNote.replace(/[0-9]/g, '').replace('♯', '#');\n    if (flatToSharp[openNoteBase]) {\n        openNoteBase = flatToSharp[openNoteBase];\n    }\n    \n    const openIdx = chromatic.indexOf(openNoteBase);\n    if (openIdx === -1) return [0, 2, 3, 5, 7, 9, 10, 12];\n    \n    const scaleFrets = [];\n    for (let fret = 0; fret <= maxFret; fret++) {\n        const noteIdx = (openIdx + fret) % 12;\n        if (cMajorIntervals.includes(noteIdx)) {\n            scaleFrets.push(fret);\n        }\n    }\n    \n    // Guarantee minimum frets - if still less than 5, add chromatic fills\n    if (scaleFrets.length < 5) {\n        for (let fret = 0; fret <= 12; fret++) {\n            if (!scaleFrets.includes(fret)) {\n                scaleFrets.push(fret);\n            }\n            if (scaleFrets.length >= 8) break;\n        }\n        scaleFrets.sort((a, b) => a - b);\n    }\n    \n    return scaleFrets;\n}\n\nfunction generateStringIsolationPattern(openNote) {\n    const scaleFrets = getScaleFretsForString(openNote);\n    // Guarantee at least 4 frets by cycling through available ones\n    const frets = [\n        scaleFrets[0] || 0,\n        scaleFrets[1] || 2,\n        scaleFrets[2] || 3,\n        scaleFrets[3] || 5\n    ];\n    \n    return [\n        frets[0], frets[1], frets[0], frets[2], frets[1], frets[2], frets[1], frets[0],\n        frets[2], frets[0], frets[1], frets[0], frets[2], frets[0], frets[2], frets[1]\n    ].map(f => f.toString());\n}\n\nfunction generatePositionDrill(openNote, position = 'low') {\n    const scaleFrets = getScaleFretsForString(openNote);\n    const offset = position === 'mid' ? Math.min(2, Math.max(0, scaleFrets.length - 4)) :\n                   position === 'high' ? Math.min(4, Math.max(0, scaleFrets.length - 4)) : 0;\n    \n    const frets = [\n        scaleFrets[offset] || 0,\n        scaleFrets[offset + 1] || 2,\n        scaleFrets[offset + 2] || 3,\n        scaleFrets[offset + 3] || 5\n    ];\n    \n    return [\n        frets[0], frets[1], frets[0], frets[2], frets[1], frets[2], frets[1], frets[0],\n        frets[2], frets[0], frets[1], frets[0], frets[2], frets[0], frets[2], frets[1]\n    ].map(f => f.toString());\n}\n\nfunction generateScaleRun(openNote, ascending = true) {\n    const scaleFrets = getScaleFretsForString(openNote);\n    const frets = ascending ? scaleFrets : [...scaleFrets].reverse();\n    const notes = [];\n    \n    // Fill all 16 beats with scale notes, cycling if needed\n    for (let i = 0; i < 16; i++) {\n        notes.push((frets[i % frets.length] || 0).toString());\n    }\n    \n    return notes;\n}\n\nfunction generateArpeggioPattern(openNote, chordType = 'major') {\n    const scaleFrets = getScaleFretsForString(openNote);\n    const intervals = chordType === 'major' ? [0, 2, 4] : [0, 2, 3];\n    const chordFrets = intervals.map(i => scaleFrets[Math.min(i, scaleFrets.length - 1)] || 0);\n    const pattern = [];\n    \n    for (let i = 0; i < 16; i += 4) {\n        pattern.push(chordFrets[i % 3], '-', '-', '-');\n    }\n    return pattern.map(f => f === '-' ? '-' : f.toString());\n}\n\nfunction generateWalkingBassPattern(openNote) {\n    const scaleFrets = getScaleFretsForString(openNote);\n    const walk = [\n        scaleFrets[0] || 0,\n        scaleFrets[1] || 2,\n        scaleFrets[2] || 3,\n        scaleFrets[3] || 5,\n        scaleFrets[4] || 7,\n        scaleFrets[3] || 5,\n        scaleFrets[2] || 3,\n        scaleFrets[1] || 2\n    ];\n    return [...walk, ...walk].map(f => f.toString());\n}\n\nfunction findBestChordFret(openNote, preferredChordTones = ['C', 'E', 'G'], skipFirst = false) {\n    // Find the best playable fret for chord tones, searching 0-24 frets\n    const chromatic = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n    const flatToSharp = {\n        // Standard ASCII flats\n        'Db': 'C#', 'Eb': 'D#', 'Gb': 'F#', 'Ab': 'G#', 'Bb': 'A#',\n        'db': 'C#', 'eb': 'D#', 'gb': 'F#', 'ab': 'G#', 'bb': 'A#',\n        'DB': 'C#', 'EB': 'D#', 'GB': 'F#', 'AB': 'G#', 'BB': 'A#',\n        // Unicode flats (♭)\n        'D♭': 'C#', 'E♭': 'D#', 'G♭': 'F#', 'A♭': 'G#', 'B♭': 'A#',\n        'd♭': 'C#', 'e♭': 'D#', 'g♭': 'F#', 'a♭': 'G#', 'b♭': 'A#',\n        'C♭': 'B', 'c♭': 'B', 'F♭': 'E', 'f♭': 'E'\n    };\n    \n    // Normalize: remove octave numbers, handle sharps\n    let openNoteBase = openNote.replace(/[0-9]/g, '').replace('♯', '#');\n    \n    // Convert flats to sharps BEFORE uppercasing\n    if (flatToSharp[openNoteBase]) {\n        openNoteBase = flatToSharp[openNoteBase];\n    }\n    \n    // Now uppercase the result\n    openNoteBase = openNoteBase.toUpperCase();\n    \n    const openIdx = chromatic.indexOf(openNoteBase);\n    if (openIdx === -1) {\n        console.warn(`Could not parse note: ${openNote}, using first chord tone`);\n        // Fallback: return lowest chord tone index\n        for (let i = 0; i < preferredChordTones.length; i++) {\n            const chordToneIdx = chromatic.indexOf(preferredChordTones[i]);\n            if (chordToneIdx !== -1) return chordToneIdx;\n        }\n        return 0;\n    }\n    \n    // Find all frets (0-24) that produce chord tones, prefer lower frets\n    const candidateFrets = [];\n    for (let fret = 0; fret <= 24; fret++) {\n        const noteIdx = (openIdx + fret) % 12;\n        const noteName = chromatic[noteIdx];\n        if (preferredChordTones.includes(noteName)) {\n            candidateFrets.push(fret);\n        }\n    }\n    \n    // Return the lowest playable chord tone (or second-lowest if skipFirst)\n    if (candidateFrets.length === 0) return 0;\n    if (skipFirst && candidateFrets.length > 1) return candidateFrets[1];\n    return candidateFrets[0];\n}\n\nfunction generateChordMeasure(openNote, stringIdx, numStrings, measureNum) {\n    // Find the best chord tones for this string\n    const chordFret = findBestChordFret(openNote, ['C', 'E', 'G'], false);\n    const altFret = findBestChordFret(openNote, ['C', 'E', 'G'], true); // Get second chord tone\n    \n    const pattern = [];\n    \n    // Different chord patterns for each measure (M27-32)\n    const measureOffset = measureNum - 26; // 0-5\n    \n    // Create strumming/chord patterns similar to guitar CSV\n    if (measureOffset === 0) {\n        // M27: Whole note chord (hold) - all strings sustain\n        pattern.push(chordFret.toString(), '-', '-', '-', '-', '-', '-', '-', \n                     '-', '-', '-', '-', '-', '-', '-', '-');\n    } else if (measureOffset === 1) {\n        // M28: Quarter note strums - all strings strum together\n        pattern.push(chordFret.toString(), '-', '-', '-', chordFret.toString(), '-', '-', '-',\n                     chordFret.toString(), '-', '-', '-', chordFret.toString(), '-', '-', '-');\n    } else if (measureOffset === 2) {\n        // M29: Mixed chord pattern - create movement with two chord tones\n        pattern.push(chordFret.toString(), '-', altFret.toString(), '-', \n                     chordFret.toString(), '-', altFret.toString(), '-',\n                     chordFret.toString(), '-', '-', '-', altFret.toString(), '-', '-', '-');\n    } else if (measureOffset === 3) {\n        // M30: Arpeggio style - chord tones with rhythmic spacing\n        pattern.push(chordFret.toString(), '-', '-', altFret.toString(), '-', '-', \n                     chordFret.toString(), '-', '-', altFret.toString(), '-', '-', \n                     chordFret.toString(), '-', '-', '-');\n    } else if (measureOffset === 4) {\n        // M31: Dense chord pattern - rapid strumming\n        pattern.push(chordFret.toString(), '-', chordFret.toString(), altFret.toString(), '-', \n                     chordFret.toString(), '-', altFret.toString(),\n                     chordFret.toString(), '-', chordFret.toString(), '-', \n                     altFret.toString(), '-', '-', '-');\n    } else {\n        // M32: Descending finale - use chord tones throughout\n        pattern.push(chordFret.toString(), '-', '-', '-', altFret.toString(), '-', '-', '-',\n                     chordFret.toString(), '-', '-', '-', altFret.toString(), '-', '-', '-');\n    }\n    \n    return pattern;\n}\n\nfunction generateComprehensiveTabForInstrument(instrumentKey, config = {}) {\n    const tuning = TUNINGS[instrumentKey];\n    if (!tuning) {\n        console.error(`Unknown instrument: ${instrumentKey}`);\n        return null;\n    }\n    \n    const strings = tuning.tuning.map(s => `${s.label}${s.octave}`).reverse();\n    const stringOpenNotes = tuning.tuning.map(s => s.open_note).reverse();\n    const numStrings = strings.length;\n    const tab = {};\n    const noteMap = {};\n    \n    const {\n        useWalkingBass = instrumentKey.includes('bass'),\n        usePairedStrings = instrumentKey === 'mandolin',\n        useDroneString = instrumentKey === 'banjo'\n    } = config;\n    \n    strings.forEach((stringKey, idx) => {\n        const stringOpenNote = stringOpenNotes[idx];\n        const stringIdx = numStrings - 1 - idx;\n        const measures = [];\n        \n        const isDroneString = useDroneString && stringIdx === 0 && numStrings === 5;\n        \n        if (isDroneString) {\n            for (let m = 0; m < 32; m++) {\n                if (m % 4 === 0) {\n                    measures.push(...generateDronePattern('quarter'));\n                } else {\n                    measures.push(...generateBlankMeasure());\n                }\n            }\n        } else {\n            // Generate patterns with chord section towards the end\n            for (let m = 0; m < 32; m++) {\n                const activeString = m % numStrings;\n                let shouldPlay = (activeString === stringIdx);\n                \n                // M27-32: CHORD SECTION - all strings participate\n                if (m >= 26) {\n                    shouldPlay = true;\n                }\n                \n                // Generate appropriate pattern or silence\n                if (shouldPlay) {\n                    if (m < 12) {\n                        measures.push(...generateStringIsolationPattern(stringOpenNote));\n                    } else if (m < 20) {\n                        measures.push(...generatePositionDrill(stringOpenNote, 'low'));\n                    } else if (m < 26) {\n                        if (useWalkingBass && stringIdx <= 1) {\n                            measures.push(...generateWalkingBassPattern(stringOpenNote));\n                        } else {\n                            measures.push(...generateArpeggioPattern(stringOpenNote, m % 2 === 0 ? 'major' : 'minor'));\n                        }\n                    } else {\n                        // CHORD SECTION: Generate chord voicings\n                        const chordPattern = generateChordMeasure(stringOpenNote, stringIdx, numStrings, m);\n                        measures.push(...chordPattern);\n                    }\n                } else {\n                    measures.push(...generateBlankMeasure());\n                }\n            }\n        }\n        \n        tab[stringKey] = measures;\n        \n        noteMap[stringKey] = {};\n        for (let fret = 0; fret <= 12; fret++) {\n            const chromatic = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n            const openNoteBase = stringOpenNote.replace(/[0-9]/g, '');\n            const openOctave = parseInt(stringOpenNote.match(/[0-9]/)?.[0] || '2');\n            const openIdx = chromatic.indexOf(openNoteBase.replace('♯', '#').replace('♭', 'b'));\n            \n            if (openIdx >= 0) {\n                const noteIdx = (openIdx + fret) % 12;\n                const octaveOffset = Math.floor((openIdx + fret) / 12);\n                const noteName = chromatic[noteIdx];\n                const cMajorScale = ['C', 'D', 'E', 'F', 'G', 'A', 'B'];\n                \n                if (cMajorScale.includes(noteName)) {\n                    noteMap[stringKey][fret.toString()] = cMajorScale.indexOf(noteName) + ((openOctave + octaveOffset - 2) * 7);\n                }\n            }\n        }\n    });\n    \n    return { tab, noteMap };\n}\n\n// --- END TABLATURE GENERATOR SYSTEM ---\n\n\n// --- AUTO-GENERATED: ALL INSTRUMENT TABLATURE CONSTANTS ---\n\n// 4-String Bass (EADG)\nconst bassGenerated = generateComprehensiveTabForInstrument('bass_4', { useWalkingBass: true });\nconst C_MAJOR_BASS_TAB = bassGenerated.tab;\nconst C_MAJOR_BASS_NOTE_MAP = bassGenerated.noteMap;\n\n// 5-String Bass (BEADG)\nconst bass5Generated = generateComprehensiveTabForInstrument('bass_5', { useWalkingBass: true });\nconst C_MAJOR_BASS_5_TAB = bass5Generated.tab;\nconst C_MAJOR_BASS_5_NOTE_MAP = bass5Generated.noteMap;\n\n// Mandolin (GDAE)\nconst mandolinGenerated = generateComprehensiveTabForInstrument('mandolin');\nconst C_MAJOR_MANDOLIN_TAB = mandolinGenerated.tab;\nconst C_MAJOR_MANDOLIN_NOTE_MAP = mandolinGenerated.noteMap;\n\n// 5-String Banjo (gDGBD)\nconst banjoGenerated = generateComprehensiveTabForInstrument('banjo_5', { useDroneString: true });\nconst C_MAJOR_BANJO_TAB = banjoGenerated.tab;\nconst C_MAJOR_BANJO_NOTE_MAP = banjoGenerated.noteMap;\n\n// Ukulele (GCEA)\nconst ukuleleGenerated = generateComprehensiveTabForInstrument('ukulele');\nconst C_MAJOR_UKULELE_TAB = ukuleleGenerated.tab;\nconst C_MAJOR_UKULELE_NOTE_MAP = ukuleleGenerated.noteMap;\n\n// 7-String Guitar (BEADGBe)\nconst guitar7Generated = generateComprehensiveTabForInstrument('guitar_7');\nconst C_MAJOR_GUITAR_7_STRING_TAB = guitar7Generated.tab;\nconst C_MAJOR_GUITAR_7_STRING_NOTE_MAP = guitar7Generated.noteMap;\n\n// --- END AUTO-GENERATED TABLATURE CONSTANTS ---\n\n// Lookup table: Map instrument keys to their C Major base tabs\nconst BASE_TAB_BY_INSTRUMENT = {\n    'bass_4': { tab: C_MAJOR_BASS_TAB, noteMap: C_MAJOR_BASS_NOTE_MAP },\n    'bass_5': { tab: C_MAJOR_BASS_5_TAB, noteMap: C_MAJOR_BASS_5_NOTE_MAP },\n    'mandolin': { tab: C_MAJOR_MANDOLIN_TAB, noteMap: C_MAJOR_MANDOLIN_NOTE_MAP },\n    'banjo_5': { tab: C_MAJOR_BANJO_TAB, noteMap: C_MAJOR_BANJO_NOTE_MAP },\n    'ukulele': { tab: C_MAJOR_UKULELE_TAB, noteMap: C_MAJOR_UKULELE_NOTE_MAP },\n    'guitar_7': { tab: C_MAJOR_GUITAR_7_STRING_TAB, noteMap: C_MAJOR_GUITAR_7_STRING_NOTE_MAP }\n};\n\n\n// --- LEGACY BASS (REPLACED BY GENERATOR) ---\nconst C_MAJOR_BASS_8_MEASURE_LOOP_OLD = {\n    'G3': [\n        // C Major Scale (Pos 1) (M1-2) - 8th notes\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M1\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M2\n        // C Arpeggio (Pos 1) (M3-4) - 8th notes\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M3\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M4\n        // F Arpeggio (Pos 1) (M5-6) - 8th notes\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M5\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M6\n        // G Arpeggio (Pos 1) (M7-8) - 8th notes\n        '0','-','2','-','4','-','-','-','-','-','-','-','-','-','-','-', // M7\n        '0','-','-','-','4','-','2','-','0','-','-','-','-','-','-','-', // M8\n    ],\n    'D3': [\n        // C Major Scale (Pos 1) (M1-2) - 8th notes\n        '2','-','3','-','5','-','-','-','-','-','-','-','-','-','-','-', // M1\n        '-','-','-','-','-','-','5','-','3','-','2','-','-','-','-','-', // M2\n        // C Arpeggio (Pos 1) (M3-4) - 8th notes\n        '-','-','-','-','-','-','-','-','5','-','-','-','-','-','-','-', // M3\n        '5','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M4\n        // F Arpeggio (Pos 1) (M5-6) - 8th notes\n        '3','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M5\n        '3','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M6\n        // G Arpeggio (Pos 1) (M7-8) - 8th notes\n        '0','-','-','-','-','-','-','-','5','-','-','-','-','-','-','-', // M7\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M8\n    ],\n    'A2': [\n        // C Major Scale (Pos 1) (M1-2) - 8th notes\n        '3','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M1\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M2\n        // C Arpeggio (Pos 1) (M3-4) - 8th notes\n        '3','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M3\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M4\n        // F Arpeggio (Pos 1) (M5-6) - 8th notes\n        '-','-','-','-','-','-','-','-','3','-','-','-','-','-','-','-', // M5\n        '-','-','-','-','3','-','-','-','-','-','-','-','-','-','-','-', // M6\n        // G Arpeggio (Pos 1) (M7-8) - 8th notes\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M7\n        '5','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M8\n    ],\n    'E2': [\n        // C Major Scale (Pos 1) (M1-2) - 8th notes\n        '0','-','1','-','3','-','-','-','-','-','-','-','-','-','-','-', // M1\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M2\n        // C Arpeggio (Pos 1) (M3-4) - 8th notes\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M3\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M4\n        // F Arpeggio (Pos 1) (M5-6) - 8th notes\n        '1','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M5\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M6\n        // G Arpeggio (Pos 1) (M7-8) - 8th notes\n        '3','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M7\n        '-','-','-','-','-','-','-','-','-','-','-','-','-','-','-','-', // M8\n    ],\n};\n// (Old 8-measure loop code removed - now using comprehensive generator)\n/*\nconst C_MAJOR_BASS_TAB_OLD = {\n    'G3': [\n        ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['G3'], ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['G3'],\n        ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['G3'], ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['G3']\n    ],\n    'D3': [\n        ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['D3'], ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['D3'],\n        ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['D3'], ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['D3']\n    ],\n    'A2': [\n        ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['A2'], ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['A2'],\n        ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['A2'], ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['A2']\n    ],\n    'E2': [\n        ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['E2'], ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['E2'],\n        ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['E2'], ...C_MAJOR_BASS_8_MEASURE_LOOP_OLD['E2']\n    ]\n};\n*/\n// (Old bass note map also removed - now generated above)\n\n\n// --- END LEGACY BASS DATA ---\n\n\n\n\n\n\n\n\n// --- CORE LOGIC FUNCTIONS ---\n\nfunction getNoteName(startNoteIndex, startOctave, fret) {\n    const totalHalfSteps = startNoteIndex + fret;\n    const noteIndex = totalHalfSteps % 12;\n    const octave = startOctave + Math.floor(totalHalfSteps / 12); \n\n    const noteData = CHROMATIC_NOTES[noteIndex];\n    const primaryName = noteData.name;\n    const displayNote = noteData.aliases.length > 0 ? `${primaryName}/${noteData.aliases[0]}` : primaryName;\n\n    return {\n        full: `${displayNote}${octave}(${fret})`,\n        name_only: displayNote,\n        index: noteIndex,\n        octave: octave\n    };\n}\n\nfunction isNoteInScale(noteIndex, rootIndex, scaleIntervals) {\n    const relativeIndex = (noteIndex - rootIndex + 12) % 12;\n    return scaleIntervals.includes(relativeIndex);\n}\n\nfunction getOrdinal(n) {\n    if (10 <= n % 100 && n % 100 <= 20) return `${n}th`;\n    return { 1: `${n}st`, 2: `${n}nd`, 3: `${n}rd` }[n % 10] || `${n}th`;\n}\n\nfunction getRootOptions() {\n    return CHROMATIC_NOTES.reduce((acc, note, index) => {\n        const name = note.name + (note.aliases.length > 0 ? `/${note.aliases[0]}` : '');\n        acc[name] = index;\n        return acc;\n    }, {});\n}\n\nfunction buildInstrumentData(instrumentKey, rootIndex, scaleIntervals) {\n    const tuning = TUNINGS[instrumentKey].tuning;\n    const fretboardData = [];\n    \n    // Determine number of frets to display\n    let fretCount = NUM_FRETS; // Use global\n    if (instrumentKey.includes('Banjo')) {\n        fretCount = 10;\n    } else if (instrumentKey.includes('Mandolin')) {\n        fretCount = 12;\n    }\n\n    for (const stringInfo of tuning) {\n        const row = {\n            stringName: stringInfo.label, // 'e', 'B', 'G', 'D', 'A', 'E'\n            open_note_full: `${stringInfo.open_note}(0)`,\n            open_note_name: stringInfo.open_note,\n            label: stringInfo.label,\n            ordinal: getOrdinal(stringInfo.string),\n            cells: [],\n            thickness: stringInfo.thickness,\n            string_index: stringInfo.string,\n            base_note_index: stringInfo.note_index // Store base index for transposition\n        };\n\n        for (let fret = 0; fret <= fretCount; fret++) {\n            let noteValue = '---';\n            let isRoot = false;\n            let noteName = '';\n            \n            // Banjo 5th string (drone string) typically ends at fret 5\n            const isDroneString = instrumentKey.includes('Banjo') && stringInfo.string === 5;\n            if (isDroneString && fret > 5) {\n                row.cells.push({ fret, value: noteValue, is_root: false, name: '', is_scale: false, note_index: -1 });\n                continue;\n            }\n\n            const note = getNoteName(stringInfo.note_index, stringInfo.octave, fret);\n            let isScale = false;\n\n            if (isNoteInScale(note.index, rootIndex, scaleIntervals)) {\n                noteValue = note.full;\n                noteName = note.name_only;\n                isScale = true;\n                if (note.index === rootIndex) {\n                    isRoot = true;\n                }\n            }\n\n            row.cells.push({\n                fret,\n                value: noteValue,\n                is_root: isRoot,\n                is_scale: isScale,\n                name: noteName,\n                note_index: note.index\n            });\n        }\n        fretboardData.push(row);\n    }\n    // Data is [Thin (idx 0) ... Thick (idx N-1)]\n    return fretboardData;\n}\n\n// --- RENDERING FUNCTIONS (GUI and Tables) ---\n\nfunction renderGui(fretboardData, instrumentKey, handedness, showNotes) {\n    const numStrings = fretboardData.length;\n    const fretCount = fretboardData[0].cells.length - 1;\n\n    const fretboardGui = document.createElement('div');\n    fretboardGui.className = 'fretboard-gui';\n    fretboardGui.style.height = `${numStrings * STRING_PITCH_GAP + 50}px`; \n\n    // Calculate GUI width\n    const guiWidth = fretCount * FRET_SPACING + FRET_SPACING; // Max frets * spacing + 1 additional space for Fret 0\n    fretboardGui.style.minWidth = `${guiWidth}px`;\n\n    // Draw Frets (Vertical Lines)\n    for (let f = 0; f <= fretCount; f++) {\n        const fretPos = f * FRET_SPACING;\n        const fretEl = document.createElement('div');\n        fretEl.className = 'fret';\n        fretEl.style.left = `${fretPos}px`;\n        fretEl.style.width = '1px';\n        \n        if (f > 0) {\n            fretEl.style.transform = 'translateX(-1px)';\n        } else {\n            fretEl.style.borderLeft = '6px solid #aaa'; // Nut (Fret 0 marker)\n            fretEl.style.left = '0';\n            fretEl.style.zIndex = '50';\n        }\n        fretboardGui.appendChild(fretEl);\n\n        // Fret Markers (Dots)\n        const midPointY = (30 + (numStrings - 1) * STRING_PITCH_GAP + 30) / 2; // Midpoint between first and last string\n        if ([3, 5, 7, 9, 15].includes(f) && f <= fretCount) {\n            const marker = document.createElement('div');\n            marker.className = 'fret-marker';\n            marker.style.left = `${fretPos + (FRET_SPACING / 2)}px`; \n            marker.style.top = `${midPointY}px`;\n            fretboardGui.appendChild(marker);\n        }\n        if (f === 12 && f <= fretCount) {\n            const marker1 = document.createElement('div');\n            marker1.className = 'fret-marker';\n            marker1.style.left = `${fretPos + (FRET_SPACING / 2)}px`;\n            marker1.style.top = `${midPointY - STRING_PITCH_GAP}px`;\n            fretboardGui.appendChild(marker1);\n\n            const marker2 = document.createElement('div');\n            marker2.className = 'fret-marker';\n            marker2.style.left = `${fretPos + (FRET_SPACING / 2)}px`;\n            marker2.style.top = `${midPointY + STRING_PITCH_GAP}px`;\n            fretboardGui.appendChild(marker2);\n        }\n\n        // Fret Number Label\n        const numLabel = document.createElement('div');\n        numLabel.className = 'fret-number';\n        \n        if (f === 0) {\n            numLabel.textContent = '0';\n            numLabel.style.left = `${FRET_SPACING / 2}px`; \n            fretboardGui.appendChild(numLabel);\n        } else if (f <= fretCount) {\n            numLabel.textContent = f;\n            numLabel.style.left = `${fretPos + (FRET_SPACING / 2)}px`;\n            fretboardGui.appendChild(numLabel);\n        }\n    }\n    \n    // Draw Strings and Notes\n    \n    // Determine string order for rendering\n    let orderedStrings = [...fretboardData];\n    if (handedness === 'right') {\n        // RIGHT-HANDED: Player View (Thinnest string on top, Thickest string on bottom)\n        orderedStrings.sort((a, b) => a.thickness - b.thickness);\n    } else {\n        // LEFT-HANDED: Mirrored View (Thickest string on top, Thinnest string on bottom)\n        orderedStrings.sort((a, b) => b.thickness - a.thickness);\n    }\n\n    // Find the maximum thickness to normalize string heights\n    const maxThickness = orderedStrings.reduce((max, s) => Math.max(max, s.thickness), 0);\n    \n    orderedStrings.forEach((stringData, stringIndex) => {\n        // String vertical position\n        const stringY = 30 + stringIndex * STRING_PITCH_GAP; \n\n        // String wire\n        const stringEl = document.createElement('div');\n        stringEl.className = 'string';\n        stringEl.style.top = `${stringY}px`;\n        \n        const lineHeight = 1 + (stringData.thickness / maxThickness) * 2; \n        stringEl.style.height = `${lineHeight}px`; \n        \n        fretboardGui.appendChild(stringEl);\n\n        // String label (open note name)\n        const labelEl = document.createElement('div');\n        labelEl.className = 'string-label';\n        labelEl.textContent = stringData.open_note_name;\n        labelEl.style.top = `${stringY}px`;\n        fretboardGui.appendChild(labelEl);\n\n        // Place notes (dots)\n        stringData.cells.forEach(cell => {\n            if (cell.is_scale && cell.fret >= 0) {\n                const dotEl = document.createElement('div');\n                dotEl.className = `fret-dot ${cell.is_root ? 'root' : 'scale'}`;\n                \n                // Use showNotes to determine content\n                const dotContent = showNotes ? cell.name.split('/')[0] : (cell.is_root ? 'R' : '');\n                dotEl.textContent = dotContent;\n\n                let xPos;\n                const dotSize = 24; // 1.5rem\n\n                if (cell.fret === 0) {\n                     xPos = (FRET_SPACING / 2);\n                } else {\n                    xPos = (cell.fret * FRET_SPACING) + (FRET_SPACING / 2);\n                }\n\n                dotEl.style.left = `${xPos}px`;\n                dotEl.style.top = `${stringY}px`;\n                \n                const isDroneString = instrumentKey.includes('Banjo') && stringData.string_index === 5;\n                if (isDroneString && cell.fret > 5) return;\n\n                fretboardGui.appendChild(dotEl);\n            }\n        });\n    });\n\n    const guiWrapper = document.createElement('div');\n    guiWrapper.className = 'fretboard-container';\n    guiWrapper.appendChild(fretboardGui);\n    \n    return guiWrapper;\n}\n\nfunction renderTable1(fretboardData, rootName, modeName, showNotes) {\n    // Orientation 1: Strings as Rows (Thin to Thick, top to bottom)\n    const fretCount = fretboardData[0].cells.length - 1;\n\n    // Sort data: Thin (top row) to Thick (bottom row)\n    let orderedStrings = [...fretboardData].sort((a, b) => a.thickness - b.thickness);\n\n    let html = `<div class=\"p-6 bg-white rounded-xl shadow-lg border border-gray-200\">\n        <h3 class=\"text-xl font-semibold mb-4 text-gray-800\">Strings as Rows (Thinnest String at Top)</h3>\n        <div class=\"overflow-x-auto\">\n            <table class=\"min-w-full divide-y divide-gray-200\">\n                <thead class=\"bg-gray-50\">\n                    <tr>\n                        <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">String</th>\n                        ${Array.from({ length: fretCount + 1 }, (_, i) => `<th class=\"px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider\">Fret ${i}</th>`).join('')}\n                    </tr>\n                </thead>\n                <tbody class=\"bg-white divide-y divide-gray-200\">\n                    ${orderedStrings.map(stringData => {\n                        const stringLabel = `${stringData.label} (${stringData.open_note_name})`;\n                        return `<tr>\n                            <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">${stringLabel}</td>\n                            ${stringData.cells.map(note => {\n                                const isRoot = note.is_root;\n                                const isScale = note.is_scale && !isRoot;\n                                let classes = 'px-2 py-4 whitespace-nowrap text-center text-sm font-bold';\n                                if (isRoot) {\n                                    classes += ' bg-red-100 text-red-800 rounded-lg';\n                                } else if (isScale) {\n                                    classes += ' bg-indigo-100 text-indigo-800 rounded-lg';\n                                } else {\n                                    classes += ' text-gray-400';\n                                }\n                                const display = showNotes ? (note.is_scale ? note.name : '-') : (note.is_scale ? (isRoot ? 'R' : 'X') : '-');\n                                return `<td class=\"${classes}\">${display}</td>`;\n                            }).join('')}\n                        </tr>`;\n                    }).join('')}\n                </tbody>\n            </table>\n        </div>\n    </div>`;\n    return html;\n}\n\nfunction renderTable2(fretboardData, rootName, modeName, handedness, showNotes) {\n    // Orientation 2: Frets as Rows (Transposed - Handedness Specific)\n    const fretCount = fretboardData[0].cells.length - 1;\n\n    // Determine column order based on handedness\n    let stringsToRender = [...fretboardData];\n    if (handedness === 'right') {\n        // Right-Handed: Thickest (Left) to Thinnest (Right)\n        stringsToRender.sort((a, b) => b.thickness - a.thickness);\n    } else {\n        // Left-Handed: Thinnest (Left) to Thickest (Right)\n        stringsToRender.sort((a, b) => a.thickness - b.thickness);\n    }\n\n    // Headers (Strings)\n    const stringHeaders = stringsToRender.map(s => `${s.label} (${s.open_note_name})`);\n    \n    let html = `<div class=\"p-6 bg-white rounded-xl shadow-lg border border-gray-200\">\n        <h3 class=\"text-xl font-semibold mb-4 text-gray-800\">Frets as Rows (Fretboard Map)</h3>\n        <p class=\"text-sm text-gray-500 mb-4\">String order reflects the player's perspective (${handedness}-handed).</p>\n        <div class=\"overflow-x-auto\">\n            <table class=\"min-w-full divide-y divide-gray-200\">\n                <thead class=\"bg-gray-50\">\n                    <tr>\n                        <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Fret</th>\n                        ${stringHeaders.map(label => `<th class=\"px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider\">${label}</th>`).join('')}\n                    </tr>\n                </thead>\n                <tbody class=\"bg-white divide-y divide-gray-200\">\n                    ${Array.from({ length: fretCount + 1 }, (_, f) => {\n                        return `<tr>\n                            <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">Fret ${f}</td>\n                            ${stringsToRender.map(stringData => {\n                                const note = stringData.cells[f];\n                                const isRoot = note.is_root;\n                                const isScale = note.is_scale && !isRoot;\n                                let classes = 'px-2 py-4 whitespace-nowrap text-center text-sm font-bold';\n                                if (isRoot) {\n                                    classes += ' bg-red-100 text-red-800 rounded-lg';\n                                } else if (isScale) {\n                                    classes += ' bg-indigo-100 text-indigo-800 rounded-lg';\n                                } else {\n                                    classes += ' text-gray-400';\n                                }\n                                const display = showNotes ? (note.is_scale ? note.name : '-') : (note.is_scale ? (isRoot ? 'R' : 'X') : '-');\n                                return `<td class=\"${classes}\">${display}</td>`;\n                            }).join('')}\n                        </tr>`;\n                    }).join('')}\n                </tbody>\n            </table>\n        </div>\n    </div>`;\n    return html;\n}\n\n// --- NEW: TABLATURE PLAYBACK LOGIC (Part VII) ---\n\n/**\n * Parses the transposed tab data into an array of events for Tone.js.\n * @param {object} transposedTab - The tab object, e.g., { e4: ['0', '1', '-'], ... }\n * @param {object} stringDataMap - Map of string data for note calculation.\n * @param {number} tempo - The BPM for playback.\n * @returns {Array} An array of playable events for Tone.Part.\n */\nfunction parseTabToPlayableEvents(transposedTab, stringDataMap, tempo) {\n    const playableEvents = [];\n    const timePerBeat = 60 / tempo / 4; // Time for one 16th note\n    const noteDuration = \"16n\";\n\n    const stringNames = Object.keys(transposedTab);\n    if (stringNames.length === 0) return [];\n\n    const totalNotes = transposedTab[stringNames[0]].length;\n\n    for (let i = 0; i < totalNotes; i++) { // Iterate through each time step (16th note)\n        for (const stringFullName of stringNames) { // e.g., 'e4', 'B3'\n            const fret = transposedTab[stringFullName][i];\n\n            // Check for a playable note\n            if (fret !== '-' && fret !== '?' && fret !== undefined) {\n                const stringData = stringDataMap[stringFullName];\n                if (!stringData) continue;\n\n                // a. Calculate time\n                const time = i * timePerBeat;\n\n                // b. Calculate note name using Tonal.js\n                const baseMidi = Tonal.Note.midi(stringData.open_note_name);\n                if (baseMidi === undefined) continue;\n\n                const noteMidi = baseMidi + parseInt(fret, 10);\n                const noteName = Tonal.Note.fromMidi(noteMidi);\n\n                // c. Add the event object\n                playableEvents.push({\n                    time: time,\n                    note: noteName,\n                    duration: noteDuration\n                });\n            }\n        }\n    }\n    return playableEvents;\n}\n\n/**\n * Plays the parsed tablature using Tone.js.\n * @param {Array} playableEvents - The array of note objects from the parser.\n */\nasync function playTablature(playableEvents) {\n    if (playableEvents.length === 0) {\n        console.log(\"No notes to play.\");\n        return;\n    }\n\n    await Tone.start(); // Ensure AudioContext is running\n    stopTablature(); // Stop any previous playback\n\n    currentTabPart = new Tone.Part((time, event) => {\n        synth.triggerAttackRelease(event.note, event.duration, time);\n    }, playableEvents).start(0);\n\n    Tone.Transport.start();\n}\n\n/**\n * Stops the tablature playback.\n */\nfunction stopTablature() {\n    Tone.Transport.stop();\n    Tone.Transport.cancel();\n    if (currentTabPart) {\n        currentTabPart.dispose();\n        currentTabPart = null;\n    }\n}\n\n// Global variable to store chord shapes\nlet chordShapesData = {};\n\n// Load chord shapes from JSON file\nasync function loadChordShapes() {\n    try {\n        const response = await fetch('/chord_shapes.json');\n        if (!response.ok) {\n            console.error('Failed to load chord shapes');\n            return;\n        }\n        chordShapesData = await response.json();\n        console.log('Chord shapes loaded successfully');\n    } catch (error) {\n        console.error('Error loading chord shapes:', error);\n    }\n}\n\n// Render a text-based chord diagram in LANDSCAPE orientation (ASCII style)\n// Strings run horizontally (like looking at guitar from above)\nfunction renderTextChordDiagram(chordData, instrumentKey = 'guitar_6') {\n    const frets = chordData.frets || [];\n    const fingers = chordData.fingers || [];\n    const title = chordData.title || '';\n    \n    // Get instrument tuning and string names\n    const tuning = TUNINGS[instrumentKey];\n    if (!tuning) {\n        console.error('Unknown instrument:', instrumentKey);\n        return '<p>Error: Unknown instrument</p>';\n    }\n    \n    const numStrings = tuning.tuning.length;\n    \n    // Get string labels from tuning data\n    // tuning.tuning is ordered: [thinnest...thickest] (e.g., [e, B, G, D, A, E])\n    const stringLabels = tuning.tuning.map(s => s.label);\n    \n    // Find the highest fret used (for display range)\n    const maxFret = Math.max(...frets.filter(f => f > 0));\n    const startFret = maxFret > 4 ? Math.max(1, maxFret - 3) : 0;\n    const displayFrets = maxFret > 4 ? 4 : 5; // Show 4-5 frets\n    \n    let diagram = '';\n    \n    // Title\n    diagram += `<div class=\"chord-diagram-title\">${title}</div>\\n`;\n    \n    // Fret marker (if not open position)\n    if (startFret > 0) {\n        diagram += `<div class=\"chord-fret-marker\">Position: ${startFret}fr</div>\\n`;\n    }\n    \n    // Build the landscape fretboard\n    diagram += '<div class=\"chord-fretboard-landscape\">\\n';\n    \n    // Display strings from thinnest (top) to thickest (bottom)\n    // Loop from index 0 (thinnest) to numStrings-1 (thickest)\n    for (let stringIdx = 0; stringIdx < numStrings; stringIdx++) {\n        diagram += '<div class=\"chord-string-row\">\\n';\n        \n        // String name and x/o indicator on left\n        const fret = frets[stringIdx];\n        let indicator = '';\n        if (fret === -1) {\n            indicator = 'x';\n        } else if (fret === 0 && startFret === 0) {\n            indicator = 'o';\n        } else {\n            indicator = ' ';\n        }\n        \n        diagram += `<div class=\"chord-string-label\">${stringLabels[stringIdx]} ${indicator}</div>`;\n        \n        // Draw nut or edge\n        if (startFret === 0) {\n            diagram += '<div class=\"chord-nut\">┃</div>'; // Thick nut line\n        } else {\n            diagram += '<div class=\"chord-edge\">│</div>'; // Thin edge\n        }\n        \n        // Draw each fret position\n        for (let fretNum = startFret; fretNum < startFret + displayFrets; fretNum++) {\n            const fingerFret = frets[stringIdx];\n            const fingerNum = fingers[stringIdx];\n            \n            // Check if finger is on this fret\n            if (fingerFret === fretNum + 1) {\n                const label = fingerNum > 0 ? fingerNum.toString() : '●';\n                diagram += `<div class=\"chord-fret-cell finger\">${label}</div>`;\n            } else {\n                diagram += '<div class=\"chord-fret-cell\">─</div>';\n            }\n            \n            // Fret line\n            diagram += '<div class=\"chord-fret-line\">│</div>';\n        }\n        \n        diagram += '</div>\\n'; // End string row\n    }\n    \n    // Fret numbers below\n    diagram += '<div class=\"chord-fret-numbers\">\\n';\n    diagram += '<div class=\"chord-string-label\"></div>'; // Empty space for alignment\n    diagram += '<div class=\"chord-edge\"></div>'; // Empty space for nut/edge\n    for (let fretNum = startFret; fretNum < startFret + displayFrets; fretNum++) {\n        const displayNum = fretNum === 0 ? '' : fretNum + 1;\n        diagram += `<div class=\"chord-fret-number\">${displayNum}</div>`;\n        diagram += '<div class=\"chord-fret-line\"></div>'; // Empty space for fret line\n    }\n    diagram += '</div>\\n';\n    \n    diagram += '</div>\\n'; // End fretboard\n    \n    return diagram;\n}\n\n// CAGED chord shape templates (relative to root position)\n// Each template is [string6, string5, string4, string3, string2, string1]\n// -1 = muted, 0 = open (when at position 0), positive = fret offset from root position\nconst CAGED_TEMPLATES = {\n    'Major': {\n        'E-Shape': {\n            pattern: [0, 2, 2, 1, 0, 0], // E Major shape (movable)\n            fingers: [0, 3, 4, 2, 0, 0],\n            baseFret: 0,\n            name: 'E-Shape (LOW)'\n        },\n        'A-Shape': {\n            pattern: [-1, 0, 2, 2, 2, 0], // A Major shape (movable)\n            fingers: [0, 0, 3, 2, 1, 0],\n            baseFret: 0,\n            name: 'A-Shape (MID)'\n        },\n        'D-Shape': {\n            pattern: [-1, -1, 0, 2, 3, 2], // D Major shape (movable)\n            fingers: [0, 0, 0, 1, 3, 2],\n            baseFret: 0,\n            name: 'D-Shape (MID-HIGH)'\n        },\n        'C-Shape': {\n            pattern: [-1, 3, 2, 0, 1, 0], // C Major shape (movable)\n            fingers: [0, 4, 3, 0, 1, 0],\n            baseFret: 0,\n            name: 'C-Shape (HIGH)'\n        }\n    },\n    'minor': {\n        'Em-Shape': {\n            pattern: [0, 2, 2, 0, 0, 0], // E minor shape (movable)\n            fingers: [0, 2, 3, 0, 0, 0],\n            baseFret: 0,\n            name: 'Em-Shape (LOW)'\n        },\n        'Am-Shape': {\n            pattern: [-1, 0, 2, 2, 1, 0], // A minor shape (movable)\n            fingers: [0, 0, 3, 2, 1, 0],\n            baseFret: 0,\n            name: 'Am-Shape (MID)'\n        },\n        'Dm-Shape': {\n            pattern: [-1, -1, 0, 2, 3, 1], // D minor shape (movable)\n            fingers: [0, 0, 0, 2, 4, 1],\n            baseFret: 0,\n            name: 'Dm-Shape (MID-HIGH)'\n        }\n    }\n};\n\n// Helper function to calculate semitone distance between two notes\nfunction getSemitoneDistance(fromNote, toNote) {\n    const chromaticScale = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n    const enharmonicMap = {\n        'Db': 'C#', 'Eb': 'D#', 'Gb': 'F#', 'Ab': 'G#', 'Bb': 'A#'\n    };\n    \n    // Normalize notes (handle enharmonics)\n    const normalizeNote = (note) => {\n        const pitchClass = Tonal.Note.pitchClass(note);\n        return enharmonicMap[pitchClass] || pitchClass;\n    };\n    \n    const from = normalizeNote(fromNote);\n    const to = normalizeNote(toNote);\n    \n    const fromIndex = chromaticScale.indexOf(from);\n    const toIndex = chromaticScale.indexOf(to);\n    \n    if (fromIndex === -1 || toIndex === -1) return null;\n    \n    // Calculate semitones (positive = up, can wrap around octave)\n    let distance = toIndex - fromIndex;\n    if (distance < 0) distance += 12;\n    \n    return distance;\n}\n\n// Generate multiple chord positions using CAGED system\nfunction generateCAGEDChords(chordName, numStrings = 6) {\n    try {\n        const chord = Tonal.Chord.get(chordName);\n        if (!chord.notes || chord.notes.length === 0) {\n            return [];\n        }\n        \n        const root = chord.tonic;\n        const chordType = chord.quality || chord.aliases[0] || '';\n        \n        // Determine if it's major or minor\n        let templates = null;\n        if (chordType === '' || chordType === 'Major' || chordType === 'major') {\n            templates = CAGED_TEMPLATES['Major'];\n        } else if (chordType.includes('minor') || chordType === 'm') {\n            templates = CAGED_TEMPLATES['minor'];\n        }\n        \n        if (!templates) {\n            return [];\n        }\n        \n        // Find what fret the root note appears on different strings\n        const tuning = ['E', 'A', 'D', 'G', 'B', 'E']; // Standard tuning note names\n        \n        const voicings = [];\n        \n        // Generate positions for each CAGED shape\n        Object.entries(templates).forEach(([shapeName, template]) => {\n            // Find where to position this shape based on root note\n            // E-Shape: root on 6th string (E string)\n            // A-Shape: root on 5th string (A string)\n            // D-Shape: root on 4th string (D string)\n            let rootString = 6;\n            if (shapeName.includes('A-')) rootString = 5;\n            if (shapeName.includes('D-') || shapeName.includes('C-')) rootString = 4;\n            \n            const openStringNote = tuning[6 - rootString];\n            const semitoneOffset = getSemitoneDistance(openStringNote, root);\n            \n            if (semitoneOffset === null || semitoneOffset < 0) return;\n            \n            // Create chord at this position\n            const frets = template.pattern.map((offset, idx) => {\n                if (offset === -1) return -1; // Muted\n                return semitoneOffset + offset;\n            });\n            \n            // Skip if any fret is too high (>15)\n            if (frets.some(f => f > 15)) return;\n            \n            voicings.push({\n                name: shapeName,\n                frets: frets,\n                fingers: template.fingers,\n                barres: [],\n                title: `${chordName} (${template.name})` \n            });\n        });\n        \n        return voicings;\n        \n    } catch (error) {\n        console.error('Error generating CAGED chords:', error);\n        return [];\n    }\n}\n\n// Simple fallback for chords that don't fit CAGED patterns\nfunction generateSimpleFallback(chordName, instrumentKey = 'guitar_6') {\n    try {\n        const chord = Tonal.Chord.get(chordName);\n        if (!chord.notes || chord.notes.length === 0) {\n            return null;\n        }\n        \n        // Get tuning for the selected instrument\n        const tuning = TUNINGS[instrumentKey];\n        if (!tuning) {\n            console.error('Unknown instrument:', instrumentKey);\n            return null;\n        }\n        \n        const chordNotes = chord.notes;\n        const numStrings = tuning.tuning.length;\n        \n        // Get open notes from instrument tuning (reverse order: thickest to thinnest)\n        const stringTuning = tuning.tuning.map(s => s.open_note).reverse();\n        \n        const frets = [];\n        const fingers = [];\n        \n        // For each string, find the nearest chord tone within first 5 frets\n        for (let s = 0; s < numStrings; s++) {\n            const openNote = stringTuning[s];\n            let foundFret = -1;\n            \n            for (let f = 0; f <= 4; f++) {\n                const fretNote = Tonal.Note.transpose(openNote, Tonal.Interval.fromSemitones(f));\n                const fretNoteName = Tonal.Note.pitchClass(fretNote);\n                \n                if (chordNotes.includes(fretNoteName)) {\n                    foundFret = f;\n                    break;\n                }\n            }\n            \n            frets.push(foundFret);\n            fingers.push(foundFret > 0 ? foundFret : 0);\n        }\n        \n        return {\n            name: 'Generated',\n            frets: frets,\n            fingers: fingers,\n            barres: [],\n            title: `${chordName} (Auto-Generated)`\n        };\n    } catch (error) {\n        console.error('Error generating fallback chord:', error);\n        return null;\n    }\n}\n\n// Initialize the harmony section using Root Note from top menu\nfunction initializeKeyHarmonySection() {\n    // Get the root note from the top menu\n    const rootSelect = document.getElementById('rootSelect');\n    if (!rootSelect) return;\n    \n    // Get the text content of the selected option (note name, not index)\n    const getSelectedRootNote = () => {\n        const selectedOption = rootSelect.options[rootSelect.selectedIndex];\n        return selectedOption ? selectedOption.textContent : 'C';\n    };\n    \n    // Initialize with current root note selection\n    const currentRoot = getSelectedRootNote();\n    console.log('Initializing harmony section with key:', currentRoot);\n    selectKey(currentRoot);\n    \n    // Listen for changes to root note and update harmony section\n    rootSelect.addEventListener('change', function() {\n        const newRoot = getSelectedRootNote();\n        console.log('Root note changed to:', newRoot);\n        selectKey(newRoot);\n    });\n}\n\n// Handle key selection\nfunction selectKey(key) {\n    console.log('selectKey called with:', key);\n    \n    // Normalize key for Tonal.js (convert Unicode ♯ to ASCII #)\n    const normalizedKey = key.replace('♯', '#').replace('♭', 'b');\n    \n    // Get diatonic chords using Tonal.js\n    const scale = Tonal.Scale.get(`${normalizedKey} major`);\n    console.log('Scale for', normalizedKey, 'major:', scale);\n    \n    if (!scale.notes || scale.notes.length === 0) {\n        console.error('Failed to get scale notes for:', normalizedKey);\n        return;\n    }\n    \n    const chordNames = scale.notes.map((note, index) => {\n        // Build triads: I, ii, iii, IV, V, vi, vii°\n        const quality = ['', 'm', 'm', '', '', 'm', 'dim'][index];\n        return note + quality;\n    });\n    \n    console.log('Chord names:', chordNames);\n    \n    // Display diatonic chords\n    const chordDisplay = document.getElementById('diatonic-chords-display');\n    if (chordDisplay) {\n        chordDisplay.innerHTML = '';\n        const romanNumerals = ['I', 'ii', 'iii', 'IV', 'V', 'vi', 'vii°'];\n        \n        chordNames.forEach((chordName, index) => {\n            const btn = document.createElement('button');\n            btn.className = 'diatonic-chord-btn px-4 py-2 bg-white border-2 border-gray-300 rounded-lg font-semibold hover:border-indigo-500 hover:text-indigo-600';\n            btn.innerHTML = `<span class=\"text-xs text-gray-500\">${romanNumerals[index]}</span><br>${chordName}`;\n            btn.addEventListener('click', () => displayChord(chordName, btn));\n            chordDisplay.appendChild(btn);\n        });\n    }\n    \n    // Display common progressions\n    displayProgressions(key, chordNames);\n}\n\n// Display a chord diagram (multiple positions)\nfunction displayChord(chordName, buttonElement) {\n    console.log('displayChord called with:', chordName);\n    \n    // Remove active class from all chord buttons\n    document.querySelectorAll('.diatonic-chord-btn').forEach(btn => btn.classList.remove('active'));\n    buttonElement.classList.add('active');\n    \n    // Get current instrument\n    const instrumentSelect = document.getElementById('instrumentFilter');\n    const instrumentKey = instrumentSelect ? instrumentSelect.value : 'guitar_6';\n    const tuning = TUNINGS[instrumentKey];\n    const numStrings = tuning ? tuning.tuning.length : 6;\n    const instrumentName = tuning ? tuning.name : '6-String Guitar (EADGBe)';\n    \n    console.log('Instrument:', instrumentName, 'Key:', instrumentKey, 'Strings:', numStrings);\n    console.log('Available shapes:', chordShapesData);\n    \n    const container = document.getElementById(\"chord-display-container\");\n    \n    let chordVoicings = [];\n    \n    // First, try to get database shapes (only for 6-string guitar)\n    if (instrumentKey === 'guitar_6') {\n        const shapes = chordShapesData[instrumentName];\n        if (shapes && shapes[chordName]) {\n            chordVoicings = [...shapes[chordName]];\n            console.log(`Found ${chordVoicings.length} database voicing(s) for ${chordName}`);\n        }\n    }\n    \n    // For guitar instruments, add CAGED auto-generated positions\n    if (instrumentKey === 'guitar_6' || instrumentKey === 'guitar_7') {\n        console.log(`Generating CAGED positions for ${chordName}...`);\n        const cagedVoicings = generateCAGEDChords(chordName, numStrings);\n        \n        if (cagedVoicings && cagedVoicings.length > 0) {\n            // Merge: Add CAGED voicings that aren't duplicates of database chords\n            cagedVoicings.forEach(caged => {\n                // Simple duplicate check based on fret positions\n                const isDuplicate = chordVoicings.some(existing => \n                    JSON.stringify(existing.frets) === JSON.stringify(caged.frets)\n                );\n                if (!isDuplicate) {\n                    chordVoicings.push(caged);\n                }\n            });\n            console.log(`Added ${cagedVoicings.length} CAGED positions`);\n        }\n    }\n    \n    // If still no voicings, try simple fallback (works for all instruments)\n    if (chordVoicings.length === 0) {\n        console.log(`No voicings found, trying simple fallback for ${chordName} on ${instrumentName}...`);\n        const fallback = generateSimpleFallback(chordName, instrumentKey);\n        if (fallback) {\n            chordVoicings = [fallback];\n        } else {\n            container.innerHTML = `<p class=\"text-gray-500 italic\">Unable to generate chord for ${chordName} on ${instrumentName}</p>`;\n            return;\n        }\n    }\n    \n    console.log(`Total voicings to display: ${chordVoicings.length}`);\n    \n    // Render all voicings side-by-side\n    container.innerHTML = '<div class=\"chord-diagrams-container\"></div>';\n    const diagrams = container.querySelector('.chord-diagrams-container');\n    \n    chordVoicings.forEach((chordData, index) => {\n        const diagramDiv = document.createElement('div');\n        diagramDiv.className = 'chord-diagram-item';\n        diagramDiv.innerHTML = renderTextChordDiagram(chordData, instrumentKey);\n        diagrams.appendChild(diagramDiv);\n    });\n}\n\n// Display common chord progressions\nfunction displayProgressions(key, chordNames) {\n    const progressionDisplay = document.getElementById('chord-progression-display');\n    if (!progressionDisplay) return;\n    \n    const commonProgressions = [\n        { name: 'I-IV-V', indices: [0, 3, 4] },\n        { name: 'I-V-vi-IV', indices: [0, 4, 5, 3] },\n        { name: 'ii-V-I', indices: [1, 4, 0] },\n        { name: 'I-vi-IV-V', indices: [0, 5, 3, 4] }\n    ];\n    \n    progressionDisplay.innerHTML = '<h4 class=\"font-semibold text-gray-700 mb-2\">Common Progressions:</h4>';\n    \n    commonProgressions.forEach(prog => {\n        const chords = prog.indices.map(i => chordNames[i]).join(' → ');\n        const div = document.createElement('div');\n        div.className = 'text-sm text-gray-600';\n        div.innerHTML = `<strong>${prog.name}:</strong> ${chords}`;\n        progressionDisplay.appendChild(div);\n    });\n}\n\nfunction initializeAccordions() {\n    // Handle old-style accordions (.accordion-container)\n    const accordions = document.querySelectorAll('.accordion-container');\n    accordions.forEach(accordion => {\n        const header = accordion.querySelector('.accordion-header');\n        const content = accordion.querySelector('.accordion-content');\n\n        header.addEventListener('click', () => {\n            const isActive = header.classList.contains('active');\n            \n            if (isActive) {\n                header.classList.remove('active');\n                content.style.maxHeight = null;\n            } else {\n                header.classList.add('active');\n                content.style.maxHeight = content.scrollHeight + \"px\";\n            }\n        });\n    });\n\n    // Handle new-style accordions (.accordion-item with .accordion-button)\n    const accordionItems = document.querySelectorAll('.accordion-item');\n    accordionItems.forEach(item => {\n        const button = item.querySelector('.accordion-button');\n        const content = item.querySelector('.accordion-content');\n\n        if (button && content) {\n            button.addEventListener('click', () => {\n                const isCollapsed = button.classList.contains('collapsed');\n                \n                if (isCollapsed) {\n                    // Expand\n                    button.classList.remove('collapsed');\n                    button.setAttribute('aria-expanded', 'true');\n                    content.style.maxHeight = content.scrollHeight + \"px\";\n                } else {\n                    // Collapse\n                    button.classList.add('collapsed');\n                    button.setAttribute('aria-expanded', 'false');\n                    content.style.maxHeight = null;\n                }\n            });\n        }\n    });\n}\n\nfunction initializeControls() {\n    const instrumentSelect = document.getElementById('instrumentFilter');\n    const rootSelect = document.getElementById('rootSelect');\n    const modeSelect = document.getElementById('modeSelect');\n    const generateBtn = document.getElementById('generate-btn');\n\n    // Populate Instruments\n    for (const key in TUNINGS) {\n        const option = document.createElement('option');\n        option.value = key;\n        option.textContent = TUNINGS[key].name;\n        instrumentSelect.appendChild(option);\n    }\n\n    // Populate Root Notes\n    const rootOptions = getRootOptions();\n    for (const name in rootOptions) {\n        const option = document.createElement('option');\n        option.value = rootOptions[name];\n        option.textContent = name;\n        rootSelect.appendChild(option);\n    }\n\n    // Populate Scales/Modes\n    for (const category in SCALES) {\n        const optgroup = document.createElement('optgroup');\n        optgroup.label = category;\n        for (const scale of SCALES[category]) {\n            const option = document.createElement('option');\n            option.value = scale.intervals.join(',');\n            option.textContent = scale.name;\n            optgroup.appendChild(option);\n        }\n        modeSelect.appendChild(optgroup);\n    }\n\n    const generate = () => {\n        const instrumentKey = instrumentSelect.value;\n        const rootIndex = parseInt(rootSelect.value, 10);\n        const scaleIntervals = modeSelect.value.split(',').map(Number);\n        const handedness = document.getElementById('handedness').value;\n        const showNotes = document.getElementById('show-notes').checked;\n        const orientation = document.querySelector('input[name=\"orientation\"]:checked').value;\n\n        const fretboardData = buildInstrumentData(instrumentKey, rootIndex, scaleIntervals);\n        const outputDiv = document.getElementById('fretboard-output');\n        outputDiv.innerHTML = ''; // Clear previous output\n\n        // Add the GUI fretboard\n        const gui = renderGui(fretboardData, instrumentKey, handedness, showNotes);\n        outputDiv.appendChild(gui);\n\n        // Always populate the dedicated \"Strings as Rows\" section below tablature\n        const stringsRowsDisplay = document.getElementById('strings-rows-display');\n        if (stringsRowsDisplay) {\n            const table1 = renderTable1(fretboardData, rootSelect.options[rootSelect.selectedIndex].text, modeSelect.options[modeSelect.selectedIndex].text, showNotes);\n            stringsRowsDisplay.innerHTML = table1;\n        }\n\n        // Only render Frets as Rows if selected (Strings as Rows is always in dedicated section)\n        if (orientation === '2') {\n            const table2 = renderTable2(fretboardData, rootSelect.options[rootSelect.selectedIndex].text, modeSelect.options[modeSelect.selectedIndex].text, handedness, showNotes);\n            outputDiv.innerHTML += table2;\n        }\n    };\n\n    generateBtn.addEventListener('click', generate);\n    instrumentSelect.addEventListener('change', generate);\n    rootSelect.addEventListener('change', generate);\n    modeSelect.addEventListener('change', generate);\n    document.getElementById('handedness').addEventListener('change', generate);\n    document.getElementById('show-notes').addEventListener('change', generate);\n    document.querySelectorAll('input[name=\"orientation\"]').forEach(radio => {\n        radio.addEventListener('change', generate);\n    });\n\n    generate(); // Initial generation\n}\n\n\nwindow.onload = async () => {\n    await loadChordShapes(); // Load chord data first\n    initializeControls(); // Setup controls and run initial generation\n    initializeKeyHarmonySection(); // Setup the interactive harmony section\n    initializeAccordions(); // Initialize all accordion elements\n    \n    // Generate initial tab from CSV template\n    await generateTabForCurrentSettings();\n    renderAllPhases();\n    console.log('Initial tab generated successfully');\n    \n    // Add event listeners for tablature regeneration when selections change\n    const instrumentSelect = document.getElementById('instrumentFilter');\n    const rootSelect = document.getElementById('rootSelect');\n    const modeSelect = document.getElementById('modeSelect');\n    \n    if (instrumentSelect) {\n        instrumentSelect.addEventListener('change', regenerateTabForCurrentSettings);\n    }\n    if (rootSelect) {\n        rootSelect.addEventListener('change', regenerateTabForCurrentSettings);\n    }\n    if (modeSelect) {\n        modeSelect.addEventListener('change', regenerateTabForCurrentSettings);\n    }\n    \n    // Add play/stop button listeners\n    document.getElementById(\"play-tab-btn\")?.addEventListener(\"click\", playManuscript);\n    document.getElementById(\"stop-tab-btn\")?.addEventListener(\"click\", stopManuscript);\n};\n\n// ========== MANUSCRIPT METHOD FIXES ==========\n\n// Global state for tab data\nlet manuscriptTabData = null;\nlet csvTemplateText = null;\n\n// Load the CSV template\nasync function loadCSVTemplate() {\n    try {\n        const response = await fetch('/C_Major_Template.csv');\n        if (!response.ok) {\n            throw new Error(`Failed to load CSV template: ${response.status}`);\n        }\n        csvTemplateText = await response.text();\n        console.log('CSV template loaded successfully');\n        return csvTemplateText;\n    } catch (error) {\n        console.error('Error loading CSV template:', error);\n        return null;\n    }\n}\n\n// Generate tab from CSV template\nasync function generateTabForCurrentSettings() {\n    const rootSelect = document.getElementById('rootSelect');\n    const instrumentSelect = document.getElementById('instrumentFilter');\n    const modeSelect = document.getElementById('modeSelect');\n    \n    if (!rootSelect || !instrumentSelect || !modeSelect) {\n        console.log('Controls not ready yet');\n        return;\n    }\n    \n    // Get current selections\n    const selectedRootIndex = parseInt(rootSelect.value);\n    const selectedInstrument = instrumentSelect.value;\n    const selectedMode = modeSelect.options[modeSelect.selectedIndex].text;\n    \n    // Get root note name\n    const rootNote = CHROMATIC_NOTES[selectedRootIndex].name;\n    \n    // Get instrument tuning\n    const instrumentTuning = TUNINGS[selectedInstrument];\n    if (!instrumentTuning) {\n        console.error('Unknown instrument:', selectedInstrument);\n        return;\n    }\n    \n    // Load CSV template if not already loaded\n    if (!csvTemplateText) {\n        csvTemplateText = await loadCSVTemplate();\n        if (!csvTemplateText) {\n            console.error('Failed to load CSV template');\n            return null;\n        }\n    }\n    \n    console.log(`Generating tab for: ${rootNote} ${selectedMode} on ${instrumentTuning.name}`);\n    \n    // Generate tab from CSV template\n    const tuningArray = instrumentTuning.tuning;\n    manuscriptTabData = await generateTabFromCSV(csvTemplateText, tuningArray, rootNote, 15);\n    \n    // Apply stretch sanitization to prevent impossible finger positions\n    if (manuscriptTabData && window.sanitizeStretchesInTab) {\n        const strings = tuningArray.map(s => `${s.label}${s.octave}`).reverse();\n        window.sanitizeStretchesInTab(manuscriptTabData, strings, 4);\n    }\n    \n    console.log('Tab generated successfully');\n    return manuscriptTabData;\n}\n\n// Regenerate tablature when instrument/root/scale selections change\nasync function regenerateTabForCurrentSettings() {\n    // Generate new tab with current settings\n    await generateTabForCurrentSettings();\n    \n    // Get instrument for rendering\n    const instrumentSelect = document.getElementById('instrumentFilter');\n    if (!instrumentSelect) return;\n    \n    const selectedInstrument = instrumentSelect.value;\n    \n    // Re-render the tablature\n    renderAllPhasesForInstrument(selectedInstrument);\n}\n\n// OLD TRANSPOSE FUNCTION - NO LONGER USED (replaced by algorithmic generator)\n/*\nfunction transposeTabData(tabData, semitones, instrumentKey = 'guitar_6') {\n    const transposed = {};\n    \n    // Get the target instrument's tuning\n    const targetTuning = TUNINGS[instrumentKey];\n    if (!targetTuning) {\n        console.error('Unknown instrument:', instrumentKey);\n        return tabData;\n    }\n    \n    // Get source tunings (guitar_6 as primary, guitar_7 for extended range)\n    const sourceTuning = TUNINGS['guitar_6'];\n    const sourceTuning7 = TUNINGS['guitar_7'];\n    \n    // Helper function to get note index at fret\n    function getNoteIndexAtFret(baseNoteIndex, fretNum) {\n        return (baseNoteIndex + fretNum) % 12;\n    }\n    \n    // Process each target instrument string\n    targetTuning.tuning.forEach(targetString => {\n        const targetStringLabel = `${targetString.label}${targetString.octave}`;\n        let sourceStringLabel = null;\n        let sourceString = null;\n        \n        // Step 1: Try exact open note match from 6-string guitar\n        for (const src of sourceTuning.tuning) {\n            if (src.open_note === targetString.open_note) {\n                sourceStringLabel = `${src.label}${src.octave}`;\n                sourceString = src;\n                break;\n            }\n        }\n        \n        // Step 2: If no match, try 7-string guitar (for low B on 5-string bass)\n        if (!sourceStringLabel && sourceTuning7) {\n            for (const src of sourceTuning7.tuning) {\n                if (src.open_note === targetString.open_note) {\n                    sourceStringLabel = `${src.label}${src.octave}`;\n                    sourceString = src;\n                    break;\n                }\n            }\n        }\n        \n        // Step 3: If still no match, find string with closest note index (for ukulele, etc.)\n        if (!sourceStringLabel) {\n            // Find the guitar string with the closest note index\n            let closestString = sourceTuning.tuning[0];\n            let minDiff = Math.abs(targetString.note_index - closestString.note_index);\n            \n            for (const src of sourceTuning.tuning) {\n                const diff = Math.abs(targetString.note_index - src.note_index);\n                if (diff < minDiff) {\n                    minDiff = diff;\n                    closestString = src;\n                }\n            }\n            \n            sourceStringLabel = `${closestString.label}${closestString.octave}`;\n            sourceString = closestString;\n            \n            console.log(`No exact match for ${targetStringLabel}, using ${sourceStringLabel} (closest by note)`);\n        }\n        \n        // Step 4: Copy and transpose the tab data\n        if (tabData[sourceStringLabel]) {\n            transposed[targetStringLabel] = tabData[sourceStringLabel].map(fret => {\n                if (!fret || fret === '' || fret === '-') return fret;\n                \n                const fretNum = parseInt(fret, 10);\n                if (isNaN(fretNum)) return fret;\n                \n                // Calculate the pitch difference between source and target open notes\n                let pitchAdjustment = 0;\n                if (sourceString) {\n                    // Calculate semitone difference between source and target open notes\n                    const sourcePitch = sourceString.note_index + (sourceString.octave * 12);\n                    const targetPitch = targetString.note_index + (targetString.octave * 12);\n                    pitchAdjustment = targetPitch - sourcePitch;\n                }\n                \n                // Transpose by semitones and adjust for pitch difference\n                const newFret = fretNum + semitones - pitchAdjustment;\n                \n                // Keep within reasonable fret range\n                if (newFret < 0) return '-';\n                if (newFret > 24) return '-';\n                \n                return newFret.toString();\n            });\n        } else {\n            // Generate empty pattern for this string if source data doesn't exist\n            transposed[targetStringLabel] = new Array(512).fill('-');\n            console.warn(`No source data found for ${sourceStringLabel}, creating empty pattern for ${targetStringLabel}`);\n        }\n    });\n    \n    return transposed;\n}\n*/\n// END OLD TRANSPOSE FUNCTION\n\nfunction renderAllPhases() {\n    if (!manuscriptTabData) return;\n    renderManuscriptPhase('complete-tab-display', 0, 512, 'guitar_6');\n}\n\nfunction renderAllPhasesForInstrument(instrumentKey) {\n    if (!manuscriptTabData) return;\n    renderManuscriptPhase('complete-tab-display', 0, 512, instrumentKey);\n}\n\n// Helper function to detect extreme finger stretches in a beat\nfunction detectFingerStretch(strings, beat, manuscriptData, maxComfortableStretch = 4) {\n    const activeFrets = [];\n    \n    // Collect all active (non-rest) fret numbers for this beat\n    strings.forEach(stringName => {\n        const fret = manuscriptData[stringName]?.[beat];\n        if (fret !== undefined && fret !== '' && fret !== '-') {\n            const fretNum = parseInt(fret, 10);\n            if (!isNaN(fretNum) && fretNum >= 0) {\n                activeFrets.push(fretNum);\n            }\n        }\n    });\n    \n    // If we have 2 or more notes playing simultaneously\n    if (activeFrets.length >= 2) {\n        const minFret = Math.min(...activeFrets);\n        const maxFret = Math.max(...activeFrets);\n        const stretch = maxFret - minFret;\n        \n        // Return stretch info if it exceeds comfortable range\n        if (stretch > maxComfortableStretch) {\n            return {\n                hasStretch: true,\n                stretch: stretch,\n                minFret: minFret,\n                maxFret: maxFret\n            };\n        }\n    }\n    \n    return { hasStretch: false };\n}\n\nfunction renderManuscriptPhase(containerId, startBeat, endBeat, instrumentKey = 'guitar_6') {\n    if (!manuscriptTabData) return;\n    const container = document.getElementById(containerId);\n    if (!container) return;\n    \n    // Get string configuration from the selected instrument\n    const tuning = TUNINGS[instrumentKey];\n    if (!tuning) {\n        console.error('Unknown instrument:', instrumentKey);\n        return;\n    }\n    \n    // Extract string labels from tuning (in display order: thinnest to thickest for standard view)\n    // Use label + octave format to match CSV data keys (e4, B3, G3, D3, A2, E2)\n    const strings = tuning.tuning.map(s => `${s.label}${s.octave}`);\n    const beatsPerMeasure = 4;\n    const measuresPerBar = 4;\n    const beatsPerBar = beatsPerMeasure * measuresPerBar;\n    \n    let html = '<div class=\"tab-container\"><div class=\"tab-string-labels\">';\n    \n    // Add string labels column\n    strings.forEach(stringName => {\n        html += `<div class=\"tab-string-label\">${stringName}</div>`;\n    });\n    html += '</div><div class=\"tab-staff\">';\n    \n    // Loop through beats, displaying all strings vertically at each beat\n    for (let beat = startBeat; beat < endBeat; beat++) {\n        // Add measure separator every 4 beats (but not at the start)\n        if (beat > startBeat && (beat - startBeat) % beatsPerMeasure === 0) {\n            html += '<div class=\"tab-measure-separator\"></div>';\n        }\n        \n        // Wrap to new bar every 16 beats\n        if (beat > startBeat && (beat - startBeat) % beatsPerBar === 0) {\n            html += '</div></div><div class=\"tab-container\"><div class=\"tab-string-labels\">';\n            strings.forEach(stringName => {\n                html += `<div class=\"tab-string-label\">${stringName}</div>`;\n            });\n            html += '</div><div class=\"tab-staff\">';\n        }\n        \n        // Detect finger stretch for this beat\n        const stretchInfo = detectFingerStretch(strings, beat, manuscriptTabData);\n        const stretchClass = stretchInfo.hasStretch ? ' tab-beat-stretch' : '';\n        const stretchTitle = stretchInfo.hasStretch \n            ? `title=\"Warning: ${stretchInfo.stretch}-fret stretch (frets ${stretchInfo.minFret}-${stretchInfo.maxFret})\"` \n            : '';\n        \n        // Create a vertical column for this beat showing all strings\n        html += `<div class=\"tab-beat-column${stretchClass}\" ${stretchTitle}>`;\n        strings.forEach(stringName => {\n            const fret = manuscriptTabData[stringName]?.[beat];\n            \n            // Defensive check: warn if string data is missing\n            if (!manuscriptTabData[stringName] && beat === startBeat) {\n                console.warn(`Missing tablature data for string: ${stringName}`);\n            }\n            \n            const displayFret = fret !== undefined && fret !== '' ? fret : '-';\n            html += `<div class=\"tab-fret-cell\">${displayFret}</div>`;\n        });\n        html += '</div>';\n    }\n    \n    html += '</div></div>';\n    container.innerHTML = html;\n}\n\nasync function playManuscript() {\n    if (!manuscriptTabData) {\n        console.log('No tab data loaded');\n        return;\n    }\n    \n    await Tone.start();\n    Tone.Transport.stop();\n    Tone.Transport.cancel();\n    \n    const synth = new Tone.Synth().toDestination();\n    \n    // Get BPM from UI or use default\n    const tempoInput = document.getElementById('tempo');\n    const bpm = tempoInput ? parseInt(tempoInput.value) || 120 : 120;\n    Tone.Transport.bpm.value = bpm;\n    \n    // Get current instrument to build tuning map\n    const instrumentSelect = document.getElementById('instrumentFilter');\n    const selectedInstrument = instrumentSelect ? instrumentSelect.value : 'guitar_6';\n    const instrumentTuning = TUNINGS[selectedInstrument];\n    \n    if (!instrumentTuning) {\n        console.error('Cannot find instrument tuning for:', selectedInstrument);\n        return;\n    }\n    \n    // Build tuning map dynamically from instrument's tuning\n    // String names in manuscriptTabData are formatted as \"e4\", \"B3\", etc.\n    const tuningMap = {};\n    const strings = [];\n    \n    instrumentTuning.tuning.forEach(stringInfo => {\n        const stringName = stringInfo.open_note;\n        strings.push(stringName);\n        // Convert note name to MIDI value\n        tuningMap[stringName] = Tonal.Note.midi(stringInfo.open_note);\n    });\n    \n    // Reverse to match the order in manuscriptTabData (thinnest to thickest)\n    strings.reverse();\n    \n    const playableEvents = [];\n    // Calculate time per beat based on BPM: (60 / bpm) / 4 for 16th notes\n    const TIME_PER_BEAT = (60 / bpm) / 4;\n    \n    // Parse the tablature data and create playable events\n    strings.forEach(stringName => {\n        if (!manuscriptTabData[stringName]) {\n            console.warn(`No tab data for string: ${stringName}`);\n            return;\n        }\n        \n        manuscriptTabData[stringName].forEach((fret, beatIndex) => {\n            if (fret && fret !== '' && fret !== '-') {\n                const time = beatIndex * TIME_PER_BEAT;\n                const baseMidi = tuningMap[stringName];\n                const fretNum = parseInt(fret, 10);\n                \n                if (isNaN(fretNum) || baseMidi === undefined) {\n                    return;\n                }\n                \n                const noteMidi = baseMidi + fretNum;\n                const noteName = Tonal.Note.fromMidi(noteMidi);\n                \n                playableEvents.push({ time, note: noteName, duration: '16n' });\n            }\n        });\n    });\n    \n    if (playableEvents.length === 0) {\n        console.log('No playable notes found in tablature');\n        return;\n    }\n    \n    const tabPart = new Tone.Part((time, event) => {\n        synth.triggerAttackRelease(event.note, event.duration, time);\n    }, playableEvents);\n    \n    tabPart.start(0);\n    Tone.Transport.start();\n    \n    console.log(`Playing ${playableEvents.length} notes at ${bpm} BPM on ${instrumentTuning.name}`);\n}\n\nfunction stopManuscript() {\n    Tone.Transport.stop();\n    Tone.Transport.cancel();\n    console.log('Playback stopped');\n}\n\n// ========== PWA SERVICE WORKER REGISTRATION ==========\n\nif ('serviceWorker' in navigator) {\n    window.addEventListener('load', () => {\n        navigator.serviceWorker.register('/sw.js')\n            .then((registration) => {\n                console.log('Service Worker registered successfully:', registration.scope);\n            })\n            .catch((error) => {\n                console.log('Service Worker registration failed:', error);\n            });\n    });\n}\n\nlet deferredPrompt;\n\nwindow.addEventListener('beforeinstallprompt', (e) => {\n    e.preventDefault();\n    deferredPrompt = e;\n    console.log('PWA install prompt is available');\n});\n\nwindow.addEventListener('appinstalled', () => {\n    console.log('PWA was installed successfully');\n    deferredPrompt = null;\n});\n\n","size_bytes":95395}},"version":2}