<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Fretboard Training Manuscripts</title>
    
    <meta name="description" content="Interactive music theory app for guitarists, bassists, and stringed instrument players. Visualize scales, modes, and chord progressions.">
    <meta name="theme-color" content="#4f46e5">
    
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/icon-512.png">
    <link rel="apple-touch-icon" href="/icon-192.png">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Fretboard">
    
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/tonal/browser/tonal.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tone/build/Tone.js"></script>
    <link rel="stylesheet" href="/style.css">
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto container">
        <header class="text-center mb-10">
            <h1 class="text-4xl font-extrabold text-indigo-800">The Fretboard Training Manuscripts</h1>
            <p class="text-lg text-gray-600 mt-2">Visualize scales, modes, and find practical examples.</p>
        </header>

        <!-- Controls Section (Merged Layout) -->
        <div class="bg-white p-6 rounded-xl shadow-2xl mb-10 border-t-8 border-indigo-500">
            <div class="control-group">
                <label class="block">
                    <span class="text-gray-700 font-semibold">Instrument</span>
                    <select id="instrumentFilter" class="mt-1 block w-full border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                        <!-- Options will be populated by JS -->
                    </select>
                </label>
                <label class="block">
                    <span class="text-gray-700 font-semibold">Root Note</span>
                    <select id="rootSelect" class="mt-1 block w-full border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                        <!-- Options will be populated by JS -->
                    </select>
                </label>
                <label class="block">
                    <span class="text-gray-700 font-semibold">Scale/Mode</span>
                    <select id="modeSelect" class="mt-1 block w-full border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                        <!-- Options will be populated by JS -->
                    </select>
                </label>
                <label class="block">
                    <span class="text-gray-700 font-semibold">Handedness</span>
                    <select id="handedness" class="mt-1 block w-full border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                        <option value="right">Right-Handed</option>
                        <option value="left">Left-Handed</option>
                    </select>
                </label>
            </div>

            <div class="mt-6 flex flex-wrap gap-x-6 gap-y-4 items-center">
                <span class="text-gray-700 font-semibold">Orientation:</span>
                <label class="flex items-center space-x-2">
                    <input type="radio" name="orientation" value="both" id="orientation-both" class="form-radio text-indigo-600">
                    <span class="text-gray-700">Both Tables</span>
                </label>
                <label class="flex items-center space-x-2">
                    <input type="radio" name="orientation" value="1" id="orientation-1" checked class="form-radio text-indigo-600">
                    <span class="text-gray-700">Strings as Rows</span>
                </label>
                <label class="flex items-center space-x-2">
                    <input type="radio" name="orientation" value="2" id="orientation-2" class="form-radio text-indigo-600">
                    <span class="text-gray-700">Frets as Rows</span>
                </label>
                <label class="flex items-center space-x-2 ml-6">
                    <input type="checkbox" id="show-notes" checked class="form-checkbox text-indigo-600 rounded">
                    <span class="text-gray-700">Show Note Names</span>
                </label>
            </div>

            <!-- UPDATED: Tablature Formatting Controls -->
            <div class="mt-6 pt-6 border-t border-gray-200">
                <h4 class="text-lg font-semibold text-gray-800 mb-4">Tablature Training Settings</h4>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <label class="block">
                        <span class="text-gray-700 font-semibold">Beats/Measure</span>
                        <input type="number" id="beats-per-measure" value="4" min="1" max="8" class="mt-1 block w-full shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                    </label>
                    <label class="block">
                        <span class="text-gray-700 font-semibold">Measures/Bar (Wrap)</span>
                        <input type="number" id="measures-per-bar" value="4" min="1" max="8" class="mt-1 block w-full shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                    </label>
                    <label class="block">
                        <span class="text-gray-700 font-semibold">Tempo (BPM)</span>
                        <input type="number" id="tab-tempo" value="120" min="40" max="240" class="mt-1 block w-full shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                    </label>
                    <label class="block">
                        <span class="text-gray-700 font-semibold">Note Division</span>
                        <select id="note-division" class="mt-1 block w-full border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                            <option value="16">16th Notes</option>
                            <option value="8">8th Notes (Show 1st/3rd)</option>
                        </select>
                    </label>
                </div>
            </div>

            <!-- Educational Accordion: Six-Module System -->
            <div id="info-accordion" class="mt-6 pt-6 border-t border-gray-200 space-y-3">
                
                <!-- Accordion Item 1: What is The TFTM Method? -->
                <div class="accordion-item">
                    <h3 class="accordion-header">
                        <button type="button" class="accordion-button collapsed" aria-expanded="false">
                            What is The TFTM Method? (The Problem & The Solution)
                        </button>
                    </h3>
                    <div class="accordion-content">
                        <p><strong>The Basic Concept (The Problem):</strong><br>
                        Traditional music education is broken. It's fragmented. You're given a "box pattern" (like the minor pentatonic scale), a few chord diagrams, and some "licks." This leaves you with a mental "junk drawer" of disconnected, isolated pieces of information. You can play perfectly fine inside that one box, but you have no idea how to connect it to the rest of the neck. This creates a "glass ceiling" on your playing, leaving 90% of the fretboard as a sea of confusing "mystery notes." You never truly "know" the fretboard.</p>
                        
                        <p><strong>The Fretboard Training Manuscripts (TFTM) Method (The Solution):</strong><br>
                        Our method is a <strong>complete, data-driven, pedagogical engine</strong> designed to fix this fundamental flaw. We don't give you disconnected fragments. We give you a single, unified "Foundational Etude"—a 512-beat, data-rich curriculum (the CSV manuscript file) that is executed by our visual training tool.</p>
                        
                        <p>This etude is a <strong>Six-Module System</strong> that logically builds your fretboard knowledge from the ground up. It systematically "de-bugs" your old, fragmented habits and installs a complete, holistic "operating system" for the fretboard. It is a logical curriculum that forces you to see and command the <em>entire</em> neck as one single, unified map.</p>
                    </div>
                </div>

                <!-- Accordion Item 2: Module 1 -->
                <div class="accordion-item">
                    <h3 class="accordion-header">
                        <button type="button" class="accordion-button collapsed" aria-expanded="false">
                            Module 1: Foundational Mechanics (Rhythm & Technique)
                        </button>
                    </h3>
                    <div class="accordion-content">
                        <p><strong>The Basic Concept:</strong><br>
                        Before you can play music, you must have control. This means playing with rhythmic precision (in time), coordinating your left and right hands, and playing each note cleanly. This is the #1 weakness of most self-taught players.</p>
                        
                        <p><strong>The Fretboard Training Manuscripts (TFTM) Method:</strong><br>
                        <strong>Module 1</strong> of our etude is dedicated to installing this "internal clock" and building your core technique. This is not a passive "tab viewer"; it is an active <strong>"pedagogical engine"</strong>.</p>
                        
                        <p><strong>How Our Tool Encapsulates This:</strong><br>
                        The scrolling, beat-by-beat visual guide is your unblinking metronome. It does not wait for you. It <em>forces</em> you to develop rock-solid timing and rhythmic accuracy from the very first note. The initial exercises are not random; they are specifically designed to build your "finger-per-fret" discipline and hand synchronization.</p>
                        
                        <p>This active-learning approach is critical. You are not just learning <em>what</em> notes to play; you are drilling <em>how</em> to play them with the accuracy, timing, and control of a professional. This module installs the non-negotiable physical and rhythmic foundation required for everything that follows.</p>
                    </div>
                </div>

                <!-- Accordion Item 3: Modules 2 & 3 -->
                <div class="accordion-item">
                    <h3 class="accordion-header">
                        <button type="button" class="accordion-button collapsed" aria-expanded="false">
                            Modules 2 & 3: Total Scale Mastery (Deconstructing "The Box")
                        </button>
                    </h3>
                    <div class="accordion-content">
                        <p><strong>The Basic Concept:</strong><br>
                        A scale is the "alphabet" of a key (e.g., C Major = C, D, E, F, G, A, B). Almost every teacher will show you this scale in a "box pattern." This is the single biggest reason players get "stuck." The "box" is a crutch. It's a temporary shortcut that becomes a permanent prison, locking you into one small area and preventing you from ever seeing the larger picture.</p>
                        
                        <p><strong>The Fretboard Training Manuscripts (TFTM) Method:</strong><br>
                        Our pedagogy <strong>systematically eradicates</strong> this "box" dependency by building your mental map in two distinct, logical steps:</p>
                        
                        <ul class="ml-6 space-y-2">
                            <li><strong>Module 2: Horizontal Knowledge (The "Highways"):</strong> The etude <em>first</em> drills you on the C Major scale <em>horizontally</em>, up and down the <em>entire length</em> of each individual string. This is the "raw data" of the fretboard that is almost <em>always</em> skipped in traditional lessons. Our tool forces you to learn this "index" of the neck, ensuring you have no "dead spots" or "mystery frets." You will learn, for example, every single 'C' note from one end of the instrument to the other.</li>
                            
                            <li><strong>Module 3: Vertical Knowledge (The "Intersections"):</strong> <em>Only after</em> you have this horizontal map does the etude guide you <em>vertically</em>. Our tool drills you in positions (like the 7 positions of the major scale, which the "CAGED" system is based on). But now, they are not "isolated boxes." You will instantly see them for what they are: simple <em>intersections</em> that connect the horizontal "highways" you just mastered in Module 2.</li>
                        </ul>
                        
                        <p>This two-step process ensures you see the fretboard as <strong>one unified, interconnected system</strong>. You will be able to find any note, in any key, anywhere on the neck, instantly, and move between positions with fluid, effortless confidence.</p>
                    </div>
                </div>

                <!-- Accordion Item 4: Module 4 -->
                <div class="accordion-item">
                    <h3 class="accordion-header">
                        <button type="button" class="accordion-button collapsed" aria-expanded="false">
                            Module 4: True Harmonic Context (Chords & Arpeggios)
                        </button>
                    </h3>
                    <div class="accordion-content">
                        <p><strong>The Basic Concept:</strong><br>
                        Chords (notes played together) and Arpeggios (notes played one-by-one) are what give music its emotional depth. A C Major chord is built from the <strong>1st, 3rd, and 5th</strong> notes of the C Major scale: <strong>C, E, and G</strong>. Knowing <em>why</em> it's C-E-G, and knowing where those three notes are everywhere on the neck, is the true key to improvisation.</p>
                        
                        <p><strong>The Fretboard Training Manuscripts (TFTM) Method:</strong><br>
                        This is <strong>Module 4</strong>, and it's where our system connects all the dots. Running up and down scales (Modules 2 & 3) is a technical exercise. But "outlining the changes"—hitting the chord tones (C, E, G) at the exact moment the C Major chord is playing—is what sounds <em>professional</em>.</p>
                        
                        <p><strong>How Our Tool Encapsulates This:</strong><br>
                        Because you <em>mastered</em> the locations of all the C's, E's, and G's in the previous modules, our etude's harmonic exercises are the logical next step:</p>
                        
                        <ul class="ml-6 space-y-2">
                            <li><strong>Chords:</strong> Our tool drills "triad inversions" (different C-E-G voicings) all over the neck. You are not <em>memorizing</em> random, disconnected shapes; you are <em>building</em> harmony from the scale-tone "database" you already have in your head.</li>
                            
                            <li><strong>Arpeggios:</strong> The tool's visual guide will "light up" these C-E-G arpeggio pathways <em>inside</em> the scale patterns you've already learned. You are systematically training your fingers, mind, and ear to "see" the chord structure <em>within</em> the scale structure. This is the single most powerful skill for melodic improvisation, and our tool is designed to build it directly into your playing.</li>
                        </ul>
                    </div>
                </div>

                <!-- Accordion Item 5: Modules 5 & 6 -->
                <div class="accordion-item">
                    <h3 class="accordion-header">
                        <button type="button" class="accordion-button collapsed" aria-expanded="false">
                            Modules 5 & 6: From Foundation to Virtuosity (Application)
                        </button>
                    </h3>
                    <div class="accordion-content">
                        <p><strong>The Basic Concept:</strong><br>
                        Once you have the complete map (Modules 2 & 3) and you understand the harmony (Module 4), it's time to build a "vocabulary" of musical ideas and the technical facility to play them. This is where you build speed, dexterity, and true creative expression.</p>
                        
                        <p><strong>The Fretboard Training Manuscripts (TFTM) Method:</strong><br>
                        The final two modules are your path to complete fluency:</p>
                        
                        <ul class="ml-6 space-y-2">
                            <li><strong>Module 5: Virtuosic Integration:</strong> Your unbreakable foundation is now in place. This module introduces complex sequences that combine everything you've learned. Our tool will drill you on 3-note-per-string patterns, melodic fragments (like "diatonic 3rds and 4ths"), and other "shred" techniques. This is where you build blazing speed and a "vocabulary" of professional-sounding licks, all perfectly in time and contextually aware of the key.</li>
                            
                            <li><strong>Module 6: Holistic Descents (The "Victory Lap"):</strong> This is the final <em>proof</em> of your mastery. The etude guides you in "super-scales" that span the <em>entire</em> length of the fretboard—from the lowest note to the highest and back down—in one single, unbroken, fluid motion. This exercise shatters any remaining "box" habits and solidifies in your muscle memory that you command the <em>entire</em> instrument as one single, playable zone. You no longer "know" positions; you <em>know the fretboard</em>.</li>
                        </ul>
                    </div>
                </div>

            </div>


            <div class="mt-8">
                <button id="generate-btn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-xl transition duration-150 ease-in-out shadow-lg transform hover:scale-[1.005]">
                    Generate Fretboard
                </button>
            </div>
        </div>

        <!-- Output Section (GUI Fretboard) -->
        <div id="fretboard-output" class="space-y-8">
            <p id="placeholder" class="text-center text-xl text-gray-500 italic p-6 border rounded-lg bg-indigo-50">
                Select a Root Note and a Scale/Mode above to generate the fretboard charts and tablature example.
            </p>
        </div>

        <!-- Manuscript Method Tablature Section -->
        <div id="manuscript-section" class="manuscript-container">
            <h2 class="manuscript-title">The Manuscript Method</h2>
            <p class="manuscript-subtitle">Complete C Major Training Tablature</p>
            
            <div class="manuscript-controls">
                <button id="play-tab-btn" class="manuscript-btn manuscript-play-btn">Play</button>
                <button id="stop-tab-btn" class="manuscript-btn manuscript-stop-btn">Stop</button>
            </div>
            
            <!-- Complete continuous tablature -->
            <div id="complete-tab-display" class="tab-display">
                <!-- Complete tablature will be rendered here -->
            </div>
        </div>

        <!-- Strings as Rows Table Display -->
        <div id="strings-rows-section" class="bg-white p-6 rounded-xl shadow-2xl mb-10 border-t-4 border-indigo-400">
            <h2 class="text-2xl font-bold text-indigo-700 mb-4 text-center">Fretboard View (Strings as Rows)</h2>
            <div id="strings-rows-display" class="overflow-x-auto">
                <!-- Strings as rows table will be rendered here -->
            </div>
        </div>

        <!-- Interactive Key & Harmony Section -->
        <div id="key-harmony-container" class="key-harmony-section p-6 md:p-8 rounded-xl shadow-2xl mb-10">
            <h2 class="text-3xl font-bold text-indigo-700 mb-2 text-center">Interactive Key & Harmony</h2>
            <p class="text-center text-gray-600 mb-8">Explore diatonic chords and common progressions in your selected key.</p>

            <div class="grid grid-cols-1 gap-8">
                <!-- Diatonic Chords & Progressions -->
                <div>
                    <div id="diatonic-chords-container" class="mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Diatonic Chords & Progressions</h3>
                        <div id="diatonic-chords-display" class="flex flex-wrap gap-3 mb-6">
                            <!-- Diatonic chord buttons will be populated here -->
                        </div>
                        <div id="chord-progression-display" class="p-4 bg-gray-100 rounded-lg space-y-2">
                            <!-- Common progressions will be populated here -->
                        </div>
                        <!-- NEW: Fundamentals Accordion -->
                        <div class="mt-4 accordion-container">
                            <div class="accordion-header">
                                <span>[+] What is a Chord and a Triad?</span>
                                <span class="accordion-symbol">+</span>
                            </div>
                            <div class="accordion-content">
                                <p class="text-gray-700 text-sm mb-3">A <strong>chord</strong> is three or more notes played simultaneously. The most basic type of chord is a <strong>triad</strong>, which is built using the 1st (Root), 3rd, and 5th notes of a scale. A <strong>Major Triad</strong> uses a Major 3rd, while a <strong>Minor Triad</strong> uses a Minor 3rd, giving them their distinct happy or sad sound.</p>
                                
                                <p class="text-gray-700 text-sm mb-2"><strong>Understanding Chord Diagrams:</strong></p>
                                <ul class="text-gray-700 text-sm space-y-1 ml-4">
                                    <li>• <strong>Strings</strong>: The horizontal lines represent guitar strings (high e at top, low E at bottom)</li>
                                    <li>• <strong>Frets</strong>: The vertical lines represent frets (nut on left, higher frets to the right)</li>
                                    <li>• <strong>x = muted</strong>: Don't play this string</li>
                                    <li>• <strong>o = open</strong>: Play the open string (no finger)</li>
                                    <li>• <strong>Numbers (1-4)</strong>: Which finger to use (1=index, 2=middle, 3=ring, 4=pinky)</li>
                                    <li>• <strong>● = dot</strong>: Press this string at this fret (finger number not specified)</li>
                                    <li>• <strong>Position marker</strong>: Shows starting fret for barre chords (e.g., "Position: 3fr" means start at 3rd fret)</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="mt-4 accordion-container">
                            <div class="accordion-header">
                                <span>[+] Understanding Chord Progressions</span>
                                <span class="accordion-symbol">+</span>
                            </div>
                            <div class="accordion-content">
                                <p class="text-gray-700 text-sm mb-3">A <strong>chord progression</strong> is a sequence of chords played in order. Progressions create the harmonic foundation of songs. Each chord in a key is assigned a Roman numeral based on its position in the scale.</p>
                                
                                <p class="text-gray-700 text-sm mb-2"><strong>Diatonic Chords (The Seven Chords in a Key):</strong></p>
                                <ul class="text-gray-700 text-sm space-y-1 ml-4 mb-3">
                                    <li>• <strong>I</strong> - Tonic (Major): The home chord, feels resolved and stable</li>
                                    <li>• <strong>ii</strong> - Supertonic (minor): Often leads to V, creates forward motion</li>
                                    <li>• <strong>iii</strong> - Mediant (minor): Bridges I and IV, adds emotional depth</li>
                                    <li>• <strong>IV</strong> - Subdominant (Major): Creates contrast, often precedes V</li>
                                    <li>• <strong>V</strong> - Dominant (Major): Creates tension, wants to resolve to I</li>
                                    <li>• <strong>vi</strong> - Submediant (minor): The relative minor, can substitute for I</li>
                                    <li>• <strong>vii°</strong> - Leading Tone (diminished): Strong pull to I, creates tension</li>
                                </ul>
                                
                                <p class="text-gray-700 text-sm mb-2"><strong>Common Progressions:</strong></p>
                                <ul class="text-gray-700 text-sm space-y-1 ml-4">
                                    <li>• <strong>I-IV-V</strong>: The foundation of rock, blues, and country music</li>
                                    <li>• <strong>I-V-vi-IV</strong>: Pop progression (e.g., "Let It Be", "Don't Stop Believin'")</li>
                                    <li>• <strong>ii-V-I</strong>: Jazz progression, smooth resolution</li>
                                    <li>• <strong>I-vi-IV-V</strong>: Classic '50s progression ("Stand By Me")</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Chord Diagram Display -->
                    <div id="chord-diagram-section">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">3. Chord Diagram</h3>
                        <div id="chord-display-container" class="p-4 bg-white rounded-lg shadow-inner flex justify-center items-center border border-gray-200">
                            <p class="text-gray-500 italic">Select a chord to display its diagram.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="/database.js"></script>
    <script type="module" src="/tab_generator.js"></script>
    <script type="module" src="/main.js"></script>
</body>
</html>
